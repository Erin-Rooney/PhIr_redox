westhydric_merge_filter %>%
ggplot()+
geom_point(aes(x = avg_values_fixed, y = std_values))
west_merge_fig_filter =
westhydric_merge_filter %>%
ggplot()+
geom_point(aes(x = avg_values_fixed, y = std_values))
ggsave("output/west_merge_fig_filter_2022.png", plot = west_merge_fig_filter, height = 10, width = 10)
```{r}
sensor_depths_prename = read.csv("raw/2022_Sensor_depths.csv")
sensor_depths =
sensor_depths_prename %>%
dplyr::rename(position = Site,
site = Area) %>%
mutate(site = recode(site, "West" = "west",
"East" = "east")) %>%
mutate(position = recode(position, "Hydric" = "hydric",
"Mesic" = "mesic",
"Dry" = "dry"),
Sensor = recode(Sensor, "redox_5-2-3_fromtip_Avg" = "redox_5_2-3_fromtip_Avg")) %>%
mutate(Sensor = str_remove(Sensor, "Redox_")) %>%
mutate(Sensor = str_remove(Sensor, "redox_")) %>%
mutate(Sensor = str_remove(Sensor, "_fromtip_Avg")) %>%
separate(Sensor, sep = "_", into = c("datalogger", "probe_sensor")) %>%
separate(probe_sensor, sep = "-", into = c("probe", "sensor")) %>%
mutate(sensor = as.numeric(sensor)) %>%
mutate(depth_cm = str_replace(depth_cm, "n.a.", "NA")) %>%
mutate(depth_cm = as.numeric(depth_cm)) %>%
na.omit()
sensor_depths =
sensor_depths_prename %>%
dplyr::rename(position = Site,
site = Area) %>%
mutate(site = recode(site, "West" = "west",
"East" = "east")) %>%
mutate(position = recode(position, "Hydric" = "hydric",
"Mesic" = "mesic",
"Dry" = "dry"),
Sensor = recode(Sensor, "redox_5-2-3_fromtip_Avg" = "redox_5_2-3_fromtip_Avg")) %>%
dplyr::select(-c(X2021_depth_cm, Change_from_2021_cm)) %>%
rename("depth_cm" = 'X2022_depth_cm') %>%
mutate(Sensor = str_remove(Sensor, "Redox_")) %>%
mutate(Sensor = str_remove(Sensor, "redox_")) %>%
mutate(Sensor = str_remove(Sensor, "_fromtip_Avg")) %>%
separate(Sensor, sep = "_", into = c("datalogger", "probe_sensor")) %>%
separate(probe_sensor, sep = "-", into = c("probe", "sensor")) %>%
mutate(sensor = as.numeric(sensor)) %>%
mutate(depth_cm = str_replace(depth_cm, "n.a.", "NA")) %>%
mutate(depth_cm = as.numeric(depth_cm)) %>%
na.omit()
```
```{r}
sensor_depths_prename = read.csv("raw/2022_Sensor_depths.csv")
sensor_depths =
sensor_depths_prename %>%
dplyr::rename(position = Site,
site = Area) %>%
mutate(site = recode(site, "West" = "west",
"East" = "east")) %>%
mutate(position = recode(position, "Hydric" = "hydric",
"Mesic" = "mesic",
"Dry" = "dry"),
Sensor = recode(Sensor, "redox_5-2-3_fromtip_Avg" = "redox_5_2-3_fromtip_Avg")) %>%
dplyr::select(-c(X2021_depth_cm, Change_from_2021_cm)) %>%
rename("depth_cm" = 'X2022_depth_cm') %>%
mutate(Sensor = str_remove(Sensor, "Redox_")) %>%
mutate(Sensor = str_remove(Sensor, "redox_")) %>%
mutate(Sensor = str_remove(Sensor, "_fromtip_Avg")) %>%
separate(Sensor, sep = "_", into = c("datalogger", "probe_sensor")) %>%
separate(probe_sensor, sep = "-", into = c("probe", "sensor")) %>%
mutate(sensor = as.numeric(sensor)) %>%
mutate(depth_cm = str_replace(depth_cm, "n.a.", "NA")) %>%
mutate(depth_cm = as.numeric(depth_cm)) %>%
na.omit()
```{r}
sensor_depths_prename = read.csv("raw/2022_Sensor_depths.csv")
sensor_depths =
sensor_depths_prename %>%
dplyr::rename(position = Site,
site = Area) %>%
mutate(site = recode(site, "West" = "west",
"East" = "east")) %>%
mutate(position = recode(position, "Hydric" = "hydric",
"Mesic" = "mesic",
"Dry" = "dry"),
Sensor = recode(Sensor, "redox_5-2-3_fromtip_Avg" = "redox_5_2-3_fromtip_Avg")) %>%
dplyr::select(-c(X2021_depth_cm, Change_from_2021_cm)) %>%
rename("depth_cm" = 'X2022_depth_cm') %>%
mutate(Sensor = str_remove(Sensor, "Redox_")) %>%
mutate(Sensor = str_remove(Sensor, "redox_")) %>%
mutate(Sensor = str_remove(Sensor, "_fromtip_Avg")) %>%
separate(Sensor, sep = "_", into = c("datalogger", "probe_sensor")) %>%
separate(probe_sensor, sep = "-", into = c("probe", "sensor")) %>%
mutate(sensor = as.numeric(sensor)) %>%
mutate(depth_cm = str_replace(depth_cm, "n.a.", "NA")) %>%
mutate(depth_cm = as.numeric(depth_cm)) %>%
na.omit()
westhydric_depths =
depths_function(westhydric_merge_filter)%>%
na.omit()
```{r}
westhydric_depths_outliers =
datacleaning_function(westhydric_depths)
west_merge_fig_cleaned =
westhydric_depths_outliers %>%
ggplot()+
geom_point(aes(x = avg_values_fixed, y = std_values))
ggsave("output/west_merge_fig_cleaned.png", plot = west_merge_fig_cleaned, height = 10, width = 10)
ggsave("output/west_merge_fig_cleaned2022.png", plot = west_merge_fig_cleaned, height = 10, width = 10)
filter std dev
```{r}
westhydric_depths_std20 =
westhydric_depths_outliers %>%
filter(std_values < 20)
```
plot
```{r}
artifact_westhydric_fig_2022_std20 =
westhydric_depths_std20 %>%
# mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
# mutate(site = recode(site, "east" = "acidic tundra",
#                      "west" = "non-acidic tundra")) %>%
# mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
filter(probe == 3) %>%
ggplot(aes(x = as_datetime(Betterdate), y = avg_values_fixed))+
geom_point(aes(color = depth_cm), alpha = 0.5)+
#geom_line(aes(group = depth_cm, color = depth_cm, orientation = "x"))+
scale_color_gradientn(colors = natparks.pals(name = "KingsCanyon", 8))+
scale_x_datetime(date_breaks = "2 weeks" , date_labels = "%Y-%m-%d")+
#scale_x_discrete(breaks = seq(-1,31,2))+
labs(y = "redox potential, mV",
x = "Post-cleaning",
color = "depth, cm")+
#facet_grid(position~site)+
theme_er1()+
theme(legend.position = "top", axis.text.x = element_text (size = 10, vjust = 0.5, angle = 45))
ggsave("output/artifact_westhydric_fig_2022_std20.png", plot = artifact_westhydric_fig_2022_std20, height = 10, width = 10)
```
filter std dev
```{r}
westhydric_depths_std5 =
westhydric_depths_outliers %>%
filter(std_values < 5)
plot
```{r}
artifact_westhydric_fig_2022_std5 =
westhydric_depths_std5 %>%
# mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
# mutate(site = recode(site, "east" = "acidic tundra",
#                      "west" = "non-acidic tundra")) %>%
# mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
filter(probe == 3) %>%
ggplot(aes(x = as_datetime(Betterdate), y = avg_values_fixed))+
geom_point(aes(color = depth_cm), alpha = 0.5)+
#geom_line(aes(group = depth_cm, color = depth_cm, orientation = "x"))+
scale_color_gradientn(colors = natparks.pals(name = "KingsCanyon", 8))+
scale_x_datetime(date_breaks = "2 weeks" , date_labels = "%Y-%m-%d")+
#scale_x_discrete(breaks = seq(-1,31,2))+
labs(y = "redox potential, mV",
x = "Post-cleaning",
color = "depth, cm")+
#facet_grid(position~site)+
theme_er1()+
theme(legend.position = "top", axis.text.x = element_text (size = 10, vjust = 0.5, angle = 45))
ggsave("output/artifact_westhydric_fig_2022_std5.png", plot = artifact_westhydric_fig_2022_std5, height = 10, width = 10)
```
View(artifact_westhydric_fig_2022_std5)
View(westhydric_depths_std5)
View(westhydric_depths_std5)
knitr::opts_chunk$set(echo = TRUE)
source("code/0-packages.R")
source("code/functions-for-std-dev-redox-data.R")
westhydric_dlname = read.csv("processed/westhydric_dlname.csv")
westhydric_metadata = read.csv("processed/westhydric_metadata.csv")
westhydric_avg =
avg_separate(westhydric_dlname) %>%
left_join(westhydric_metadata, by = 'redox_NUM_Avg') %>%
pivot_longer(-c("redox_NUM_Avg", "TIMESTAMP", "RECORD", "site", "position", "Betterdate"),
names_to = "redox_avg", values_to = "avg_values")
westhydric_std =
std_separate(westhydric_dlname) %>%
left_join(westhydric_metadata, by = 'redox_NUM_Std') %>%
pivot_longer(-c("redox_NUM_Std", "TIMESTAMP", "RECORD", "site", "position", "Betterdate"),
names_to = "redox_std", values_to = "std_values") %>%
filter(redox_std != c("X", "redox_NUM_Avg"))
westhydric_merge =
westhydric_avg %>%
left_join(westhydric_std)
westhydric_merge_filter =
westhydric_avg %>%
left_join(westhydric_std) %>%
dplyr::mutate(avg_values_fixed = avg_values + 197) %>%
filter(avg_values_fixed < 1000) %>%
filter(avg_values_fixed > -600) %>%
dplyr::select(-c(redox_NUM_Std, redox_std))
sensor_depths_prename = read.csv("raw/datalogger_depths.csv")
sensor_depths =
sensor_depths_prename %>%
dplyr::rename(position = Site,
site = Area) %>%
mutate(site = recode(site, "West" = "west",
"East" = "east")) %>%
mutate(position = recode(position, "Hydric" = "hydric",
"Mesic" = "mesic",
"Dry" = "dry"),
Sensor = recode(Sensor, "redox_5-2-3_fromtip_Avg" = "redox_5_2-3_fromtip_Avg")) %>%
mutate(Sensor = str_remove(Sensor, "Redox_")) %>%
mutate(Sensor = str_remove(Sensor, "redox_")) %>%
mutate(Sensor = str_remove(Sensor, "_fromtip_Avg")) %>%
separate(Sensor, sep = "_", into = c("datalogger", "probe_sensor")) %>%
separate(probe_sensor, sep = "-", into = c("probe", "sensor")) %>%
mutate(sensor = as.numeric(sensor)) %>%
mutate(depth_cm = str_replace(depth_cm, "n.a.", "NA")) %>%
mutate(depth_cm = as.numeric(depth_cm)) %>%
na.omit()
westhydric_depths =
depths_function(westhydric_merge_filter)%>%
na.omit()
westhydric_depths_outliers =
datacleaning_function(westhydric_depths)
westhydric_depths_std5 =
westhydric_depths_outliers %>%
filter(std_values < 5)
artifact_westhydric_fig_2021_std5 =
westhydric_depths_std5 %>%
# mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
# mutate(site = recode(site, "east" = "acidic tundra",
#                      "west" = "non-acidic tundra")) %>%
# mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
filter(probe == 3) %>%
ggplot(aes(x = as_datetime(Betterdate), y = avg_values_fixed))+
geom_point(aes(color = depth_cm), alpha = 0.5)+
#geom_line(aes(group = depth_cm, color = depth_cm, orientation = "x"))+
scale_color_gradientn(colors = natparks.pals(name = "KingsCanyon", 8))+
scale_x_datetime(date_breaks = "2 weeks" , date_labels = "%Y-%m-%d")+
#scale_x_discrete(breaks = seq(-1,31,2))+
labs(y = "redox potential, mV",
x = "Post-cleaning",
color = "depth, cm")+
#facet_grid(position~site)+
theme_er1()+
theme(legend.position = "top", axis.text.x = element_text (size = 10, vjust = 0.5, angle = 45))
ggsave("output/artifact_westhydric_fig_2021_std5.png", plot = artifact_westhydric_fig_2021_std5, height = 10, width = 10)
source("code/0-packages.R")
raw_ICP = read.csv("raw/2023_LIME_ICPAES_002R_Herndon_0118.csv")
raw_ICP_diluted = read.csv("raw/2023_LIME_ICPAES_002R_Herndon_0118_diluted.csv")
combo_redox_withdepths2022 = read.csv("processed/allcombine_2022_frozen.csv")
processed_ICP_diluted =
raw_ICP_diluted %>%
mutate(Area = recode(Area, "West" = "non-acidic tundra",
"East" = "acidic tundra")) %>%
mutate(Area = factor(Area, levels = c("non-acidic tundra", "acidic tundra"))) %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
# dplyr::select(c(SampleID, Date, Time, Area, Site, Plot, Depth_cm, Al_ug_mL, Ca_ug_mL, Fe_ug_mL,
#                 K_ug_mL, Mg_ug_mL, Mn_ug_mL, Na_ug_mL, P_ug_mL)) %>%
mutate(P_ug_mL = recode(P_ug_mL, "<0.01" = "0.005",
"<0.1" = "0.05")) %>%  #this seems like an error...need to check
separate(Date, sep = "-", into =c('day', 'month', 'year')) %>%
mutate(month = recode(month, "Jun" = "06", "Jul" = "07", "Aug" = "08", "Sep" = "09")) %>%
mutate(year = recode(year, "22" = "2022")) %>%
mutate(date = as.Date(paste(year, month, day, sep = "-"))) %>%
mutate(Al_ug_mL = as.numeric(Al_ug_mL)) %>%
mutate(Ca_ug_mL = as.numeric(Ca_ug_mL)) %>%
mutate(K_ug_mL = as.numeric(K_ug_mL)) %>%
mutate(Mn_ug_mL = as.numeric(Mn_ug_mL)) %>%
mutate(Mg_ug_mL = as.numeric(Mg_ug_mL)) %>%
mutate(Na_ug_mL = as.numeric(Na_ug_mL)) %>%
mutate(P_ug_mL = as.numeric(P_ug_mL)) %>%
mutate(Fe_ug_mL = as.numeric(Fe_ug_mL)) %>%
pivot_longer(-c(SampleID, date, Time, Area, Site, Plot, day, month, year, Depth_cm), names_to = 'ICP', values_to = 'concentration') %>%
mutate(concentration = concentration * 10)
source("code/0-packages.R")
raw_ICP = read.csv("raw/2023_LIME_ICPAES_002R_Herndon_0118.csv")
raw_ICP_diluted = read.csv("raw/2023_LIME_ICPAES_002R_Herndon_0118_diluted.csv")
combo_redox_withdepths2022 = read.csv("processed/allcombine_2022_frozen.csv")
processed_ICP_diluted =
raw_ICP_diluted %>%
mutate(Area = recode(Area, "West" = "non-acidic tundra",
"East" = "acidic tundra")) %>%
mutate(Area = factor(Area, levels = c("non-acidic tundra", "acidic tundra"))) %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
# dplyr::select(c(SampleID, Date, Time, Area, Site, Plot, Depth_cm, Al_ug_mL, Ca_ug_mL, Fe_ug_mL,
#                 K_ug_mL, Mg_ug_mL, Mn_ug_mL, Na_ug_mL, P_ug_mL)) %>%
mutate(P_ug_mL = recode(P_ug_mL, "<0.01" = "0.005",
"<0.1" = "0.05")) %>%  #this seems like an error...need to check
separate(Date, sep = "-", into =c('day', 'month', 'year')) %>%
mutate(month = recode(month, "Jun" = "06", "Jul" = "07", "Aug" = "08", "Sep" = "09")) %>%
mutate(year = recode(year, "22" = "2022")) %>%
mutate(date = as.Date(paste(year, month, day, sep = "-"))) %>%
mutate(Al_ug_mL = as.numeric(Al_ug_mL)) %>%
mutate(Ca_ug_mL = as.numeric(Ca_ug_mL)) %>%
mutate(K_ug_mL = as.numeric(K_ug_mL)) %>%
mutate(Mn_ug_mL = as.numeric(Mn_ug_mL)) %>%
mutate(Mg_ug_mL = as.numeric(Mg_ug_mL)) %>%
mutate(Na_ug_mL = as.numeric(Na_ug_mL)) %>%
mutate(P_ug_mL = as.numeric(P_ug_mL)) %>%
mutate(Fe_ug_mL = as.numeric(Fe_ug_mL)) %>%
pivot_longer(-c(SampleID, date, Time, Area, Site, Plot, day, month, year, Depth_cm), names_to = 'ICP', values_to = 'concentration') %>%
mutate(concentration = concentration * 10)
processed_ICP =
raw_ICP %>%
mutate(Area = recode(Area, "West" = "non-acidic tundra",
"East" = "acidic tundra")) %>%
mutate(Area = factor(Area, levels = c("non-acidic tundra", "acidic tundra"))) %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
na.omit() %>%
dplyr::select(c(SampleID, Date, Time, Area, Site, Plot, Depth_cm, Al_ug_mL, Ca_ug_mL, Fe_ug_mL,
K_ug_mL, Mg_ug_mL, Mn_ug_mL, Na_ug_mL, P_ug_mL)) %>%
na.omit() %>%
mutate(Al_ug_mL = recode(Al_ug_mL, "<0.01" = "0.005")) %>%
mutate(Mn_ug_mL = recode(Mn_ug_mL, "<0.005" = '0.003')) %>%
mutate(P_ug_mL = recode(P_ug_mL, "<0.01" = "0.005",
"<0.1" = "0.05")) %>%  #this seems like an error...need to check
separate(Date, sep = "-", into =c('day', 'month', 'year')) %>%
mutate(month = recode(month, "Jun" = "06", "Jul" = "07", "Aug" = "08", "Sep" = "09")) %>%
mutate(year = recode(year, "22" = "2022")) %>%
mutate(date = as.Date(paste(year, month, day, sep = "-"))) %>%
mutate(Al_ug_mL = as.numeric(Al_ug_mL)) %>%
mutate(Ca_ug_mL = as.numeric(Ca_ug_mL)) %>%
mutate(K_ug_mL = as.numeric(K_ug_mL)) %>%
mutate(Mn_ug_mL = as.numeric(Mn_ug_mL)) %>%
mutate(Mg_ug_mL = as.numeric(Mg_ug_mL)) %>%
mutate(Na_ug_mL = as.numeric(Na_ug_mL)) %>%
mutate(P_ug_mL = as.numeric(P_ug_mL)) %>%
mutate(Fe_ug_mL = as.numeric(Fe_ug_mL)) %>%
pivot_longer(-c(SampleID, date, Time, Area, Site, Plot, day, month, year, Depth_cm), names_to = 'ICP', values_to = 'concentration') %>%
vctrs::vec_c(processed_ICP_diluted) %>%
mutate(month = recode(month, "06" = "June", "07" = "July", "08" = "August", "09" = "September"))
processed_ICP_wider =
processed_ICP %>%
pivot_wider(names_from = "ICP", values_from = "concentration")
processed_ICP_grouped =
processed_ICP %>%
pivot_wider(names_from = "ICP", values_from = "concentration") %>%
group_by(Area, Site, Depth_cm, date) %>%
dplyr::summarise(mean_Al_ug_mL = round(mean(Al_ug_mL),3),
mean_Ca_ug_mL = round(mean(Ca_ug_mL),3),
mean_K_ug_mL = round(mean(K_ug_mL),3),
mean_Mn_ug_mL = round(mean(Mn_ug_mL),3),
mean_Mg_ug_mL = round(mean(Mg_ug_mL),3),
mean_Na_ug_mL = round(mean(Na_ug_mL),3),
mean_P_ug_mL = round(mean(P_ug_mL),3),
mean_Fe_ug_mL = round(mean(Fe_ug_mL),3),
sd_Al_ug_mL = round(sd(Al_ug_mL),3),
sd_Ca_ug_mL = round(sd(Ca_ug_mL),3),
sd_K_ug_mL = round(sd(K_ug_mL),3),
sd_Mn_ug_mL = round(sd(Mn_ug_mL),3),
sd_Mg_ug_mL = round(sd(Mg_ug_mL),3),
sd_Na_ug_mL = round(sd(Na_ug_mL),3),
sd_P_ug_mL = round(sd(P_ug_mL),3),
sd_Fe_ug_mL = round(sd(Fe_ug_mL),3)
) %>%
separate(date, sep = "-", into =c('year', 'month', 'day')) %>%
mutate(month2 = recode(month, "06" = "June", "07" = "July", "08" = "August", "09" = "September")) %>%
mutate(date_plot = paste(month2, day, year, sep = "-")) %>%
mutate(date_plot = factor(date_plot, levels = c("June-27-2022", "June-29-2022", "July-06-2022",
"July-07-2022", "July-11-2022", "July-12-2022",
"July-18-2022", "July-19-2022", "July-25-2022",
"July-26-2022", "August-07-2022", "August-08-2022",
"September-15-2022","September-17-2022", "September-23-2022"))) %>%
mutate(area_site = paste(Area, Site, sep = "-"))
processed_ICP_grouped_longer =
processed_ICP %>%
pivot_wider(names_from = "ICP", values_from = "concentration") %>%
group_by(Area, Site, Depth_cm, date) %>%
dplyr::summarise(mean_Al_ug_mL = round(mean(Al_ug_mL),3),
mean_Ca_ug_mL = round(mean(Ca_ug_mL),3),
mean_K_ug_mL = round(mean(K_ug_mL),3),
mean_Mn_ug_mL = round(mean(Mn_ug_mL),3),
mean_Mg_ug_mL = round(mean(Mg_ug_mL),3),
mean_Na_ug_mL = round(mean(Na_ug_mL),3),
mean_P_ug_mL = round(mean(P_ug_mL),3),
mean_Fe_ug_mL = round(mean(Fe_ug_mL),3)
) %>%
separate(date, sep = "-", into =c('year', 'month', 'day')) %>%
mutate(month2 = recode(month, "06" = "June", "07" = "July", "08" = "August", "09" = "September")) %>%
mutate(date_plot = paste(month2, day, year, sep = "-")) %>%
mutate(date_plot = factor(date_plot, levels = c("June-27-2022", "June-29-2022", "July-06-2022",
"July-07-2022", "July-11-2022", "July-12-2022",
"July-18-2022", "July-19-2022", "July-25-2022",
"July-26-2022", "August-07-2022", "August-08-2022",
"September-15-2022","September-17-2022", "September-23-2022"))) %>%
mutate(area_site = paste(Area, Site, sep = "-")) %>%
pivot_longer(-c(Area, Site, day, month, year, Depth_cm, month2, date_plot, area_site, mean_P_ug_mL), names_to = 'ICP', values_to = 'concentration')
frozen_group2022 =
combo_redox_withdepths2022 %>%
dplyr::mutate(keep = if_else(site == "non-acidic tundra" & position == "dry" & depth_cm > 21 & Betterdate >= '2022-07-30 00:00', paste0("frozen"),"unfrozen")) %>%
filter(keep == "unfrozen") %>%
mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
separate(TIMESTAMP, sep = " ", into = c("date", "time")) %>%
separate(date, sep = "/", into =c('month', 'day', 'year')) %>%
mutate(date2 = as.Date(paste(year, month, day, sep = "-"))) %>%
dplyr::select(site, position, probe, avg_values_fixed, depth_cm, date2) %>%
filter(date2 == c("2022-06-27", "2022-06-29", "2022-07-06", "2022-07-07",
"2022-07-11", "2022-07-12", "2022-07-18", "2022-07-19",
"2022-07-25", "2022-07-26", "2022-08-07", "2022-08-08",
"2022-09-15", "2022-9-17", "2022-09-23")) %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
group_by(site, position, date2, depth_cm) %>%
dplyr::summarise(redox_avg_mV = round(mean(avg_values_fixed),2),
redox_sd = round(sd(avg_values_fixed),2)) %>%
mutate(depth_cm = case_when(depth_cm >=40 ~ "40",
depth_cm <= 10 ~ "10",
depth_cm == 0 ~ "0",
TRUE ~ "20")) %>%
mutate(depth_cm = as.numeric(depth_cm))
processed_ICP_forredoxcombo =
processed_ICP_grouped %>%
janitor::clean_names() %>%
dplyr::rename(position = site, site = area) %>%
mutate(date2 = as.Date(paste(year, month, day, sep = "-"))) %>%
dplyr::select(-year, -month, -day, -month2, -date_plot, -area_site) %>%
mutate(depth_cm = as.numeric(depth_cm)) %>%
mutate(position = recode(position, "Dry" = "dry",
"Mesic" = 'mesic',
"Hydric" = 'hydric'))
redox_nutrients_leftjoin =
processed_ICP_forredoxcombo %>%
left_join(frozen_group2022) %>%
mutate(depth_cm = factor(depth_cm, levels = c("0", "10", "20", "40")))
redox_nutrients_leftjoin_longer =
processed_ICP_forredoxcombo %>%
left_join(frozen_group2022) %>%
mutate(depth_cm = factor(depth_cm, levels = c("0", "10", "20", "40"))) %>%
dplyr::select(-sd_al_ug_m_l, -sd_ca_ug_m_l, -sd_k_ug_m_l, -sd_mn_ug_m_l,
-sd_mg_ug_m_l, -sd_na_ug_m_l, -sd_p_ug_m_l, -sd_fe_ug_m_l) %>%
pivot_longer(-c(site, position, depth_cm, date2, redox_avg_mV, redox_sd), names_to = 'ICP', values_to = 'concentration') %>%
mutate(ICP = recode(ICP, "mean_fe_ug_m_l" = "iron", "mean_p_ug_m_l" = "phosphorus",
"mean_ca_ug_m_l" = "calcium", "mean_al_ug_m_l" = "aluminum"))
processed_ICP %>%
mutate(month = factor(month, levels = c("June", "July", "August", "September"))) %>%
filter(Area == "acidic tundra" & Site == "Hydric" & ICP == "P_ug_mL") %>%
ggplot() +
geom_point(aes(x = concentration, y = Depth_cm, color = month), size = 3, alpha = 0.75)+
labs(x = "P ug, ml",
y = "depth, cm",
color = "month, 2022"
)+
scale_color_manual(values = c("#f94144", "#f8961e", "#43aa8b", "#577590"))+
# scale_color_manual(values = c("#f07167", "#a7c957", "#1e96fc", "#f07167", "#a7c957", "#1e96fc"))+
scale_y_reverse()+
facet_grid(Site~Area)+
theme_er1()+
theme(legend.position = "right")
processed_ICP %>%
mutate(month = factor(month, levels = c("June", "July", "August", "September"))) %>%
#filter(Area == "acidic tundra" & Site == "Hydric" & ICP == "P_ug_mL") %>%
ggplot() +
geom_point(aes(x = concentration, y = Depth_cm, color = month), size = 3, alpha = 0.75)+
labs(x = "P ug, ml",
y = "depth, cm",
color = "month, 2022"
)+
scale_color_manual(values = c("#f94144", "#f8961e", "#43aa8b", "#577590"))+
# scale_color_manual(values = c("#f07167", "#a7c957", "#1e96fc", "#f07167", "#a7c957", "#1e96fc"))+
scale_y_reverse()+
facet_grid(Site~Area)+
theme_er1()+
theme(legend.position = "right")
processed_ICP %>%
mutate(month = factor(month, levels = c("June", "July", "August", "September"))) %>%
# filter(Area == "acidic tundra" & Site == "Hydric" & ICP == "P_ug_mL") %>%
filter(ICP == "P_ug_mL") %>%
ggplot() +
geom_point(aes(x = concentration, y = Depth_cm, color = month), size = 3, alpha = 0.75)+
labs(x = "P ug, ml",
y = "depth, cm",
color = "month, 2022"
)+
scale_color_manual(values = c("#f94144", "#f8961e", "#43aa8b", "#577590"))+
# scale_color_manual(values = c("#f07167", "#a7c957", "#1e96fc", "#f07167", "#a7c957", "#1e96fc"))+
scale_y_reverse()+
facet_grid(Site~Area)+
theme_er1()+
theme(legend.position = "right")
processed_ICP %>%
mutate(month = factor(month, levels = c("June", "July", "August", "September"))) %>%
# filter(Area == "acidic tundra" & Site == "Hydric" & ICP == "P_ug_mL") %>%
filter(ICP == "Fe_ug_mL") %>%
ggplot() +
geom_point(aes(x = concentration, y = Depth_cm, color = month), size = 3, alpha = 0.75)+
labs(x = "Fe ug, ml",
y = "depth, cm",
color = "month, 2022"
)+
scale_color_manual(values = c("#f94144", "#f8961e", "#43aa8b", "#577590"))+
# scale_color_manual(values = c("#f07167", "#a7c957", "#1e96fc", "#f07167", "#a7c957", "#1e96fc"))+
scale_y_reverse()+
facet_grid(Site~Area)+
theme_er1()+
theme(legend.position = "right")
processed_ICP %>%
mutate(month = factor(month, levels = c("June", "July", "August", "September"))) %>%
# filter(Area == "acidic tundra" & Site == "Hydric" & ICP == "P_ug_mL") %>%
filter(ICP == "Fe_ug_mL") %>%
ggplot() +
geom_point(aes(x = concentration, y = Depth_cm, color = month), size = 3, alpha = 0.75)+
labs(x = "Fe ug, ml",
y = "depth, cm",
color = "month, 2022"
)+
scale_color_manual(values = c("#f94144", "#f8961e", "#43aa8b", "#577590"))+
# scale_color_manual(values = c("#f07167", "#a7c957", "#1e96fc", "#f07167", "#a7c957", "#1e96fc"))+
scale_y_reverse()+
facet_grid(Site~Area, scales = "free_x")+
theme_er1()+
theme(legend.position = "right")
