force()
}
westhydric_depths =
depths_function(westhydric_avg)%>%
na.omit()
easthydric_depths =
depths_function(easthydric_avg) %>%
na.omit()
westmesic_depths =
depths_function(westmesic_avg)%>%
na.omit()
eastmesic_depths =
depths_function(eastmesic_avg)%>%
na.omit()
westdry_depths =
depths_function(westdry_avg)%>%
na.omit()
eastdry_depths =
depths_function(eastdry_avg) %>%
na.omit()
eastdry_depths2 =
eastdry_depths %>%
select(-c(sensor)) %>%
pivot_wider(names_from = 'depth_cm', values_from = 'avg_values_fixed') %>%
mutate(lag = lag(avg_values_fixed)-avg_values_fixed,
lead = lead(avg_values_fixed)-avg_values_fixed) %>%
mutate(laglead = case_when(lag > 200 & lead < -200 ~ 'artifact',
lag < -200 & lead > 200 ~ 'artifact'))
eastdry_depths2 =
eastdry_depths %>%
select(-c(sensor))
eastdry_depths2 =
eastdry_depths %>%
-select(sensor)
eastdry_depths2 =
eastdry_depths %>%
-select('sensor')
eastdry_depths2 =
eastdry_depths %>%
dplyr::-select('sensor')
eastdry_depths2 =
eastdry_depths %>%
dplyr::select(-c('sensor'))
eastdry_depths2 =
eastdry_depths %>%
dplyr::select(-c('sensor')) %>%
pivot_wider(names_from = 'depth_cm', values_from = 'avg_values_fixed')
View(eastdry_depths2)
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::select(-c('sensor')) %>%
pivot_wider(names_from = 'depth_cm', values_from = 'avg_values_fixed')
View(eastdry_depths_probe1)
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::select(-c('sensor', 'record')) %>%
pivot_wider(names_from = 'depth_cm', values_from = 'avg_values_fixed')
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::select(-c('sensor', 'record'))
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::select(-c('sensor', 'RECORD')) %>%
pivot_wider(names_from = 'depth_cm', values_from = 'avg_values_fixed')
View(eastdry_depths_probe1)
View(eastdry_depths_probe1)
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::select(-c('sensor', 'RECORD', 'avg_values'))
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::select(-c('sensor', 'RECORD', 'avg_values')) %>%
pivot_wider(names_from = 'depth_cm', values_from = 'avg_values_fixed')
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::select(-c('sensor', 'RECORD', 'avg_values')) %>%
pivot_wider(names_from = 'depth_cm', values_from = 'avg_values_fixed') %>%
mutate(lag = lag(avg_values_fixed)-avg_values_fixed,
lead = lead(avg_values_fixed)-avg_values_fixed)
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::select(-c('sensor', 'RECORD', 'avg_values')) %>%
pivot_wider(names_from = 'depth_cm', values_from = 'avg_values_fixed') %>%
mutate(lag5 = lag('5')-'5',
lead5 = lead("5")-'5')
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::select(-c('sensor', 'RECORD', 'avg_values')) %>%
pivot_wider(names_from = 'depth_cm', values_from = 'avg_values_fixed') %>%
dplyr::rename("5" = "depth5")
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::select(-c("depth_cm", 'RECORD', 'avg_values')) %>%
pivot_wider(names_from = 'sensor', values_from = 'avg_values_fixed')
View(eastdry_depths_probe1)
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
mutate(sensor = recode(sensor, "1" == "sensor1"))
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
mutate(sensor = recode(sensor, "sensor1" = "1"))
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
mutate(sensor = recode(sensor, "sensor1" = "1"))
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::mutate(sensor = recode(sensor, "sensor1" = "1"))
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::mutate(sensor = recode(sensor, "sensor1" = 1))
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::mutate(sensor = recode(sensor, 1 = "sensor1"))
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::mutate(sensor = recode(sensor, 1 = "sensor1"))
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::mutate(sensor = recode(sensor, '1' = "sensor1"))
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::mutate(sensor = recode(sensor, '1' = "sensor1",
sensor, '2' = "sensor2",
sensor, '3' = "sensor3",
sensor, '4' = "sensor4"))
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::mutate(sensor = recode(sensor, '1' = "sensor1",
sensor, '2' = "sensor2",
sensor, '3' = "sensor3",
sensor, '4' = "sensor4"))
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::select(-c("depth_cm", 'RECORD', 'avg_values')) %>%
pivot_wider(names_from = 'sensor', values_from = 'avg_values_fixed')
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::select(-c("depth_cm", 'RECORD', 'avg_values')) %>%
pivot_wider(names_from = 'sensor', values_from = 'avg_values_fixed') %>%
mutate(lag1 = lag('1')-'1',
lead1 = lead("1")-'1')
eastdry_depths_probe1 =
eastdry_depths %>%
filter(probe == 1) %>%
dplyr::select(-c("depth_cm", 'RECORD', 'avg_values')) %>%
pivot_wider(names_from = 'sensor', values_from = 'avg_values_fixed') %>%
mutate(lag1 = lag(c('1'))-c('1'),
lead1 = lead(c("1"))-c('1'))
eastdry_depths_probe1 =
eastdry_depths %>%
utate(sensor = recode(sensor, "1" = "S1", "2" = "S2", "3" = "S3", "4" = "S4"))
eastdry_depths_probe1 =
eastdry_depths %>%
mutate(sensor = recode(sensor, "1" = "S1", "2" = "S2", "3" = "S3", "4" = "S4"))
eastdry_depths_probe1 =
eastdry_depths %>%
mutate(sensor = recode(sensor, "1" = "S1", "2" = "S2", "3" = "S3", "4" = "S4")) %>%
filter(probe == 1) %>%
dplyr::select(-c("depth_cm", 'RECORD', 'avg_values')) %>%
pivot_wider(names_from = 'sensor', values_from = 'avg_values_fixed')
eastdry_depths_probe1 =
eastdry_depths %>%
mutate(sensor = recode(sensor, "1" = "S1", "2" = "S2", "3" = "S3", "4" = "S4")) %>%
filter(probe == 1) %>%
dplyr::select(-c("depth_cm", 'RECORD', 'avg_values')) %>%
pivot_wider(names_from = 'sensor', values_from = 'avg_values_fixed') %>%
mutate(lag1 = lag("S1")-"S1",
lead1 = lead("S1")-"S1")
eastdry_depths_probe1 =
eastdry_depths %>%
mutate(sensor = recode(sensor, "1" = "S1", "2" = "S2", "3" = "S3", "4" = "S4")) %>%
filter(probe == 1) %>%
dplyr::select(-c("depth_cm", 'RECORD', 'avg_values')) %>%
pivot_wider(names_from = 'sensor', values_from = 'avg_values_fixed') %>%
mutate(lagS1 = lag("S1")-"S1",
leadS1 = lead("S1")-"S1")
eastdry_depths_probe1 =
eastdry_depths %>%
mutate(sensor = recode(sensor, "1" = "S1", "2" = "S2", "3" = "S3", "4" = "S4")) %>%
filter(probe == 1) %>%
dplyr::select(-c("depth_cm", 'RECORD', 'avg_values')) %>%
pivot_wider(names_from = 'sensor', values_from = 'avg_values_fixed') %>%
mutate(lagS1 = lag(S1)-S1,
leadS1 = lead(S1)-S1)
eastdry_depths_probe1 =
eastdry_depths %>%
mutate(sensor = recode(sensor, "1" = "S1", "2" = "S2", "3" = "S3", "4" = "S4")) %>%
filter(probe == 1) %>%
dplyr::select(-c("depth_cm", 'RECORD', 'avg_values')) %>%
pivot_wider(names_from = 'sensor', values_from = 'avg_values_fixed') %>%
mutate(lagS1 = lag(S1)-S1,
leadS1 = lead(S1)-S1,
lagS2 = lag(S2)-S2,
leadS2 = lead(S2)-S2,
lagS3 = lag(S3)-S3,
leadS3 = lead(S3)-S3,
lagS4 = lag(S4)-S4,
leadS4 = lead(S4)-S4,
)
eastdry_depths_probe1 =
eastdry_depths %>%
mutate(sensor = recode(sensor, "1" = "S1", "2" = "S2", "3" = "S3", "4" = "S4")) %>%
filter(probe == 1) %>%
dplyr::select(-c("depth_cm", 'RECORD', 'avg_values')) %>%
pivot_wider(names_from = 'sensor', values_from = 'avg_values_fixed') %>%
mutate(lagS1 = lag(S1)-S1,
leadS1 = lead(S1)-S1,
lagS2 = lag(S2)-S2,
leadS2 = lead(S2)-S2,
lagS3 = lag(S3)-S3,
leadS3 = lead(S3)-S3,
lagS4 = lag(S4)-S4,
leadS4 = lead(S4)-S4,
)
View(eastdry_depths_probe1)
eastdry_depths_probe1_artifacts =
eastdry_depths_probe1 %>%
dplyr::select(-c("lagS1", 'leadS1', 'lagS2', "leadS2",
"lagS3", "leadS3", 'lagS4', "leadS4"))
eastdry_depths_probe1_dataonly =
eastdry_depths_probe1 %>%
dplyr::select(-c("lagS1", 'leadS1', 'lagS2', "leadS2",
"lagS3", "leadS3", 'lagS4', "leadS4"))
eastdry_depths_probe1_dataonly =
eastdry_depths_probe1 %>%
dplyr::select(-c("lagS1", 'leadS1', 'lagS2', "leadS2",
"lagS3", "leadS3", 'lagS4', "leadS4"))
eastdry_depths_probe1_artifacts =
eastdry_depths_probe1 %>%
dplyr::select(-c("S1", 'S2', 'S3', "S4"))
View(eastdry_depths_probe1_artifacts)
View(eastdry_depths_probe1_dataonly)
eastdry_depths_probe1 =
eastdry_depths %>%
mutate(sensor = recode(sensor, "1" = "S1", "2" = "S2", "3" = "S3", "4" = "S4")) %>%
filter(probe == 1) %>%
dplyr::select(-c("depth_cm", 'RECORD', 'avg_values')) %>%
pivot_wider(names_from = 'sensor', values_from = 'avg_values_fixed') %>%
mutate(lagS1 = lag(S1)-S1,
leadS1 = lead(S1)-S1,
lagS2 = lag(S2)-S2,
leadS2 = lead(S2)-S2,
lagS3 = lag(S3)-S3,
leadS3 = lead(S3)-S3,
lagS4 = lag(S4)-S4,
leadS4 = lead(S4)-S4,
) %>%
mutate(checknum = row_number())
eastdry_depths_probe1_dataonly =
eastdry_depths_probe1 %>%
dplyr::select(-c("lagS1", 'leadS1', 'lagS2', "leadS2",
"lagS3", "leadS3", 'lagS4', "leadS4")) %>%
pivot_longer(-c("TIMESTAMP", "site", "position", "Betterdate",
"datalogger", "probe", "Plot"),
names_to = "sensor", values_to = "avg_values_fixed")
eastdry_depths_only =
eastdry_depths
eastdry_depths_probe1_dataonly =
eastdry_depths_probe1 %>%
dplyr::select(-c("lagS1", 'leadS1', 'lagS2', "leadS2",
"lagS3", "leadS3", 'lagS4', "leadS4")) %>%
pivot_longer(-c("TIMESTAMP", "site", "position", "Betterdate",
"datalogger", "probe", "Plot"),
names_to = "sensor", values_to = "avg_values_fixed") %>%
left_join(eastdry_depths)
eastdry_depths_probe1_dataonly =
eastdry_depths_probe1 %>%
dplyr::select(-c("lagS1", 'leadS1', 'lagS2', "leadS2",
"lagS3", "leadS3", 'lagS4', "leadS4")) %>%
pivot_longer(-c("TIMESTAMP", "site", "position", "Betterdate",
"datalogger", "probe", "Plot"),
names_to = "sensor", values_to = "avg_values_fixed") %>%
mutate(sensor = recode(sensor, "S1" = 1, "S2" = 2, "S3" = 3, "S4" = 4))
eastdry_depths_probe1_dataonly =
eastdry_depths_probe1 %>%
dplyr::select(-c("lagS1", 'leadS1', 'lagS2', "leadS2",
"lagS3", "leadS3", 'lagS4', "leadS4")) %>%
pivot_longer(-c("TIMESTAMP", "site", "position", "Betterdate",
"datalogger", "probe", "Plot"),
names_to = "sensor", values_to = "avg_values_fixed") %>%
mutate(sensor = recode(sensor, "S1" = 1, "S2" = 2, "S3" = 3, "S4" = 4)) %>%
left_join(eastdry_depths)
eastdry_depths_probe1_dataonly =
eastdry_depths_probe1 %>%
dplyr::select(-c("lagS1", 'leadS1', 'lagS2', "leadS2",
"lagS3", "leadS3", 'lagS4', "leadS4")) %>%
pivot_longer(-c("TIMESTAMP", "site", "position", "Betterdate",
"datalogger", "probe", "Plot"),
names_to = "sensor", values_to = "avg_values_fixed") %>%
mutate(sensor = recode(sensor, "S1" = 1, "S2" = 2, "S3" = 3, "S4" = 4)) %>%
na.omit() %>%
left_join(eastdry_depths)
View(eastdry_depths_probe1_dataonly)
eastdry_depths_probe1_artifacts =
eastdry_depths_probe1 %>%
dplyr::select(-c("S1", 'S2', 'S3', "S4")) %>%
pivot_longer(-c("TIMESTAMP", "site", "position", "Betterdate",
"datalogger", "probe", "Plot"),
names_to = "redox_avg", values_to = "avg_values")
eastdry_depths_probe1_artifacts =
eastdry_depths_probe1 %>%
dplyr::select(-c("S1", 'S2', 'S3', "S4"))
eastdry_depths_probe1_artifacts =
eastdry_depths_probe1 %>%
dplyr::select(-c("S1", 'S2', 'S3', "S4")) %>%
pivot_longer(-c("TIMESTAMP", "site", "position", "Betterdate",
"datalogger", "probe", "Plot")
eastdry_depths_probe1_artifacts =
eastdry_depths_probe1 %>%
dplyr::select(-c("S1", 'S2', 'S3', "S4")) %>%
pivot_longer(-c("TIMESTAMP", "site", "position", "Betterdate",
"datalogger", "probe", "Plot"),
names_to = "Lags", values_to = "") %>%
mutate(laglead = case_when(lagS1 > 200 & leadS1 < -200 ~ 'artifact',
lagS1 < -200 & leadS1 > 200 ~ 'artifact',
lagS2 > 200 & leadS2 < -200 ~ 'artifact',
lagS2 < -200 & leadS2 > 200 ~ 'artifact',
lagS3 > 200 & leadS3 < -200 ~ 'artifact',
lagS3 < -200 & leadS3 > 200 ~ 'artifact',
lagS4 > 200 & leadS4 < -200 ~ 'artifact',
lagS4 < -200 & leadS4 > 200 ~ 'artifact'))
eastdry_depths_probe1_artifacts =
eastdry_depths_probe1 %>%
dplyr::select(-c("S1", 'S2', 'S3', "S4")) %>%
# pivot_longer(-c("TIMESTAMP", "site", "position", "Betterdate",
#                 "datalogger", "probe", "Plot"),
#              names_to = "Lags", values_to = "") %>%
mutate(laglead = case_when(lagS1 > 200 & leadS1 < -200 ~ 'artifact',
lagS1 < -200 & leadS1 > 200 ~ 'artifact',
lagS2 > 200 & leadS2 < -200 ~ 'artifact',
lagS2 < -200 & leadS2 > 200 ~ 'artifact',
lagS3 > 200 & leadS3 < -200 ~ 'artifact',
lagS3 < -200 & leadS3 > 200 ~ 'artifact',
lagS4 > 200 & leadS4 < -200 ~ 'artifact',
lagS4 < -200 & leadS4 > 200 ~ 'artifact'))
source("code/0-packages.R")
westhydric_dlname = read.csv("processed/westhydric_dlname.csv")
easthydric_dlname = read.csv("processed/easthydric_dlname.csv")
westmesic_dlname = read.csv("processed/westmesic_dlname.csv")
eastmesic_dlname = read.csv("processed/eastmesic_dlname.csv")
westdry_dlname = read.csv("processed/westdry_dlname.csv")
eastdry_dlname = read.csv("processed/eastdry_dlname.csv")
westhydric_metadata = read.csv("processed/westhydric_metadata.csv")
easthydric_metadata = read.csv("processed/easthydric_metadata.csv")
westmesic_metadata = read.csv("processed/westmesic_metadata.csv")
eastmesic_metadata = read.csv("processed/eastmesic_metadata.csv")
westdry_metadata = read.csv("processed/westdry_metadata.csv")
eastdry_metadata = read.csv("processed/eastdry_metadata.csv")
avg_separate <- function(dat){
dat %>%
mutate(redox_NUM_Avg = X) %>%
dplyr::select(-X) %>%
# dplyr::select(c('X') &
dplyr::select(starts_with('redox')) %>%
dplyr::select(ends_with('Avg')) %>%
#if needed, get rid of NA rows then columns. Not needed.
# filter(redox_NUM_Avg < 5989) %>%
# select_if(~ !any(is.na(.))) %>%
force()
}
westhydric_avg =
avg_separate(westhydric_dlname) %>%
left_join(westhydric_metadata, by = 'redox_NUM_Avg') %>%
pivot_longer(-c("redox_NUM_Avg", "TIMESTAMP", "RECORD", "site", "position", "Betterdate"),
names_to = "redox_avg", values_to = "avg_values") %>%
#add 197 to all redox potentials to report data relative to the standard hydrogen electrode
dplyr::mutate(avg_values_fixed = avg_values + 197) %>%
filter(avg_values_fixed < 1000) %>%
filter(avg_values_fixed > -600)
westmesic_avg =
avg_separate(westmesic_dlname) %>%
left_join(westmesic_metadata, by = 'redox_NUM_Avg') %>%
pivot_longer(-c("redox_NUM_Avg", "TIMESTAMP", "RECORD", "site", "position", "Betterdate"),
names_to = "redox_avg", values_to = "avg_values") %>%
dplyr::mutate(avg_values_fixed = avg_values + 197) %>%
filter(avg_values_fixed < 1000) %>%
filter(avg_values_fixed > -600)
westdry_avg =
avg_separate(westdry_dlname) %>%
left_join(westdry_metadata, by = 'redox_NUM_Avg') %>%
pivot_longer(-c("redox_NUM_Avg", "TIMESTAMP", "RECORD", "site", "position", "Betterdate"),
names_to = "redox_avg", values_to = "avg_values") %>%
dplyr::mutate(avg_values_fixed = avg_values + 197) %>%
filter(avg_values_fixed < 1000) %>%
filter(avg_values_fixed > -600)
easthydric_avg =
avg_separate(easthydric_dlname) %>%
left_join(easthydric_metadata, by = 'redox_NUM_Avg') %>%
pivot_longer(-c("redox_NUM_Avg", "TIMESTAMP", "RECORD", "site", "position", "Betterdate"),
names_to = "redox_avg", values_to = "avg_values") %>%
dplyr::mutate(avg_values_fixed = avg_values + 197) %>%
filter(avg_values_fixed < 1000) %>%
filter(avg_values_fixed > -600)
eastmesic_avg =
avg_separate(eastmesic_dlname) %>%
left_join(eastmesic_metadata, by = 'redox_NUM_Avg') %>%
pivot_longer(-c("redox_NUM_Avg", "TIMESTAMP", "RECORD", "site", "position", "Betterdate"),
names_to = "redox_avg", values_to = "avg_values") %>%
dplyr::mutate(avg_values_fixed = avg_values + 197) %>%
filter(avg_values_fixed < 1000) %>%
filter(avg_values_fixed > -600)
eastdry_avg =
avg_separate(eastdry_dlname) %>%
left_join(eastdry_metadata, by = 'redox_NUM_Avg') %>%
pivot_longer(-c("redox_NUM_Avg", "TIMESTAMP", "RECORD", "site", "position", "Betterdate"),
names_to = "redox_avg", values_to = "avg_values") %>%
dplyr::mutate(avg_values_fixed = avg_values + 197) %>%
filter(avg_values_fixed < 1000) %>%
filter(avg_values_fixed > -600)
sensor_depths_prename = read.csv("raw/datalogger_depths.csv")
sensor_depths =
sensor_depths_prename %>%
dplyr::rename(position = Site,
site = Area) %>%
mutate(site = recode(site, "West" = "west",
"East" = "east")) %>%
mutate(position = recode(position, "Hydric" = "hydric",
"Mesic" = "mesic",
"Dry" = "dry"),
Sensor = recode(Sensor, "redox_5-2-3_fromtip_Avg" = "redox_5_2-3_fromtip_Avg")) %>%
mutate(Sensor = str_remove(Sensor, "Redox_")) %>%
mutate(Sensor = str_remove(Sensor, "redox_")) %>%
mutate(Sensor = str_remove(Sensor, "_fromtip_Avg")) %>%
separate(Sensor, sep = "_", into = c("datalogger", "probe_sensor")) %>%
separate(probe_sensor, sep = "-", into = c("probe", "sensor")) %>%
mutate(sensor = as.numeric(sensor)) %>%
mutate(depth_cm = str_replace(depth_cm, "n.a.", "NA")) %>%
mutate(depth_cm = as.numeric(depth_cm)) %>%
na.omit()
depths_function <- function(dat){
dat  %>%
mutate(redox_avg = recode(redox_avg, 'redox_5.2.3_fromtip_Avg' = "redox_5_2_3_fromtip_Avg")) %>%
mutate(redox_avg = str_remove(redox_avg, "Redox_")) %>%
mutate(redox_avg = str_remove(redox_avg, "redox_")) %>%
mutate(redox_avg = str_remove(redox_avg, "_fromtip_Avg")) %>%
separate(redox_avg, sep = "_", into = c("datalogger", "probe_sensor")) %>%
filter(datalogger != "NUM") %>%
dplyr::select(-redox_NUM_Avg) %>%
mutate(probe_sensor = recode(probe_sensor, "1.8" = "1_8", "1.7" = "1_7", "1.6" = "1_6", "1.5" = "1_5", "1.4" = "1_4", "1.3" = "1_3", "1.2" = "1_2", "1.1" = "1_1",
"2.8" = "2_8", "2.7" = "2_7", "2.6" = "2_6", "2.5" = "2_5", "2.4" = "2_4", "2.3" = "2_3", "2.2" = "2_2", "2.1" = "2_1",
"3.8" = "3_8", "3.7" = "3_7", "3.6" = "3_6", "3.5" = "3_5", "3.4" = "3_4", "3.3" = "3_3", "3.2" = "3_2", "3.1" = "3_1")) %>%
separate(probe_sensor, sep = "_", into = c("probe", "sensor")) %>%
mutate(sensor = as.numeric(sensor)) %>%
left_join(sensor_depths) %>%
force()
}
westhydric_depths =
depths_function(westhydric_avg)%>%
na.omit()
easthydric_depths =
depths_function(easthydric_avg) %>%
na.omit()
westmesic_depths =
depths_function(westmesic_avg)%>%
na.omit()
eastmesic_depths =
depths_function(eastmesic_avg)%>%
na.omit()
westdry_depths =
depths_function(westdry_avg)%>%
na.omit()
eastdry_depths =
depths_function(eastdry_avg) %>%
na.omit()
datacleaning_function <- function(dat){
dat %>%
mutate(lag = lag(avg_values_fixed)-avg_values_fixed,
lead = lead(avg_values_fixed)-avg_values_fixed) %>%
mutate(laglead = case_when(lag > 100 & lead < -100 ~ 'artifact',
lag < -100 & lead > 100 ~ 'artifact'),
laglead = if_else(is.na(laglead), "keep", laglead)) %>%
filter(laglead == "keep")
}
westhydric_probe1_notcleaned =
westhydric_depths %>%
filter(probe == "1")
temporary_fig_notcleaned =
westhydric_probe1_notcleaned %>%
#filter(type == "temp_avg" & depth > 20) %>%
ggplot(aes(x = Betterdate, y = avg_values_fixed))+
geom_point(aes(color = depth_cm), alpha = 0.5)+
geom_line(aes(group = depth_cm, color = depth_cm, orientation = "x"))+
scale_color_gradientn(colors = natparks.pals(name = "KingsCanyon", 8))+
#scale_x_date(date_breaks = "1 day" , date_labels = "%Y-%m-%d")+
#scale_x_discrete(breaks = seq(-1,31,2))+
labs(y = "redox potential, mV")+
#facet_wrap(month_name~.)+
theme_er1()+
theme(axis.text.x = element_text (size = 10 , vjust = 0.5, hjust=1, angle = 90))
ggsave("output/temporary_fig_notcleaned.png", plot = temporary_fig_notcleaned, width = 20, height = 8)
