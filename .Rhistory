salinity_se = round(sd(salinity)/sqrt(n()),2))
final_temp_sal_moist_bins_forjoin_daily =
final_temp_sal_moist_bins_forjoin %>%
separate(Betterdate, sep = " ", into = c("date", "time")) %>%
separate(date, sep = "-", into = c("year", "month", "day")) %>%
group_by(site, position, month, day, depth) %>%
dplyr::summarise(temp_avg = round(mean(temp),2),
temp_se = round(sd(temp)/sqrt(n()),2),
moisture_avg = round(mean(moisture),2),
moisture_se = round(sd(moisture)/sqrt(n()),2),
salinity_avg = round(mean(salinity),2),
salinity_se = round(sd(salinity)/sqrt(n()),2))
View(combo_redox_threedepths_avgdaily)
combo_redox_threedepths_avgdaily =
combo_redox_withdepths %>%
rename(depth_redox = depth_cm) %>%
mutate(depth = case_when(depth_redox <= 10 ~ 5,
depth_redox <= 20 ~ 15,
depth_redox >= 21 ~ 25)) %>%
mutate(Betterdate2 = Betterdate) %>%
separate(Betterdate, sep = " ", into = c("date", "time")) %>%
separate(date, sep = "-", into = c("year", "month", "day")) %>%
dplyr::select(site, position, Betterdate, Plot, avg_values_fixed, depth, depth_redox) %>%
group_by(site, position, month, day, depth) %>%
dplyr::summarise(depth_avg = round(mean(avg_values_fixed),2),
depth_avg_se = round(sd(avg_values_fixed)/sqrt(n()),2),
n = n()) %>%
left_join(final_temp_sal_moist_bins_forjoin_daily) %>%
rename(redox_avg = depth_avg) %>%
dplyr::mutate(month_name = case_when(grepl("06", month)~"june",
grepl("07", month)~"july",
grepl("08", month)~"august",
grepl("09", month)~"september")) %>%
mutate(month_name = factor(month_name, levels = c("june", "july", "august", "september"))) %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric")))
combo_redox_threedepths_avgdaily =
combo_redox_withdepths %>%
rename(depth_redox = depth_cm) %>%
mutate(depth = case_when(depth_redox <= 10 ~ 5,
depth_redox <= 20 ~ 15,
depth_redox >= 21 ~ 25)) %>%
mutate(Betterdate2 = Betterdate) %>%
separate(Betterdate, sep = " ", into = c("date", "time")) %>%
separate(date, sep = "-", into = c("year", "month", "day")) %>%
dplyr::select(site, position, Plot, avg_values_fixed, depth, depth_redox) %>%
group_by(site, position, month, day, depth) %>%
dplyr::summarise(depth_avg = round(mean(avg_values_fixed),2),
depth_avg_se = round(sd(avg_values_fixed)/sqrt(n()),2),
n = n()) %>%
left_join(final_temp_sal_moist_bins_forjoin_daily) %>%
rename(redox_avg = depth_avg) %>%
dplyr::mutate(month_name = case_when(grepl("06", month)~"june",
grepl("07", month)~"july",
grepl("08", month)~"august",
grepl("09", month)~"september")) %>%
mutate(month_name = factor(month_name, levels = c("june", "july", "august", "september"))) %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric")))
combo_redox_threedepths_avgdaily =
combo_redox_withdepths %>%
rename(depth_redox = depth_cm) %>%
mutate(depth = case_when(depth_redox <= 10 ~ 5,
depth_redox <= 20 ~ 15,
depth_redox >= 21 ~ 25)) %>%
separate(Betterdate, sep = " ", into = c("date", "time")) %>%
separate(date, sep = "-", into = c("year", "month", "day")) %>%
dplyr::select(site, position, Plot, avg_values_fixed, depth, depth_redox) %>%
group_by(site, position, month, day, depth) %>%
dplyr::summarise(depth_avg = round(mean(avg_values_fixed),2),
depth_avg_se = round(sd(avg_values_fixed)/sqrt(n()),2),
n = n()) %>%
left_join(final_temp_sal_moist_bins_forjoin_daily) %>%
rename(redox_avg = depth_avg) %>%
dplyr::mutate(month_name = case_when(grepl("06", month)~"june",
grepl("07", month)~"july",
grepl("08", month)~"august",
grepl("09", month)~"september")) %>%
mutate(month_name = factor(month_name, levels = c("june", "july", "august", "september"))) %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric")))
combo_redox_threedepths_avgdaily =
combo_redox_withdepths %>%
rename(depth_redox = depth_cm) %>%
mutate(depth = case_when(depth_redox <= 10 ~ 5,
depth_redox <= 20 ~ 15,
depth_redox >= 21 ~ 25)) %>%
separate(Betterdate, sep = " ", into = c("date", "time")) %>%
separate(date, sep = "-", into = c("year", "month", "day")) %>%
dplyr::select(site, position, Plot, avg_values_fixed, depth, depth_redox)
View(combo_redox_threedepths_avgdaily)
combo_redox_threedepths_avgdaily =
combo_redox_withdepths %>%
rename(depth_redox = depth_cm) %>%
mutate(depth = case_when(depth_redox <= 10 ~ 5,
depth_redox <= 20 ~ 15,
depth_redox >= 21 ~ 25)) %>%
separate(Betterdate, sep = " ", into = c("date", "time")) %>%
separate(date, sep = "-", into = c("year", "month", "day")) %>%
dplyr::select(site, position, Plot, avg_values_fixed, depth, depth_redox) %>%
group_by(site, position, month, day, depth) %>%
dplyr::summarise(depth_avg = round(mean(avg_values_fixed),2),
depth_avg_se = round(sd(avg_values_fixed)/sqrt(n()),2),
n = n())
combo_redox_threedepths_avgdaily =
combo_redox_withdepths %>%
rename(depth_redox = depth_cm) %>%
mutate(depth = case_when(depth_redox <= 10 ~ 5,
depth_redox <= 20 ~ 15,
depth_redox >= 21 ~ 25)) %>%
separate(Betterdate, sep = " ", into = c("date", "time")) %>%
separate(date, sep = "-", into = c("year", "month", "day")) %>%
dplyr::select(site, position, Plot, avg_values_fixed, month, day, depth, depth_redox) %>%
group_by(site, position, month, day, depth) %>%
dplyr::summarise(depth_avg = round(mean(avg_values_fixed),2),
depth_avg_se = round(sd(avg_values_fixed)/sqrt(n()),2),
n = n()) %>%
left_join(final_temp_sal_moist_bins_forjoin_daily) %>%
rename(redox_avg = depth_avg) %>%
dplyr::mutate(month_name = case_when(grepl("06", month)~"june",
grepl("07", month)~"july",
grepl("08", month)~"august",
grepl("09", month)~"september")) %>%
mutate(month_name = factor(month_name, levels = c("june", "july", "august", "september"))) %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric")))
View(combo_redox_threedepths_avgdaily)
combo_redox_threedepths_avgdaily %>%
filter(redox_avg > 200 & redox_avg < 300) %>%
mutate(depth = factor(depth, levels = c("5", "15", "25"))) %>%
ggplot()+
geom_point(aes(x = moisture, y = salinity, fill = position, color = position, shape = site),
alpha = 0.6, size = 4)+
labs(color = "redox potential, mV",
fill = "redox potential, mV",
subtitle = "Redox potentials 200-300 mV",
y = "salinity, uS",
x = "soil moisture, %")+
scale_fill_manual(values = (PNWColors::pnw_palette("Shuksan", 3)))+
scale_color_manual(values = (PNWColors::pnw_palette("Shuksan", 3)))+
facet_grid(depth~.)+
theme_er1()+
theme(legend.position = "right")
combo_redox_threedepths_avgdaily %>%
filter(redox_avg > 200 & redox_avg < 300) %>%
mutate(depth = factor(depth, levels = c("5", "15", "25"))) %>%
ggplot()+
geom_point(aes(x = moisture_avg, y = salinity_avg, fill = position, color = position, shape = site),
alpha = 0.6, size = 4)+
labs(color = "redox potential, mV",
fill = "redox potential, mV",
subtitle = "Redox potentials 200-300 mV",
y = "salinity, uS",
x = "soil moisture, %")+
scale_fill_manual(values = (PNWColors::pnw_palette("Shuksan", 3)))+
scale_color_manual(values = (PNWColors::pnw_palette("Shuksan", 3)))+
facet_grid(depth~.)+
theme_er1()+
theme(legend.position = "right")
combo_redox_threedepths_avgdaily %>%
filter(redox_avg < 300) %>%
mutate(depth = factor(depth, levels = c("5", "15", "25"))) %>%
ggplot()+
geom_point(aes(x = moisture_avg, y = salinity_avg, fill = position, color = position, shape = site),
alpha = 0.6, size = 4)+
labs(color = "redox potential, mV",
fill = "redox potential, mV",
subtitle = "Redox potentials 200-300 mV",
y = "salinity, uS",
x = "soil moisture, %")+
scale_fill_manual(values = (PNWColors::pnw_palette("Shuksan", 3)))+
scale_color_manual(values = (PNWColors::pnw_palette("Shuksan", 3)))+
facet_grid(depth~.)+
theme_er1()+
theme(legend.position = "right")
combo_redox_threedepths_avgdaily %>%
filter(redox_avg > 300) %>%
mutate(depth = factor(depth, levels = c("5", "15", "25"))) %>%
ggplot()+
geom_point(aes(x = moisture_avg, y = salinity_avg, fill = position, color = position, shape = site),
alpha = 0.6, size = 4)+
labs(color = "redox potential, mV",
fill = "redox potential, mV",
subtitle = "Redox potentials > 300 mV",
y = "salinity, uS",
x = "soil moisture, %")+
scale_fill_manual(values = (PNWColors::pnw_palette("Shuksan", 3)))+
scale_color_manual(values = (PNWColors::pnw_palette("Shuksan", 3)))+
facet_grid(depth~.)+
theme_er1()+
theme(legend.position = "right")
greaterthan300redox =
combo_redox_threedepths_avg %>%
filter(redox_avg > 300) %>%
mutate(depth = factor(depth, levels = c("5", "15", "25"))) %>%
ggplot()+
geom_point(aes(x = moisture, y = salinity, fill = position, color = position, shape = site),
alpha = 0.6, size = 2.5)+
labs(color = "redox potential, mV",
fill = "redox potential, mV",
subtitle = "Redox potentials > 300 mV",
y = "salinity, uS",
x = "soil moisture, %")+
scale_fill_manual(values = (PNWColors::pnw_palette("Shuksan", 3)))+
scale_color_manual(values = (PNWColors::pnw_palette("Shuksan", 3)))+
facet_grid(depth~.)+
theme_er1()+
theme(legend.position = "right")
lessthan300redox =
combo_redox_threedepths_avgdaily %>%
filter(redox_avg < 300) %>%
mutate(depth = factor(depth, levels = c("5", "15", "25"))) %>%
ggplot()+
geom_point(aes(x = moisture_avg, y = salinity_avg, fill = position, color = position, shape = site),
alpha = 0.6, size = 4)+
labs(color = "redox potential, mV",
fill = "redox potential, mV",
subtitle = "Redox potentials < 300 mV",
y = "salinity, uS",
x = "soil moisture, %")+
scale_fill_manual(values = (PNWColors::pnw_palette("Shuksan", 3)))+
scale_color_manual(values = (PNWColors::pnw_palette("Shuksan", 3)))+
facet_grid(depth~.)+
theme_er1()+
theme(legend.position = "right")
greaterthan300redox =
combo_redox_threedepths_avgdaily %>%
filter(redox_avg > 300) %>%
mutate(depth = factor(depth, levels = c("5", "15", "25"))) %>%
ggplot()+
geom_point(aes(x = moisture_avg, y = salinity_avg, fill = position, color = position, shape = site),
alpha = 0.6, size = 4)+
labs(color = "redox potential, mV",
fill = "redox potential, mV",
subtitle = "Redox potentials > 300 mV",
y = "salinity, uS",
x = "soil moisture, %")+
scale_fill_manual(values = (PNWColors::pnw_palette("Shuksan", 3)))+
scale_color_manual(values = (PNWColors::pnw_palette("Shuksan", 3)))+
facet_grid(depth~.)+
theme_er1()+
theme(legend.position = "right")
ggsave(plot = lessthan300redox, "output/lessthan300redox.tiff", width = 4.5, height = 6)
ggsave(plot = greaterthan300redox, "output/greaterthan300redox.tiff", width = 4.5, height = 6)
library(ggbiplot)
## step ii. split into numeric/factor dataframes, and run PCA on those
num =
combo_redox_threedepths_avg %>%
dplyr::select(c(moisture, temp, salinity, redox_avg))
grp =
combo_redox_threedepths_avg %>%
dplyr::select(-c(moisture, temp, salinity, redox_avg),
site,position, depth, month) %>%
dplyr::mutate(row = row_number())
pca = prcomp(num, scale. = T)
## step ii. split into numeric/factor dataframes, and run PCA on those
num =
combo_redox_threedepths_avg %>%
dplyr::select(c(moisture, temp, salinity, redox_avg))
## step ii. split into numeric/factor dataframes, and run PCA on those
num =
combo_redox_threedepths_avg %>%
dplyr::select(-c(site,position),moisture, temp, salinity, redox_avg)
pca = prcomp(num, scale. = T)
## step ii. split into numeric/factor dataframes, and run PCA on those
num =
combo_redox_threedepths_avg %>%
dplyr::select(-c(site,position),moisture, temp, salinity, redox_avg) %>%
dplyr::select(-c(site,position))
View(num)
fornum =
combo_redox_threedepths_avg %>%
dplyr::select(-c(site,position),moisture, temp, salinity, redox_avg)
fornum =
combo_redox_threedepths_avg %>%
ungroup() %>%
dplyr::select(-c(site,position),moisture, temp, salinity, redox_avg)
combo_redox_threedepths_avg =
combo_redox_withdepths %>%
rename(depth_redox = depth_cm) %>%
mutate(depth = case_when(depth_redox <= 10 ~ 5,
depth_redox <= 20 ~ 15,
depth_redox >= 21 ~ 25)) %>%
dplyr::select(site, position, Betterdate, Plot, avg_values_fixed, depth, depth_redox) %>%
group_by(Betterdate, site, position, depth) %>%
dplyr::summarise(depth_avg = round(mean(avg_values_fixed),2),
depth_avg_se = round(sd(avg_values_fixed)/sqrt(n()),2),
n = n()) %>%
left_join(final_temp_sal_moist_bins_forjoin) %>%
mutate(Betterdate2 = Betterdate) %>%
separate(Betterdate, sep = " ", into = c("date", "time")) %>%
separate(date, sep = "-", into = c("year", "month", "day")) %>%
dplyr::mutate(month_name = case_when(grepl("06", month)~"june",
grepl("07", month)~"july",
grepl("08", month)~"august",
grepl("09", month)~"september")) %>%
mutate(month_name = factor(month_name, levels = c("june", "july", "august", "september"))) %>%
rename(redox_avg = depth_avg) %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
ungroup()
final_temp_sal_moist_bins_forjoin_daily =
final_temp_sal_moist_bins_forjoin %>%
separate(Betterdate, sep = " ", into = c("date", "time")) %>%
separate(date, sep = "-", into = c("year", "month", "day")) %>%
group_by(site, position, month, day, depth) %>%
dplyr::summarise(temp_avg = round(mean(temp),2),
temp_se = round(sd(temp)/sqrt(n()),2),
moisture_avg = round(mean(moisture),2),
moisture_se = round(sd(moisture)/sqrt(n()),2),
salinity_avg = round(mean(salinity),2),
salinity_se = round(sd(salinity)/sqrt(n()),2))
combo_redox_threedepths_avgdaily =
combo_redox_withdepths %>%
rename(depth_redox = depth_cm) %>%
mutate(depth = case_when(depth_redox <= 10 ~ 5,
depth_redox <= 20 ~ 15,
depth_redox >= 21 ~ 25)) %>%
separate(Betterdate, sep = " ", into = c("date", "time")) %>%
separate(date, sep = "-", into = c("year", "month", "day")) %>%
dplyr::select(site, position, Plot, avg_values_fixed, month, day, depth, depth_redox) %>%
group_by(site, position, month, day, depth) %>%
dplyr::summarise(depth_avg = round(mean(avg_values_fixed),2),
depth_avg_se = round(sd(avg_values_fixed)/sqrt(n()),2),
n = n()) %>%
left_join(final_temp_sal_moist_bins_forjoin_daily) %>%
rename(redox_avg = depth_avg) %>%
dplyr::mutate(month_name = case_when(grepl("06", month)~"june",
grepl("07", month)~"july",
grepl("08", month)~"august",
grepl("09", month)~"september")) %>%
mutate(month_name = factor(month_name, levels = c("june", "july", "august", "september"))) %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
ungroup()
## step ii. split into numeric/factor dataframes, and run PCA on those
num =
combo_redox_threedepths_avg %>%
dplyr::select(c(moisture, temp, salinity, redox_avg))
grp =
combo_redox_threedepths_avg %>%
dplyr::select(-c(moisture, temp, salinity, redox_avg),
site,position, depth, month) %>%
dplyr::mutate(row = row_number())
pca = prcomp(num, scale. = T)
all_pca =
ggbiplot(pca, obs.scale = 1, var.scale = 1,
groups = as.character(grp$position),
alpha = 0,
ellipse = FALSE, circle = FALSE, var.axes = TRUE) +
geom_point(size=3,stroke=1, aes(fill = groups, color = groups, shape = interaction(grp$site, grp$depth)))+
labs(shape = "", fill = "", color = "",
caption = "solids = control")+
scale_shape_manual(values = c(21, 22, 25, 1, 0, 6))+
scale_color_manual(values = rev(PNWColors::pnw_palette("Bay", 2)))+
scale_fill_manual(values = rev(PNWColors::pnw_palette("Bay", 2)))+
ylim(-4,4)+
xlim(-4,4)+
theme_er()+
guides(fill=guide_legend(override.aes=list(fill="black")))+
theme(legend.position = "NONE",
panel.border = element_rect(color="white",size=0.5, fill = NA))+
NULL
all_pca =
ggbiplot(pca, obs.scale = 1, var.scale = 1,
groups = as.character(grp$position),
alpha = 0,
ellipse = FALSE, circle = FALSE, var.axes = TRUE) +
geom_point(size=3,stroke=1, aes(fill = groups, color = groups, shape = interaction(grp$site, grp$depth)))+
labs(shape = "", fill = "", color = "",
caption = "solids = control")+
scale_shape_manual(values = c(21, 22, 25, 1, 0, 6))+
scale_color_manual(values = rev(PNWColors::pnw_palette("Bay", 2)))+
scale_fill_manual(values = rev(PNWColors::pnw_palette("Bay", 2)))+
ylim(-4,4)+
xlim(-4,4)+
theme_er1()+
guides(fill=guide_legend(override.aes=list(fill="black")))+
theme(legend.position = "NONE",
panel.border = element_rect(color="white",size=0.5, fill = NA))+
NULL
ggbiplot(pca, obs.scale = 1, var.scale = 1,
groups = as.character(grp$position),
alpha = 0,
ellipse = FALSE, circle = FALSE, var.axes = TRUE) +
geom_point(size=3,stroke=1, aes(fill = groups, color = groups, shape = interaction(grp$site, grp$depth)))+
labs(shape = "", fill = "", color = "",
caption = "solids = control")+
scale_shape_manual(values = c(21, 22, 25, 1, 0, 6))+
scale_color_manual(values = rev(PNWColors::pnw_palette("Bay", 2)))+
scale_fill_manual(values = rev(PNWColors::pnw_palette("Bay", 2)))+
ylim(-4,4)+
xlim(-4,4)+
theme_er1()+
guides(fill=guide_legend(override.aes=list(fill="black")))+
theme(legend.position = "NONE",
panel.border = element_rect(color="white",size=0.5, fill = NA))+
NULL
ggbiplot(pca, obs.scale = 1, var.scale = 1,
groups = as.character(grp$position),
alpha = 0,
ellipse = FALSE, circle = FALSE, var.axes = TRUE) +
geom_point(size=3,stroke=1, aes(fill = groups, color = groups, shape = interaction(grp$site, grp$depth)))+
labs(shape = "", fill = "", color = "",
caption = "solids = control")+
scale_shape_manual(values = c(21, 22, 25, 1, 0, 6))+
scale_color_manual(values = rev(PNWColors::pnw_palette("Bay", 3)))+
scale_fill_manual(values = rev(PNWColors::pnw_palette("Bay", 3)))+
ylim(-4,4)+
xlim(-4,4)+
theme_er1()+
guides(fill=guide_legend(override.aes=list(fill="black")))+
theme(legend.position = "NONE",
panel.border = element_rect(color="white",size=0.5, fill = NA))+
NULL
all_pca =
ggbiplot(pca, obs.scale = 1, var.scale = 1,
groups = as.character(grp$position),
alpha = 0,
ellipse = FALSE, circle = FALSE, var.axes = TRUE) +
geom_point(size=3,stroke=1, aes(fill = groups, color = groups, shape = interaction(grp$site, grp$depth)))+
labs(shape = "", fill = "", color = "",
caption = "solids = control")+
scale_shape_manual(values = c(21, 22, 25, 1, 0, 6))+
scale_color_manual(values = rev(PNWColors::pnw_palette("Bay", 3)))+
scale_fill_manual(values = rev(PNWColors::pnw_palette("Bay", 3)))+
ylim(-4,4)+
xlim(-4,4)+
theme_er1()+
guides(fill=guide_legend(override.aes=list(fill="black")))+
theme(legend.position = "NONE",
panel.border = element_rect(color="white",size=0.5, fill = NA))+
NULL
all_pca =
ggbiplot(pca, obs.scale = 1, var.scale = 1,
groups = as.character(grp$position),
alpha = 0,
ellipse = FALSE, circle = FALSE, var.axes = TRUE) +
geom_point(size=3,stroke=1, aes(fill = groups, color = groups, shape = interaction(grp$site, grp$depth)))+
labs(shape = "", fill = "", color = "",
caption = "solids = control")+
scale_shape_manual(values = c(21, 22, 25, 1, 0, 6))+
scale_color_manual(values = rev(PNWColors::pnw_palette("Bay", 3)))+
scale_fill_manual(values = rev(PNWColors::pnw_palette("Bay", 3)))+
ylim(-4,4)+
xlim(-4,4)+
theme_er1()+
guides(fill=guide_legend(override.aes=list(fill="black")))+
theme(legend.position = "bottom",
panel.border = element_rect(color="white",size=0.5, fill = NA))+
NULL
ggsave("output/all_pca.tiff", plot = all_pca, height = 4.5, width = 4.5)
combo_redox_threedepths_avg5 =
combo_redox_threedepths_avg %>%
filter(depth == "5")
num =
combo_redox_threedepths_avg5 %>%
dplyr::select(c(moisture, temp, salinity, redox_avg))
grp =
combo_redox_threedepths_avg5 %>%
dplyr::select(-c(moisture, temp, salinity, redox_avg),
site,position, depth, month) %>%
dplyr::mutate(row = row_number())
pca = prcomp(num, scale. = T)
all_pca =
ggbiplot(pca, obs.scale = 1, var.scale = 1,
groups = as.character(grp$position),
alpha = 0,
ellipse = FALSE, circle = FALSE, var.axes = TRUE) +
geom_point(size=3,stroke=1, aes(fill = groups, color = groups, shape = grp$site)))+
labs(shape = "", fill = "", color = "",
caption = "solids = control")+
scale_shape_manual(values = c(21, 22, 25, 1, 0, 6))+
scale_color_manual(values = rev(PNWColors::pnw_palette("Bay", 3)))+
scale_fill_manual(values = rev(PNWColors::pnw_palette("Bay", 3)))+
ylim(-4,4)+
xlim(-4,4)+
theme_er1()+
guides(fill=guide_legend(override.aes=list(fill="black")))+
theme(legend.position = "bottom",
panel.border = element_rect(color="white",size=0.5, fill = NA))+
NULL
all_pca =
ggbiplot(pca, obs.scale = 1, var.scale = 1,
groups = as.character(grp$position),
alpha = 0,
ellipse = FALSE, circle = FALSE, var.axes = TRUE) +
geom_point(size=3,stroke=1, aes(fill = groups, color = groups, shape = grp$site))+
labs(shape = "", fill = "", color = "",
caption = "solids = control")+
scale_shape_manual(values = c(21, 22, 25, 1, 0, 6))+
scale_color_manual(values = rev(PNWColors::pnw_palette("Bay", 3)))+
scale_fill_manual(values = rev(PNWColors::pnw_palette("Bay", 3)))+
ylim(-4,4)+
xlim(-4,4)+
theme_er1()+
guides(fill=guide_legend(override.aes=list(fill="black")))+
theme(legend.position = "bottom",
panel.border = element_rect(color="white",size=0.5, fill = NA))+
NULL
ggbiplot(pca, obs.scale = 1, var.scale = 1,
groups = as.character(grp$position),
alpha = 0,
ellipse = FALSE, circle = FALSE, var.axes = TRUE) +
geom_point(size=3,stroke=1, aes(fill = groups, color = groups, shape = grp$site))+
labs(shape = "", fill = "", color = "",
caption = "solids = control")+
scale_shape_manual(values = c(21, 22, 25, 1, 0, 6))+
scale_color_manual(values = rev(PNWColors::pnw_palette("Bay", 3)))+
scale_fill_manual(values = rev(PNWColors::pnw_palette("Bay", 3)))+
ylim(-4,4)+
xlim(-4,4)+
theme_er1()+
guides(fill=guide_legend(override.aes=list(fill="black")))+
theme(legend.position = "bottom",
panel.border = element_rect(color="white",size=0.5, fill = NA))+
NULL
View(combo_redox_threedepths_avg)
