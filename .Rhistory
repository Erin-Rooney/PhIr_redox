filter(type != 'redox') %>%
pivot_wider(names_from = "type", values_from = "avg_values") %>%
dplyr::select(-c(redox_NUM_Avg, X)) %>%
filter(RECORD != c(0)) %>%
force()
eastmesic_moisture_moisture_std =
moisture_separate_std(eastmesic_moisture_dlname) %>%
left_join(eastmesic_moisture_metadata, by = 'redox_NUM_Std') %>%
#filter(redox_NUM_Std > 2304) %>%
dplyr::select(-redox_NUM_Avg) %>%
pivot_longer(-c("redox_NUM_Std", "X", "TIMESTAMP", "RECORD", "site", "position", "Betterdate"),
names_to = c("type", "depth"), names_sep= "_", values_to = 'std_values') %>%
filter(type != 'redox') %>%
pivot_wider(names_from = "type", values_from = "std_values") %>%
# group_by(RECORD, TIMESTAMP, depth) %>%
# dplyr::mutate(n = n()) %>%
# ungroup() %>%
dplyr::select(-c(redox_NUM_Std, X)) %>%
mutate(moisture = as.numeric(moisture),
temp = as.numeric(temp),
salinity = as.numeric(salinity)) %>%
force()
eastmesic_dlname = read.csv("processed/eastmesic_dlname2022.csv")
westdry_dlname = read.csv("processed/westdry_dlname2022.csv")
eastdry_dlname = read.csv("processed/eastdry_dlname2022.csv")
westmesic_metadata = read.csv("processed/westmesic_metadata2022.csv")
eastmesic_metadata = read.csv("processed/eastmesic_metadata2022.csv")
westdry_metadata = read.csv("processed/westdry_metadata2022.csv")
eastdry_metadata = read.csv("processed/eastdry_metadata2022.csv")
eastmesic_moisture_std =
moisture_separate_std(eastmesic_moisture_dlname) %>%
left_join(eastmesic_moisture_metadata, by = 'redox_NUM_Std') %>%
#filter(redox_NUM_Std > 2304) %>%
dplyr::select(-redox_NUM_Avg) %>%
pivot_longer(-c("redox_NUM_Std", "X", "TIMESTAMP", "RECORD", "site", "position", "Betterdate"),
names_to = c("type", "depth"), names_sep= "_", values_to = 'std_values') %>%
filter(type != 'redox') %>%
pivot_wider(names_from = "type", values_from = "std_values") %>%
# group_by(RECORD, TIMESTAMP, depth) %>%
# dplyr::mutate(n = n()) %>%
# ungroup() %>%
dplyr::select(-c(redox_NUM_Std, X)) %>%
mutate(moisture = as.numeric(moisture),
temp = as.numeric(temp),
salinity = as.numeric(salinity)) %>%
force()
eastmesic_moisture_std =
moisture_separate_std(eastmesic_dlname) %>%
left_join(eastmesic_moisture_metadata, by = 'redox_NUM_Std') %>%
#filter(redox_NUM_Std > 2304) %>%
dplyr::select(-redox_NUM_Avg) %>%
pivot_longer(-c("redox_NUM_Std", "X", "TIMESTAMP", "RECORD", "site", "position", "Betterdate"),
names_to = c("type", "depth"), names_sep= "_", values_to = 'std_values') %>%
filter(type != 'redox') %>%
pivot_wider(names_from = "type", values_from = "std_values") %>%
# group_by(RECORD, TIMESTAMP, depth) %>%
# dplyr::mutate(n = n()) %>%
# ungroup() %>%
dplyr::select(-c(redox_NUM_Std, X)) %>%
mutate(moisture = as.numeric(moisture),
temp = as.numeric(temp),
salinity = as.numeric(salinity)) %>%
force()
eastmesic_moisture_std =
moisture_separate_std(eastmesic_dlname) %>%
left_join(eastmesic_metadata, by = 'redox_NUM_Std') %>%
#filter(redox_NUM_Std > 2304) %>%
dplyr::select(-redox_NUM_Avg) %>%
pivot_longer(-c("redox_NUM_Std", "X", "TIMESTAMP", "RECORD", "site", "position", "Betterdate"),
names_to = c("type", "depth"), names_sep= "_", values_to = 'std_values') %>%
filter(type != 'redox') %>%
pivot_wider(names_from = "type", values_from = "std_values") %>%
# group_by(RECORD, TIMESTAMP, depth) %>%
# dplyr::mutate(n = n()) %>%
# ungroup() %>%
dplyr::select(-c(redox_NUM_Std, X)) %>%
mutate(moisture = as.numeric(moisture),
temp = as.numeric(temp),
salinity = as.numeric(salinity)) %>%
force()
View(eastmesic_moisture_std)
eastmesic_moisture =
moisture_separate(eastmesic_dlname) %>%
dplyr::select(-soiltemperature_Avg) %>%
left_join(eastmesic_metadata, by = 'redox_NUM_Avg') %>%
pivot_longer(-c("redox_NUM_Avg", "X", "TIMESTAMP", "RECORD", "site", "position", "Betterdate"),
names_to = c("type", "depth"), names_sep= "_", values_to = 'avg_values') %>%
filter(type != 'redox') %>%
pivot_wider(names_from = "type", values_from = "avg_values")%>%
dplyr::select(-c(redox_NUM_Avg, X)) %>%
filter(RECORD != c(1628, 766)) %>%
force()
eastdry_moisture_std =
moisture_separate_std(eastdry_dlname) %>%
left_join(eastdry_metadata, by = 'redox_NUM_Std') %>%
#filter(redox_NUM_Std > 2304) %>%
dplyr::select(-redox_NUM_Avg) %>%
pivot_longer(-c("redox_NUM_Std", "X", "TIMESTAMP", "RECORD", "site", "position", "Betterdate"),
names_to = c("type", "depth"), names_sep= "_", values_to = 'std_values') %>%
filter(type != 'redox') %>%
pivot_wider(names_from = "type", values_from = "std_values") %>%
# group_by(RECORD, TIMESTAMP, depth) %>%
# dplyr::mutate(n = n()) %>%
# ungroup() %>%
dplyr::select(-c(redox_NUM_Std, X)) %>%
mutate(moisture = as.numeric(moisture),
temp = as.numeric(temp),
salinity = as.numeric(salinity)) %>%
force()
View(westdry_moisture_std)
View(eastdry_moisture_std)
eastdry_moisture =
moisture_separate(eastdry_dlname) %>%
dplyr::select(-soiltemperature_Avg) %>%
left_join(eastdry_metadata, by = 'redox_NUM_Avg') %>%
pivot_longer(-c("redox_NUM_Avg", "X", "TIMESTAMP", "RECORD", "site", "position", "Betterdate"),
names_to = c("type", "depth"), names_sep= "_", values_to = 'avg_values') %>%
filter(type != 'redox') %>%
pivot_wider(names_from = "type", values_from = "avg_values")%>%
dplyr::select(-c(redox_NUM_Avg, X)) %>%
filter(RECORD != c(7019)) %>%
force()
moisture_combine =
westhydric_moisture %>%
bind_rows(easthydric_moisture, westmesic_moisture, eastmesic_moisture, westdry_moisture, eastdry_moisture) %>%
dplyr::select(-c(redox_NUM_Std)) %>%
na.omit() %>%
group_by(site, position, TIMESTAMP, depth) %>%
dplyr::mutate(n = n()) %>%
ungroup() %>%
force()
#
#write.csv(moisture_combine, "processed/moisture_temp_salinity_avgs_combine.csv")
#
#write.csv(moisture_combine, "processed/2022moisture_temp_salinity_avgs_combine.csv")
write.csv(moisture_combine, "processed/2022final_temp_salinity_avgs.csv")
final_temp_sal_moist2022 = read.csv("processed/2022final_temp_salinity_avgs.csv")
final_temp_sal_moist_forfig2022 =
final_temp_sal_moist2022 %>%
mutate(forsep = TIMESTAMP) %>%
separate(TIMESTAMP, sep = " ", into = c("date2", "time")) %>%
separate(date2, sep = "/", into =c('month', 'day', 'year')) %>%
mutate(date = as.Date(paste(year, month, day, sep = "-"))) %>%
mutate(datetime = ymd_hm(paste(date, time)),
date = ymd(date)) %>%
separate(forsep, sep = " ", into = c("date", "time")) %>%
separate(date, sep = "/", into = c("month", "day", "year")) %>%
mutate(month = recode(month,  "6" = "early summer",
"7" = "mid summer",
"8" = "late summer",
"9" = "early fall")) %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
dplyr::rename(depth_cm = depth) %>%
na.omit() %>%
mutate(frozen = case_when(temp < -1 ~ "frozen", TRUE ~ "unfrozen"))
grouped_moisture_forfigs_temporal2022 =
final_temp_sal_moist_forfig2022 %>%
filter(moisture > 1) %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
group_by(site, position, depth_cm, month) %>%
dplyr::summarise(moisture_avg = round(mean(moisture),2),
moisture_sd = round(sd(moisture),2),
moisture_se = round(sd(moisture)/sqrt(n()),2))
moisturefig_temporal2022 =
grouped_moisture_forfigs_temporal2022 %>%
mutate(month = factor(month, levels = c("early summer", "mid summer", "late summer", "early fall")))   %>%
mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
ggplot(aes(y = depth_cm, x = moisture_avg, color = month, fill = month), group = 'month')+
geom_point(size = 4, alpha = 0.8, shape = c(21))+
geom_line(orientation = "y", show.legend = FALSE, linetype = "longdash")+
geom_errorbar(aes(xmin=moisture_avg-moisture_sd, xmax=moisture_avg+moisture_sd), show.legend = FALSE)+
scale_color_manual(values = (pnw_palette('Sunset', 4)))+
scale_fill_manual(values = (pnw_palette('Sunset', 4)))+
ylim(60, 0)+
labs(x = '2022
soil moisture (%)',
y = "depth (cm)",
color = "", fill = "")+
scale_x_continuous(position="top")+
facet_grid(position~site, switch = "x")+
theme_er1()+
theme(legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
strip.text.y = element_blank(),
axis.text.x = element_text(size = 7.5, hjust=0.8,vjust=0.2,angle = 90))  #remove y axis ticks
grouped_moisture_forfigs_temporal2022 %>%
mutate(month = factor(month, levels = c("early summer", "mid summer", "late summer", "early fall")))   %>%
mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
ggplot(aes(y = depth_cm, x = moisture_avg, color = month, fill = month), group = 'month')+
geom_point(size = 4, alpha = 0.8, shape = c(21))+
geom_line(orientation = "y", show.legend = FALSE, linetype = "longdash")+
geom_errorbar(aes(xmin=moisture_avg-moisture_sd, xmax=moisture_avg+moisture_sd), show.legend = FALSE)+
scale_color_manual(values = (pnw_palette('Sunset', 4)))+
scale_fill_manual(values = (pnw_palette('Sunset', 4)))+
ylim(60, 0)+
labs(x = '2022
soil moisture (%)',
y = "depth (cm)",
color = "", fill = "")+
scale_x_continuous(position="top")+
facet_grid(position~site, switch = "x")+
theme_er1()+
theme(legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
strip.text.y = element_blank(),
axis.text.x = element_text(size = 7.5, hjust=0.8,vjust=0.2,angle = 90))  #remove y axis ticks
grouped_moisture_forfigs_temporal2022 %>%
filter(moisture_avg > 0) %>%
mutate(month = factor(month, levels = c("early summer", "mid summer", "late summer", "early fall")))   %>%
mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
ggplot(aes(y = depth_cm, x = moisture_avg, color = month, fill = month), group = 'month')+
geom_point(size = 4, alpha = 0.8, shape = c(21))+
geom_line(orientation = "y", show.legend = FALSE, linetype = "longdash")+
geom_errorbar(aes(xmin=moisture_avg-moisture_sd, xmax=moisture_avg+moisture_sd), show.legend = FALSE)+
scale_color_manual(values = (pnw_palette('Sunset', 4)))+
scale_fill_manual(values = (pnw_palette('Sunset', 4)))+
ylim(60, 0)+
labs(x = '2022
soil moisture (%)',
y = "depth (cm)",
color = "", fill = "")+
scale_x_continuous(position="top")+
facet_grid(position~site, switch = "x")+
theme_er1()+
theme(legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
strip.text.y = element_blank(),
axis.text.x = element_text(size = 7.5, hjust=0.8,vjust=0.2,angle = 90))  #remove y axis ticks
grouped_moisture_forfigs_temporal2022 %>%
filter(moisture_avg > 1) %>%
mutate(month = factor(month, levels = c("early summer", "mid summer", "late summer", "early fall")))   %>%
mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
ggplot(aes(y = depth_cm, x = moisture_avg, color = month, fill = month), group = 'month')+
geom_point(size = 4, alpha = 0.8, shape = c(21))+
geom_line(orientation = "y", show.legend = FALSE, linetype = "longdash")+
geom_errorbar(aes(xmin=moisture_avg-moisture_sd, xmax=moisture_avg+moisture_sd), show.legend = FALSE)+
scale_color_manual(values = (pnw_palette('Sunset', 4)))+
scale_fill_manual(values = (pnw_palette('Sunset', 4)))+
ylim(60, 0)+
labs(x = '2022
soil moisture (%)',
y = "depth (cm)",
color = "", fill = "")+
scale_x_continuous(position="top")+
facet_grid(position~site, switch = "x")+
theme_er1()+
theme(legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
strip.text.y = element_blank(),
axis.text.x = element_text(size = 7.5, hjust=0.8,vjust=0.2,angle = 90))  #remove y axis ticks
grouped_moisture_forfigs_temporal2022 %>%
filter(moisture_avg > 5) %>%
mutate(month = factor(month, levels = c("early summer", "mid summer", "late summer", "early fall")))   %>%
mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
ggplot(aes(y = depth_cm, x = moisture_avg, color = month, fill = month), group = 'month')+
geom_point(size = 4, alpha = 0.8, shape = c(21))+
geom_line(orientation = "y", show.legend = FALSE, linetype = "longdash")+
geom_errorbar(aes(xmin=moisture_avg-moisture_sd, xmax=moisture_avg+moisture_sd), show.legend = FALSE)+
scale_color_manual(values = (pnw_palette('Sunset', 4)))+
scale_fill_manual(values = (pnw_palette('Sunset', 4)))+
ylim(60, 0)+
labs(x = '2022
soil moisture (%)',
y = "depth (cm)",
color = "", fill = "")+
scale_x_continuous(position="top")+
facet_grid(position~site, switch = "x")+
theme_er1()+
theme(legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
strip.text.y = element_blank(),
axis.text.x = element_text(size = 7.5, hjust=0.8,vjust=0.2,angle = 90))  #remove y axis ticks
moisturefig_temporal2022 =
grouped_moisture_forfigs_temporal2022 %>%
filter(moisture_avg > 5) %>%
mutate(month = factor(month, levels = c("early summer", "mid summer", "late summer", "early fall")))   %>%
mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
ggplot(aes(y = depth_cm, x = moisture_avg, color = month, fill = month), group = 'month')+
geom_point(size = 4, alpha = 0.8, shape = c(21))+
geom_line(orientation = "y", show.legend = FALSE, linetype = "longdash")+
geom_errorbar(aes(xmin=moisture_avg-moisture_sd, xmax=moisture_avg+moisture_sd), show.legend = FALSE)+
# scale_color_manual(values = (pnw_palette('Sunset', 4)))+
# scale_fill_manual(values = (pnw_palette('Sunset', 4)))+
scale_color_manual(values = rev(c("#f94144", "#f8961e", "#57cc99", "#4361ee")))+
scale_fill_manual(values = rev(c("#f94144", "#f8961e", "#57cc99", "#4361ee")))+
ylim(60, 0)+
labs(x = '2022
soil moisture (%)',
y = "depth (cm)",
color = "", fill = "")+
scale_x_continuous(position="top")+
facet_grid(position~site, switch = "x")+
theme_er1()+
theme(legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
strip.text.y = element_blank(),
axis.text.x = element_text(size = 7.5, hjust=0.8,vjust=0.2,angle = 90))  #remove y axis ticks
ggsave("formanuscript/moisture_temporal_fig_2022.png", plot = moisturefig_temporal2022, height = 7, width = 3.8)
source("code/0-packages.R")
raw_ICP = read.csv("raw/2023_LIME_ICPAES_002R_Herndon_0118.csv")
raw_ICP_diluted = read.csv("raw/2023_LIME_ICPAES_002R_Herndon_0118_diluted.csv")
combo_redox_withdepths2022 = read.csv("processed/allcombine_2022_frozen.csv")
processed_ICP_diluted =
raw_ICP_diluted %>%
mutate(Area = recode(Area, "West" = "non-acidic tundra",
"East" = "acidic tundra")) %>%
mutate(Area = factor(Area, levels = c("non-acidic tundra", "acidic tundra"))) %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
# dplyr::select(c(SampleID, Date, Time, Area, Site, Plot, Depth_cm, Al_ug_mL, Ca_ug_mL, Fe_ug_mL,
#                 K_ug_mL, Mg_ug_mL, Mn_ug_mL, Na_ug_mL, P_ug_mL)) %>%
mutate(P_ug_mL = recode(P_ug_mL, "<0.01" = "0.005",
"<0.1" = "0.05")) %>%  #this seems like an error...need to check
separate(Date, sep = "-", into =c('day', 'month', 'year')) %>%
mutate(month = recode(month, "Jun" = "06", "Jul" = "07", "Aug" = "08", "Sep" = "09")) %>%
mutate(year = recode(year, "22" = "2022")) %>%
mutate(date = as.Date(paste(year, month, day, sep = "-"))) %>%
mutate(Al_ug_mL = as.numeric(Al_ug_mL)) %>%
mutate(Ca_ug_mL = as.numeric(Ca_ug_mL)) %>%
mutate(K_ug_mL = as.numeric(K_ug_mL)) %>%
mutate(Mn_ug_mL = as.numeric(Mn_ug_mL)) %>%
mutate(Mg_ug_mL = as.numeric(Mg_ug_mL)) %>%
mutate(Na_ug_mL = as.numeric(Na_ug_mL)) %>%
mutate(P_ug_mL = as.numeric(P_ug_mL)) %>%
mutate(Fe_ug_mL = as.numeric(Fe_ug_mL)) %>%
pivot_longer(-c(SampleID, date, Time, Area, Site, Plot, day, month, year, Depth_cm), names_to = 'ICP', values_to = 'concentration') %>%
mutate(concentration = concentration * 10)
processed_ICP =
raw_ICP %>%
mutate(Area = recode(Area, "West" = "non-acidic tundra",
"East" = "acidic tundra")) %>%
mutate(Area = factor(Area, levels = c("non-acidic tundra", "acidic tundra"))) %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
na.omit() %>%
dplyr::select(c(SampleID, Date, Time, Area, Site, Plot, Depth_cm, Al_ug_mL, Ca_ug_mL, Fe_ug_mL,
K_ug_mL, Mg_ug_mL, Mn_ug_mL, Na_ug_mL, P_ug_mL)) %>%
na.omit() %>%
mutate(Al_ug_mL = recode(Al_ug_mL, "<0.01" = "0.005")) %>%
mutate(Mn_ug_mL = recode(Mn_ug_mL, "<0.005" = '0.003')) %>%
mutate(P_ug_mL = recode(P_ug_mL, "<0.01" = "0.005",
"<0.1" = "0.05")) %>%  #this seems like an error...need to check
separate(Date, sep = "-", into =c('day', 'month', 'year')) %>%
mutate(month = recode(month, "Jun" = "06", "Jul" = "07", "Aug" = "08", "Sep" = "09")) %>%
mutate(year = recode(year, "22" = "2022")) %>%
mutate(date = as.Date(paste(year, month, day, sep = "-"))) %>%
mutate(Al_ug_mL = as.numeric(Al_ug_mL)) %>%
mutate(Ca_ug_mL = as.numeric(Ca_ug_mL)) %>%
mutate(K_ug_mL = as.numeric(K_ug_mL)) %>%
mutate(Mn_ug_mL = as.numeric(Mn_ug_mL)) %>%
mutate(Mg_ug_mL = as.numeric(Mg_ug_mL)) %>%
mutate(Na_ug_mL = as.numeric(Na_ug_mL)) %>%
mutate(P_ug_mL = as.numeric(P_ug_mL)) %>%
mutate(Fe_ug_mL = as.numeric(Fe_ug_mL)) %>%
pivot_longer(-c(SampleID, date, Time, Area, Site, Plot, day, month, year, Depth_cm), names_to = 'ICP', values_to = 'concentration') %>%
vctrs::vec_c(processed_ICP_diluted) %>%
mutate(month = recode(month, "06" = "June", "07" = "July", "08" = "August", "09" = "September"))
processed_ICP_wider =
processed_ICP %>%
pivot_wider(names_from = "ICP", values_from = "concentration")
processed_ICP_grouped =
processed_ICP %>%
pivot_wider(names_from = "ICP", values_from = "concentration") %>%
group_by(Area, Site, Depth_cm, date) %>%
dplyr::summarise(mean_Al_ug_mL = round(mean(Al_ug_mL),3),
mean_Ca_ug_mL = round(mean(Ca_ug_mL),3),
mean_K_ug_mL = round(mean(K_ug_mL),3),
mean_Mn_ug_mL = round(mean(Mn_ug_mL),3),
mean_Mg_ug_mL = round(mean(Mg_ug_mL),3),
mean_Na_ug_mL = round(mean(Na_ug_mL),3),
mean_P_ug_mL = round(mean(P_ug_mL),3),
mean_Fe_ug_mL = round(mean(Fe_ug_mL),3),
sd_Al_ug_mL = round(sd(Al_ug_mL),3),
sd_Ca_ug_mL = round(sd(Ca_ug_mL),3),
sd_K_ug_mL = round(sd(K_ug_mL),3),
sd_Mn_ug_mL = round(sd(Mn_ug_mL),3),
sd_Mg_ug_mL = round(sd(Mg_ug_mL),3),
sd_Na_ug_mL = round(sd(Na_ug_mL),3),
sd_P_ug_mL = round(sd(P_ug_mL),3),
sd_Fe_ug_mL = round(sd(Fe_ug_mL),3)
) %>%
separate(date, sep = "-", into =c('year', 'month', 'day')) %>%
mutate(month2 = recode(month, "06" = "June", "07" = "July", "08" = "August", "09" = "September")) %>%
mutate(date_plot = paste(month2, day, year, sep = "-")) %>%
mutate(date_plot = factor(date_plot, levels = c("June-27-2022", "June-29-2022", "July-06-2022",
"July-07-2022", "July-11-2022", "July-12-2022",
"July-18-2022", "July-19-2022", "July-25-2022",
"July-26-2022", "August-07-2022", "August-08-2022",
"September-15-2022","September-17-2022", "September-23-2022"))) %>%
mutate(area_site = paste(Area, Site, sep = "-"))
P_concentration_fig =
processed_ICP %>%
mutate(grouping = paste0(Area, "-", Site, "-", date, "-", Plot)) %>%
mutate(month = factor(month, levels = c("June", "July", "August", "September"))) %>%
filter(ICP == "P_ug_mL") %>%
ggplot() +
geom_point(aes(x = concentration, y = Depth_cm, color = month), size = 2, alpha = 0.75)+
geom_line(aes(x = concentration, y = Depth_cm, color = month, group = grouping), orientation = "y", size = 1, linetype = "dotted")+
labs(x = "Phosphorus concentration, μg/ml",
y = "depth, cm",
color = "month, 2022"
)+
scale_color_manual(values = rev(c("#f94144", "#f8961e", "#57cc99", "#4361ee")))+
# scale_color_manual(values = c("#f07167", "#a7c957", "#1e96fc", "#f07167", "#a7c957", "#1e96fc"))+
scale_y_reverse()+
facet_grid(Site~Area, scales = "free_x")+
theme_er1()+
theme(legend.position = "right",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
axis.text.y=element_blank(),  #remove y axis labels
axis.ticks.y=element_blank(),
axis.text.x = element_text(size = 7.5, hjust=0.8,vjust=0.2,angle = 90))
ggsave("output/P_concentration_fig.png", plot = P_concentration_fig, height = 5.5, width = 6.5)
Fe_concentration_fig =
processed_ICP %>%
mutate(grouping = paste0(Area, "-", Site, "-", date, "-", Plot)) %>%
mutate(month = factor(month, levels = c("June", "July", "August", "September"))) %>%
# filter(Area == "acidic tundra" & Site == "Hydric" & ICP == "P_ug_mL") %>%
filter(ICP == "Fe_ug_mL") %>%
ggplot() +
geom_point(aes(x = concentration, y = Depth_cm, color = month), size = 2, alpha = 0.75)+
geom_line(aes(x = concentration, y = Depth_cm, color = month, group = grouping), orientation = "y", size = 1, linetype = "dotted")+
labs(x = "Iron concentration, μg/ml",
y = "depth, cm",
color = "month, 2022"
)+
scale_color_manual(values = rev(c("#f94144", "#f8961e", "#57cc99", "#4361ee")))+
# scale_color_manual(values = c("#f07167", "#a7c957", "#1e96fc", "#f07167", "#a7c957", "#1e96fc"))+
scale_y_reverse()+
facet_grid(Site~Area, scales = "free_x")+
theme_er1()+
theme(legend.position = "right",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
axis.text.y=element_blank(),  #remove y axis labels
axis.ticks.y=element_blank(),
axis.text.x = element_text(size = 7.5, hjust=0.8,vjust=0.2,angle = 90))
ggsave("output/Fe_concentration_fig.png", plot = Fe_concentration_fig, height = 5.5, width = 6.5)
Mn_concentration_fig =
processed_ICP %>%
mutate(grouping = paste0(Area, "-", Site, "-", date, "-", Plot)) %>%
mutate(month = factor(month, levels = c("June", "July", "August", "September"))) %>%
# filter(Area == "acidic tundra" & Site == "Hydric" & ICP == "P_ug_mL") %>%
filter(ICP == "Mn_ug_mL") %>%
ggplot() +
geom_point(aes(x = concentration, y = Depth_cm, color = month), size = 2, alpha = 0.75)+
geom_line(aes(x = concentration, y = Depth_cm, color = month, group = grouping), orientation = "y", size = 1, linetype = "dotted")+
labs(x = "Manganese concentration, μg/ml",
y = "depth, cm",
color = "month, 2022"
)+
scale_color_manual(values = rev(c("#f94144", "#f8961e", "#57cc99", "#4361ee")))+
scale_y_reverse()+
facet_grid(Site~Area, scales = "free_x")+
theme_er1()+
theme(legend.position = "right",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
axis.text.y=element_blank(),  #remove y axis labels
axis.ticks.y=element_blank(),
axis.text.x = element_text(size = 7.5, hjust=0.8,vjust=0.2,angle = 90))
ggsave("output/Mn_concentration_fig.png", plot = Mn_concentration_fig, height = 5.5, width = 6.5)
Ca_concentration_fig =
processed_ICP %>%
mutate(grouping = paste0(Area, "-", Site, "-", date, "-", Plot)) %>%
mutate(month = factor(month, levels = c("June", "July", "August", "September"))) %>%
# filter(Area == "acidic tundra" & Site == "Hydric" & ICP == "P_ug_mL") %>%
filter(ICP == "Ca_ug_mL") %>%
ggplot() +
geom_point(aes(x = concentration, y = Depth_cm, color = month), size = 2, alpha = 0.75)+
geom_line(aes(x = concentration, y = Depth_cm, color = month, group = grouping), orientation = "y", size = 1, linetype = "dotted")+
labs(x = "Calcium concentration, μg/ml",
y = "depth, cm",
color = "month, 2022"
)+
scale_color_manual(values = rev(c("#f94144", "#f8961e", "#57cc99", "#4361ee")))+
scale_y_reverse()+
facet_grid(Site~Area, scales = "free_x")+
theme_er1()+
theme(legend.position = "right",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
axis.text.y=element_blank(),  #remove y axis labels
axis.ticks.y=element_blank(),
axis.text.x = element_text(size = 7.5, hjust=0.8,vjust=0.2,angle = 90))
ggsave("output/Ca_concentration_fig.png", plot = Ca_concentration_fig, height = 5.5, width = 6.5)
library(patchwork)
nutrientsfig1 = Ca_concentration_fig + Mn_concentration_fig
nutrientsfig2 = P_concentration_fig + Fe_concentration_fig
nutrient_plot = nutrientsfig1 / nutrientsfig2 + plot_layout(guides = "collect")
# ggsave("output/2022nutrientsfigA.png", plot = nutrientsfigA, height = 9, width = 11)
# ggsave("output/2022nutrientsfigB.png", plot = nutrientsfigB, height = 10, width = 8)
ggsave("output/2022nutrient_plot.png", plot = nutrient_plot, height = 12, width = 9.5)
