write.csv(rhizon_meta_combine_notransect, "processed/rhizon_long_notransect.csv")
East_rhizon_notransect_2021 =
rhizon_meta_combine_notransect %>%
filter(Area == 'East') %>%
ggplot(aes(x = Betterdate, y = as.numeric(concentration), color = Site, shape = Area))+
geom_point(size = 2.5, alpha = 0.8)+
#geom_line(orientation = "x", group = 'Plot')+
labs(x = "Date",
y = 'concentration ug/mL')+
scale_color_manual(values = rev(PNWColors::pnw_palette("Bay", 3)))+
facet_wrap(ICP~., scales = "free")+
theme_er1()
rhizon_meta_combine_notransect_forelements =
rhizon_meta_combine_notransect %>%
group_by(Area, Site, month, Betterdate, ICP) %>%
dplyr::summarise(mean = mean(concentration),
n = n(),
sd = sd(concentration)/sqrt(n)) %>%
na.omit() %>%
mutate(combo = paste(Area, "-", Site)) %>%
mutate(Area = as.factor(Area)) %>%
mutate(month = factor(month, levels = c("june", "july", "august")),
Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
na.omit()
east_rhizon_fig =
rhizon_meta_combine_notransect_forelements %>%
filter(ICP %in% c("iron", "phosphorus", "manganese") & Area == "East") %>%
mutate(ICP = recode(ICP, "phosphorus" = "phosphorus μg/mL",
"iron" = "iron μg/mL",
"manganese" = "manganese μg/mL")) %>%
ggplot(aes(x = Betterdate, y = mean, color = Site, fill = Site)) +
#geom_point(size = 3, alpha = 0.7)+
geom_col(position = 'dodge', width = 0.7, alpha = 0.5)+
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
position=position_dodge(.9), color = "black")+
labs(x = "date", y = "",
subtitle = "Acidic Tundra")+
#scale_x_date(date_labels = "%b-%d")+
scale_color_manual(values = c("#9a031e", "#40916c", "#118ab2"))+
scale_fill_manual(values = c("#9a031e", "#40916c", "#118ab2"))+
# scale_color_manual(values = rev(natparks.pals(name = "Banff", 3.5)))+
# scale_fill_manual(values = rev(natparks.pals(name = "Banff", 3.5)))+
theme_er1()+
# theme(axis.text.x = element_text (size = 10 , vjust = 0.5, hjust=1, angle = 90))+
facet_grid(ICP ~ Site, switch = "y", scale = "free_y")+
theme(legend.position = "NONE", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
strip.placement = "outside")+
NULL
west_rhizon_fig =
rhizon_meta_combine_notransect_forelements %>%
filter(ICP %in% c("iron", "phosphorus", "manganese") & Area == "West") %>%
mutate(ICP = recode(ICP, "phosphorus" = "phosphorus μg/mL",
"iron" = "iron μg/mL",
"manganese" = "manganese μg/mL")) %>%
ggplot(aes(x = Betterdate, y = mean, color = Site, fill = Site)) +
#geom_point(size = 3, alpha = 0.7)+
geom_col(position = 'dodge', width = 0.7, alpha = 0.5)+
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2,
position=position_dodge(.9), color = "black")+
labs(x = "date", y = "",
subtitle = "Non-Acidic Tundra")+
scale_color_manual(values = c("#9a031e", "#40916c", "#118ab2"))+
scale_fill_manual(values = c("#9a031e", "#40916c", "#118ab2"))+
# scale_color_manual(values = rev(natparks.pals(name = "Banff", 3.5)))+
# scale_fill_manual(values = rev(natparks.pals(name = "Banff", 3.5)))+
theme_er1()+
# theme(axis.text.x = element_text (size = 10 , vjust = 0.5, hjust=1, angle = 90))+
facet_grid(ICP ~ Site, switch = "y", scale = "free_y")+
theme(legend.position = "NONE", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
strip.placement = "outside")+
NULL
ggsave("figures_finalized/west_rhizon_fig.png", plot = west_rhizon_fig, width = 7, height = 9)
ggsave("figures_finalized/east_rhizon_fig.png", plot = east_rhizon_fig, width = 7, height = 9)
source("code/0-packages.R")
thaw_depths = read.csv("raw/thaw_depth_2021.csv")
bd_grav_cleaned = read.csv("raw/PhIr2021_Soil_Inventory_bd.csv") %>%
#dplyr::select(-c(X)) %>%
mutate(Area = recode(Area, "East" = "acidic tundra",
"West" = "non-acidic tundra")) %>%
dplyr::mutate(soil_material = case_when(grepl("O",Horizon)~"organic",
grepl("M",Horizon)~"mineral")) %>%
mutate(volumetric_water_content_cm3_cm3 = soil_bulk_density_g_cm3 * grav_water_gh20_per_gdrysoil)
bd_select =
bd_grav_cleaned %>%
dplyr::select(Sample_ID, Core_ID, Date_collected, Area, Site, Plot_num, Plot_ID,
Horizon, Depth_1_cm, Depth_2_cm, Depth_3_cm, Depth_4_cm, Average_Depth_cm, real_depth_cm,
soil_bulk_density_g_cm3, volumetric_water_content_cm3_cm3, soil_material)
horizons_acidic =
bd_select %>%
filter(Site != "Transect" & Area == "acidic tundra") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth, cm",
x = "plot")+
scale_fill_manual(values = c("#D6AB7D", "#B3895D", "#B3895D", "#734F38", "#553725", "#482919", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right")+
facet_grid(Area~Site, scales="free")
horizons_nonacidic =
bd_select %>%
filter(Site != "Transect" & Area == "non-acidic tundra") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth, cm",
x = "plot")+
scale_fill_manual(values = c("#B3895D", "#553725", "#482919", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right")+
facet_grid(Area~Site, scales="free")
bd_select =
bd_grav_cleaned %>%
dplyr::select(Sample_ID, Core_ID, Date_collected, Area, Site, Plot_num, Plot_ID,
Horizon, Depth_1_cm, Depth_2_cm, Depth_3_cm, Depth_4_cm, Average_Depth_cm, real_depth_cm,
soil_bulk_density_g_cm3, volumetric_water_content_cm3_cm3, soil_material) %>%
mutate(label = Horizon)
horizons_acidic =
bd_select %>%
filter(Site != "Transect" & Area == "acidic tundra") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(fill = "label", color = "label",
y = "depth, cm",
x = "plot")+
scale_fill_manual(values = c("#D6AB7D", "#B3895D", "#B3895D", "#734F38", "#553725", "#482919", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right")+
facet_grid(Area~Site, scales="free")
bd_select %>%
filter(Site != "Transect" & Area == "acidic tundra") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(fill = "label", color = "label",
y = "depth, cm",
x = "plot")+
scale_fill_manual(values = c("#D6AB7D", "#B3895D", "#B3895D", "#734F38", "#553725", "#482919", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right")+
facet_grid(Area~Site, scales="free")
bd_select =
bd_grav_cleaned %>%
dplyr::select(Sample_ID, Core_ID, Date_collected, Area, Site, Plot_num, Plot_ID,
Horizon, Depth_1_cm, Depth_2_cm, Depth_3_cm, Depth_4_cm, Average_Depth_cm, real_depth_cm,
soil_bulk_density_g_cm3, volumetric_water_content_cm3_cm3, soil_material) %>%
mutate(label = Horizon) %>%
mutate(label = factor(label, levels = c("O", "O1", "O2", "O3", "M", "M1", "M2"))) %>%
horizons_acidic =
bd_select %>%
filter(Site != "Transect" & Area == "acidic tundra") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(fill = "label", color = "label",
y = "depth, cm",
x = "plot")+
scale_fill_manual(values = c("#D6AB7D", "#B3895D", "#B3895D", "#734F38", "#553725", "#482919", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right")+
facet_grid(Area~Site, scales="free")
bd_select =
bd_grav_cleaned %>%
dplyr::select(Sample_ID, Core_ID, Date_collected, Area, Site, Plot_num, Plot_ID,
Horizon, Depth_1_cm, Depth_2_cm, Depth_3_cm, Depth_4_cm, Average_Depth_cm, real_depth_cm,
soil_bulk_density_g_cm3, volumetric_water_content_cm3_cm3, soil_material) %>%
mutate(label = Horizon) %>%
mutate(label = factor(label, levels = c("O", "O1", "O2", "O3", "M", "M1", "M2")))
bd_select %>%
filter(Site != "Transect" & Area == "acidic tundra") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(fill = "label", color = "label",
y = "depth, cm",
x = "plot")+
scale_fill_manual(values = c("#D6AB7D", "#B3895D", "#B3895D", "#734F38", "#553725", "#482919", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right")+
facet_grid(Area~Site, scales="free")
horizons_acidic =
bd_select %>%
filter(Site != "Transect" & Area == "acidic tundra") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth, cm",
x = "plot")+
scale_fill_manual(values = c("#D6AB7D", "#B3895D", "#B3895D", "#734F38", "#553725", "#482919", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right")+
facet_grid(Area~Site, scales="free") +
guides(fill = guide_legend(reverse = TRUE))
bd_select %>%
filter(Site != "Transect" & Area == "acidic tundra") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth, cm",
x = "plot")+
scale_fill_manual(values = c("#D6AB7D", "#B3895D", "#B3895D", "#734F38", "#553725", "#482919", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right")+
facet_grid(Area~Site, scales="free") +
guides(fill = guide_legend(reverse = TRUE))
horizons_acidic =
bd_select %>%
filter(Site != "Transect" & Area == "acidic tundra") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth, cm",
x = "plot")+
scale_fill_manual(values = c("#D6AB7D", "#B3895D", "#B3895D", "#734F38", "#553725", "#482919", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right")+
facet_grid(Area~Site, scales="free") +
guides(fill = guide_legend(reverse = TRUE))
horizons_nonacidic =
bd_select %>%
filter(Site != "Transect" & Area == "non-acidic tundra") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth, cm",
x = "plot")+
scale_fill_manual(values = c("#B3895D", "#553725", "#482919", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right")+
facet_grid(Area~Site, scales="free")
horizons_nonacidic =
bd_select %>%
filter(Site != "Transect" & Area == "non-acidic tundra") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth, cm",
x = "plot")+
scale_fill_manual(values = c("#B3895D", "#553725", "#482919", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right")+
facet_grid(Area~Site, scales="free") +
guides(fill = guide_legend(reverse = TRUE))
ggsave("output/horizons_nonacidic.png", plot = horizons_nonacidic, height = 4.5, width = 9.5)
ggsave("output/horizons_acidic.png", plot = horizons_acidic, height = 4.5, width = 9.5)
bd_select %>%
filter(Site != "Transect" & Area == "non-acidic tundra") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_line(aes(y = real_depth_cm, x = soil_bulk_density_g_cm3, group = Core_ID))+
geom_point(aes(y = real_depth_cm, x = soil_bulk_density_g_cm3, color = Horizon, group = Core_ID), size = 3)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth, cm",
x = "bulk density")+
scale_color_manual(values = c("#B3895D", "#553725", "#482919", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right")+
facet_grid(Area~Site)
bd_grouped %>%
filter(Site != "Transect") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(horizon_simplified = factor(horizon_simplified, levels = c("Mineral Subsurface", "Organic Subsurface", "Organic Surface"))) %>%
ggplot()+
#geom_line(aes(y = mean_depth, x = soil_bulk_density_g_cm3, group = Core_ID))+
geom_point(aes(y = mean_depth, x = mean_bd, color = horizon_simplified, group = Core_ID), size = 3)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth, cm",
x = "bulk density (g/cm3)")+
scale_color_manual(values = c("#D6AB7D", "#8A5A44", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "bottom")+
facet_grid(Area~Site)
bd_grouped =
bd_select %>%
mutate(horizon_simplified = recode(Horizon, "O" = "Organic Surface", "O1" = "Organic Surface",
"O2" = "Organic Subsurface", "O3" = "Organic Subsurface", "M" = "Mineral Subsurface",
"M1" = "Mineral Subsurface", "M2" = "Mineral Subsurface")) %>%
group_by(Area, Site, Plot_num, Core_ID, horizon_simplified) %>%
dplyr::summarise(mean_bd = mean(soil_bulk_density_g_cm3),
mean_vwc = mean(volumetric_water_content_cm3_cm3),
mean_depth = mean(real_depth_cm)) %>%
na.omit()
bd_grouped %>%
filter(Site != "Transect") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(horizon_simplified = factor(horizon_simplified, levels = c("Mineral Subsurface", "Organic Subsurface", "Organic Surface"))) %>%
ggplot()+
#geom_line(aes(y = mean_depth, x = soil_bulk_density_g_cm3, group = Core_ID))+
geom_point(aes(y = mean_depth, x = mean_bd, color = horizon_simplified, group = Core_ID), size = 3)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth, cm",
x = "bulk density (g/cm3)")+
scale_color_manual(values = c("#D6AB7D", "#8A5A44", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "bottom")+
facet_grid(Area~Site)
bd_grouped %>%
filter(Site != "Transect") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(horizon_simplified = factor(horizon_simplified, levels = c("Mineral Subsurface", "Organic Subsurface", "Organic Surface"))) %>%
ggplot()+
#geom_line(aes(y = mean_depth, x = soil_bulk_density_g_cm3, group = Core_ID))+
geom_point(aes(y = mean_depth, x = mean_bd, color = horizon_simplified, group = Core_ID), size = 3)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth, cm",
x = "bulk density (g/cm3)")+
scale_color_manual(values = c("#D6AB7D", "#8A5A44", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "bottom")+
facet_grid(Area~Site) +
guides(fill = guide_legend(reverse = TRUE))
bd_grouped %>%
filter(Site != "Transect") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(horizon_simplified = factor(horizon_simplified, levels = c("Mineral Subsurface", "Organic Subsurface", "Organic Surface"))) %>%
ggplot()+
#geom_line(aes(y = mean_depth, x = soil_bulk_density_g_cm3, group = Core_ID))+
geom_point(aes(y = mean_depth, x = mean_bd, color = horizon_simplified, group = Core_ID), size = 3)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth, cm",
x = "bulk density (g/cm3)")+
scale_color_manual(values = c("#D6AB7D", "#8A5A44", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "bottom")+
facet_grid(Area~Site) +
guides(color = guide_legend(reverse = TRUE))
bulkdensity_simplified =
bd_grouped %>%
filter(Site != "Transect") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(horizon_simplified = factor(horizon_simplified, levels = c("Mineral Subsurface", "Organic Subsurface", "Organic Surface"))) %>%
ggplot()+
#geom_line(aes(y = mean_depth, x = soil_bulk_density_g_cm3, group = Core_ID))+
geom_point(aes(y = mean_depth, x = mean_bd, color = horizon_simplified, group = Core_ID), size = 3)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth, cm",
x = "bulk density (g/cm3)")+
scale_color_manual(values = c("#D6AB7D", "#8A5A44", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "bottom")+
facet_grid(Area~Site) +
guides(color = guide_legend(reverse = TRUE))
vwc_simplified =
bd_grouped %>%
filter(Site != "Transect") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(horizon_simplified = factor(horizon_simplified, levels = c("Mineral Subsurface", "Organic Subsurface", "Organic Surface"))) %>%
ggplot()+
#geom_line(aes(y = mean_depth, x = soil_bulk_density_g_cm3, group = Core_ID))+
geom_point(aes(y = mean_depth, x = mean_vwc, color = horizon_simplified, group = Core_ID), size = 3)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth, cm",
x = "Volumetric Water Content (cm3 water/ cm3 soil)")+
scale_color_manual(values = c("#D6AB7D", "#8A5A44", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "bottom")+
facet_grid(Area~Site) +
guides(color = guide_legend(reverse = TRUE))
bd_grouped %>%
filter(Site != "Transect") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(horizon_simplified = factor(horizon_simplified, levels = c("Mineral Subsurface", "Organic Subsurface", "Organic Surface"))) %>%
ggplot()+
#geom_line(aes(y = mean_depth, x = soil_bulk_density_g_cm3, group = Core_ID))+
geom_point(aes(y = mean_depth, x = mean_vwc, color = horizon_simplified, group = Core_ID), size = 3)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth, cm",
x = "Volumetric Water Content (cm3 water/ cm3 soil)")+
scale_color_manual(values = c("#D6AB7D", "#8A5A44", "#482919"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "bottom")+
facet_grid(Area~Site) +
guides(color = guide_legend(reverse = TRUE))
ggsave("output/bd_simplified.png", plot = bulkdensity_simplified, height = 4.5, width = 6)
ggsave("output/vwc_simplified.png", plot = vwc_simplified, height = 4.5, width = 6)
source("code/0-packages.R")
dailyredoxunbinned = read.csv('processed/dailyredox_unbinned.csv')
combo_redox_withdepths = read.csv("processed/all_combine.csv")
grouped_redox_forfigs =
combo_redox_withdepths %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
group_by(site, position, depth_cm) %>%
dplyr::summarise(redox_avg_mV = round(mean(avg_values_fixed),2),
redox_sd = round(sd(avg_values_fixed),2),
redox_se = round(sd(avg_values_fixed)/sqrt(n()),2),
redox_sd2 = (redox_sd)/2)
ungrouped_redox_forfigs_nonacidichydric =
combo_redox_withdepths %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
filter(position == "hydric") %>%
separate(TIMESTAMP, sep = " ", into = c("date2", "time")) %>%
separate(date2, sep = "/", into =c('month', 'day', 'year')) %>%
mutate(date = as.Date(paste(year, month, day, sep = "-"))) %>%
mutate(datetime = ymd_hm(paste(date, time)),
date = ymd(date)) %>%
mutate(depth_2 = factor(depth_cm, levels = c("5", "7", "9", "11", "13", "23", "33", "53")))   %>%
#filter(probe == 1) %>%
dplyr::rename(redox_avg_mV = avg_values_fixed)
ungrouped_redox_forfigs_acidichydric =
combo_redox_withdepths %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
filter(position == "hydric") %>%
separate(TIMESTAMP, sep = " ", into = c("date2", "time")) %>%
separate(date2, sep = "/", into =c('month', 'day', 'year')) %>%
mutate(date = as.Date(paste(year, month, day, sep = "-"))) %>%
mutate(datetime = ymd_hm(paste(date, time)),
date = ymd(date)) %>%
mutate(depth_2 = factor(depth_cm, levels = c("1", "3", "5", "7", "9", "11", "13", "15", "19", "23", "25", "29", "30", "33", "35", "43", "49", "53", "55")))   %>%
#filter(probe == 1) %>%
dplyr::rename(redox_avg_mV = avg_values_fixed)
ungrouped_redox_forfigs_nonhydric =
combo_redox_withdepths %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
filter(position != "hydric") %>%
separate(TIMESTAMP, sep = " ", into = c("date2", "time")) %>%
separate(date2, sep = "/", into =c('month', 'day', 'year')) %>%
mutate(date = as.Date(paste(year, month, day, sep = "-"))) %>%
mutate(datetime = ymd_hm(paste(date, time)),
date = ymd(date)) %>%
mutate(depth_2 = factor(depth_cm, levels = c("1", "5", "6", "10", "15", "16", "20", "25", "26", "30"))) %>%
#filter(probe == 1) %>%
dplyr::rename(redox_avg_mV = avg_values_fixed)
acidicdry =
combo_redox_withdepths %>%
filter(site == "east" & position == "dry") %>%
group_by(depth_cm) %>%
mutate(depth_cm = factor(depth_cm))
ungrouped_redox_forfigs_nonhydric %>%
filter(position == "dry" & site == "acidic tundra" & probe == 1) %>%
#mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
ggplot(aes(y = redox_avg_mV, x = datetime), group = 'depth_cm')+
geom_rect(aes(xmin=as_datetime('2021-06-24 17:00:00'), xmax= as_datetime('2021-09-17 10:15:00'), ymin=100, ymax=300), fill = "grey", alpha = 0.5)+
geom_point(aes(color = depth_2, fill = depth_2), size = 2.5, alpha = 0.6, shape = c(21))+
#annotate(xmin='2021-06-21 00:15:00', xmax='2021-09-20 00:15:00', ymin=100, ymax=300, geom='rect', color='grey', alpha=0.5)+
#geom_line(orientation = "x", show.legend = FALSE)+
scale_x_datetime(date_breaks = "1 week", date_labels = "%b-%d")+
scale_color_manual(values = rev(natparks.pals(name = "Olympic")))+
scale_fill_manual(values = rev(natparks.pals(name = "Olympic")))+
ylim(-250, 700)+
labs(x = "", y = "redox potential (mV)",
color = "depth (cm)", fill = "depth (cm)")+
facet_grid(position~site)+
theme_er1()+
theme(axis.text.x = element_text (size = 10 , vjust = 0.5, hjust=1, angle = 90),
legend.position = "bottom")
acidic_dry_redox =
ungrouped_redox_forfigs_nonhydric %>%
filter(position == "dry" & site == "acidic tundra" & probe == 1) %>%
#mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
ggplot(aes(y = redox_avg_mV, x = datetime), group = 'depth_cm')+
geom_rect(aes(xmin=as_datetime('2021-06-24 17:00:00'), xmax= as_datetime('2021-09-17 10:15:00'), ymin=100, ymax=300), fill = "grey", alpha = 0.5)+
geom_point(aes(color = depth_2, fill = depth_2), size = 2.5, alpha = 0.6, shape = c(21))+
#annotate(xmin='2021-06-21 00:15:00', xmax='2021-09-20 00:15:00', ymin=100, ymax=300, geom='rect', color='grey', alpha=0.5)+
#geom_line(orientation = "x", show.legend = FALSE)+
scale_x_datetime(date_breaks = "1 week", date_labels = "%b-%d")+
scale_color_manual(values = rev(natparks.pals(name = "Olympic")))+
scale_fill_manual(values = rev(natparks.pals(name = "Olympic")))+
ylim(-250, 700)+
labs(x = "", y = "redox potential (mV)",
color = "depth (cm)", fill = "depth (cm)")+
facet_grid(position~site)+
theme_er1()+
theme(axis.text.x = element_text (size = 10 , vjust = 0.5, hjust=1, angle = 90),
legend.position = "bottom")
ggsave("figures_finalized/acidic_dry_redox.png", plot = acidic_dry_redox, height = 6, width = 4.5)
