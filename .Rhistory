geom_line(aes(y = mean_depth, x = mean_bd), orientation = "y")+
geom_point(aes(y = mean_depth, x = mean_bd, color = horizon_simplified), size = 4)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth (cm)")+
xlab(bquote("bulk density " (g/cm^3)))+
scale_color_manual(values = c("#D6AB7D", "#8A5A44", "#2F0E07"))++
facet_grid(Area~Site) +
guides(color = guide_legend(reverse = TRUE))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 12), legend.position = "bottom",
)
#bulkdensity_simplified =
bd_summarized_forfigs %>%
filter(Site != "Transect") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(horizon_simplified = factor(horizon_simplified, levels = c("Mineral Subsurface", "Organic Subsurface", "Organic Surface"))) %>%
ggplot()+
geom_line(aes(y = mean_depth, x = mean_bd), orientation = "y")+
geom_point(aes(y = mean_depth, x = mean_bd, color = horizon_simplified), size = 4)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth (cm)")+
xlab(bquote("bulk density " (g/cm^3)))+
scale_color_manual(values = c("#D6AB7D", "#8A5A44", "#2F0E07"))++
facet_grid(Area~Site) +
guides(color = guide_legend(reverse = TRUE))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 12),
legend.position = "bottom",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="white",size=0.25, fill = NA)
)
#bulkdensity_simplified =
bd_summarized_forfigs %>%
filter(Site != "Transect") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(horizon_simplified = factor(horizon_simplified, levels = c("Mineral Subsurface", "Organic Subsurface", "Organic Surface"))) %>%
ggplot()+
geom_line(aes(y = mean_depth, x = mean_bd), orientation = "y")+
geom_point(aes(y = mean_depth, x = mean_bd, color = horizon_simplified), size = 4)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth (cm)")+
xlab(bquote("bulk density " (g/cm^3)))+
scale_color_manual(values = c("#D6AB7D", "#8A5A44", "#2F0E07"))+
facet_grid(Area~Site) +
guides(color = guide_legend(reverse = TRUE))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 12),
legend.position = "bottom",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="white",size=0.25, fill = NA)
)
#bulkdensity_simplified =
bd_summarized_forfigs %>%
filter(Site != "Transect") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(horizon_simplified = factor(horizon_simplified, levels = c("Mineral Subsurface", "Organic Subsurface", "Organic Surface"))) %>%
ggplot()+
geom_line(aes(y = mean_depth, x = mean_bd), orientation = "y")+
geom_point(aes(y = mean_depth, x = mean_bd, color = horizon_simplified), size = 4)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth (cm)")+
xlab(bquote("bulk density " (g/cm^3)))+
scale_color_manual(values = c("#D6AB7D", "#8A5A44", "#2F0E07"))+
facet_grid(Area~Site) +
guides(color = guide_legend(reverse = TRUE))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 12),
legend.position = "bottom",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA)
)
source("code/0-packages.R")
thaw_depths = read.csv("raw/thaw_depth_2021.csv")
bd_grav_cleaned = read.csv("raw/PhIr2021_Soil_Inventory_bd.csv") %>%
#dplyr::select(-c(X)) %>%
mutate(Area = recode(Area, "East" = "acidic tundra",
"West" = "non-acidic tundra")) %>%
dplyr::mutate(soil_material = case_when(grepl("O",Horizon)~"organic",
grepl("M",Horizon)~"mineral")) %>%
mutate(volumetric_water_content_cm3_cm3 = soil_bulk_density_g_cm3 * grav_water_gh20_per_gdrysoil)
bd_select =
bd_grav_cleaned %>%
dplyr::select(Sample_ID, Core_ID, Date_collected, Area, Site, Plot_num, Plot_ID,
Horizon, Depth_1_cm, Depth_2_cm, Depth_3_cm, Depth_4_cm, Average_Depth_cm, real_depth_cm,
soil_bulk_density_g_cm3, volumetric_water_content_cm3_cm3, soil_material) %>%
mutate(label = Horizon) %>%
mutate(label = factor(label, levels = c("O", "O1", "O2", "O3", "M", "M1", "M2"))) %>%
mutate(date_simple = recode(Date_collected, "6-Jul-21" = "Plot-1", "7-Jul-21" = "Plot-1",
"13-Jul-21" = "Plot-2", "14-Jul-21" = "Plot-2",
"24-Jul-21" = "Plot-3",
"30-Jul-21" = "Plot-4", "31-Jul-21" = "Plot-4",
"7-Aug-21" = "Plot-5")) %>%
mutate(label = paste0(date_simple, "-", Plot_num))
ncount =
bd_select %>%
replace(is.na(.),"not analyzed")  %>%
mutate(data = case_when(grepl("not analyzed", soil_bulk_density_g_cm3) ~ "not analyzed", TRUE ~ "analyzed")) %>%
group_by(Area, Site, Date_collected, Core_ID, data) %>%
dplyr::summarise(n = n())
ncount2 =
bd_select %>%
replace(is.na(.),"not analyzed")  %>%
mutate(data = case_when(grepl("not analyzed", soil_bulk_density_g_cm3) ~ "not analyzed", TRUE ~ "analyzed"))
ncount_bd_vol =
ncount %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric", "Transect"))) %>%
mutate(Area = factor(Area, levels = c("non-acidic tundra", "acidic tundra"))) %>%
mutate(Date_collected = factor(Date_collected, levels = c("6-Jul-21", "7-Jul-21", "13-Jul-21", "14-Jul-21", "24-Jul-21", "30-Jul-21",
"31-Jul-21", "7-Aug-21"))) %>%
ggplot()+
geom_col(aes(x = Date_collected, y = n, fill = data))+
scale_fill_manual(values = c("#efc3e6", "#b8bedd"))+
labs(x = "date collected",
y = "number of samples",
fill = "bulk density
& volumetric water")+
facet_grid(Site~Area, scales = "free")+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "top",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank())
singleprofile_nonacidic_hydric =
bd_select %>%
filter(Site != "Transect" & Area == "non-acidic tundra" & Site == "Hydric" & label == "Plot-1-3")
View(singleprofile_nonacidic_hydric)
singleprofile_nonacidic_hydric =
bd_select %>%
filter(Site != "Transect" & Area == "non-acidic tundra" & Site == "Hydric" & label == "Plot-1-3") %>%
dplyr::select(c(Area, Site, Horizon, real_depth_cm, soil_material))
singleprofile_nonacidic_hydric =
bd_select %>%
filter(Site != "Transect" & Area == "non-acidic tundra" & Site == "Hydric" & label == "Plot-1-3") %>%
dplyr::select(c(Area, Site, Horizon, real_depth_cm, soil_material)) %>%
library(tibble)
View(thaw_depths)
singleprofile_nonacidic_hydric =
bd_select %>%
filter(Site != "Transect" & Area == "non-acidic tundra" & Site == "Hydric" & label == "Plot-1-3") %>%
dplyr::select(c(Area, Site, Horizon, real_depth_cm, soil_material, Plot_num))
singleprofilethaw =
thaw_depths %>%
filter(Area == "West" & Site == "Hydric" & Plot == "3")
View(singleprofilethaw)
singleprofilethaw =
thaw_depths %>%
filter(Area == "West" & Site == "Hydric" & Plot == "3" & Date == "7-Aug-2021")
'non-acidic tundra', 'Hydric', "permafrost", 60, "permafrost")
tocombine = tribble(
~Area, ~Site, ~Horizon, ~real_depth_cm, ~soil_material,
'non-acidic tundra', 'Hydric', "O/M", 52, "active layer"
'non-acidic tundra', 'Hydric', "permafrost", 60, "permafrost")
tocombine = tribble(
~Area, ~Site, ~Horizon, ~real_depth_cm, ~soil_material,
'non-acidic tundra', 'Hydric', "O/M", 52, "active layer",
'non-acidic tundra', 'Hydric', "permafrost", 60, "permafrost")
singleprofile_nonacidic_hydric =
bd_select %>%
filter(Site != "Transect" & Area == "non-acidic tundra" & Site == "Hydric" & label == "Plot-1-3") %>%
dplyr::select(c(Area, Site, Horizon, real_depth_cm, soil_material, Plot_num)) %>%
rbind(tocombine)
singleprofile_nonacidic_hydric =
bd_select %>%
filter(Site != "Transect" & Area == "non-acidic tundra" & Site == "Hydric" & label == "Plot-1-3") %>%
dplyr::select(c(Area, Site, Horizon, real_depth_cm, soil_material)) %>%
rbind(tocombine)
gglabel = tribble(
~Area, ~Site, ~x, ~y, ~label,
'non-acidic tundra', 'Hydric', 1, 5, 'low density
organic soil',
'non-acidic tundra', 'Hydric', 1, 12, 'high density
organic soil',
'non-acidic tundra', 'Hydric', 1, 30, 'active layer',
'non-acidic tundra', 'Hydric', 1, 55, 'permafrost',
)
singleprofile_nonacidic_hydric %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Site, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
geom_text(data = gglabel, aes(x = x, y = y, label = label), color = 'white', size = 6)+
scale_y_reverse()+
labs(title = " ",
fill = "", color = "",
y = "depth (cm)",
x = "Soil Profile")+
scale_fill_manual(values = c("#532C1E", "#2F0E07"))+
#facet_grid(Site~., scales="free_x") +
theme_er1()+
theme(axis.text.x = element_blank(), legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="white",size=0.25, fill = NA))
horizons_nonacidic_hydric_singleprofile =
singleprofile_nonacidic_hydric %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = real_depth_cm, x = Site, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
geom_text(data = gglabel, aes(x = x, y = y, label = label), color = 'white', size = 6)+
scale_y_reverse()+
labs(title = " ",
fill = "", color = "",
y = "depth (cm)",
x = "Soil Profile")+
scale_fill_manual(values = c("#532C1E", "#2F0E07"))+
#facet_grid(Site~., scales="free_x") +
theme_er1()+
theme(axis.text.x = element_blank(), legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="white",size=0.25, fill = NA))
singleprofile_nonacidic_hydric %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = real_depth_cm, x = Site, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
geom_text(data = gglabel, aes(x = x, y = y, label = label), color = 'white', size = 6)+
scale_y_reverse()+
labs(title = " ",
fill = "", color = "",
y = "depth (cm)",
x = "Soil Profile")+
scale_fill_manual(values = c("#532C1E", "#2F0E07"))+
#facet_grid(Site~., scales="free_x") +
theme_er1()+
theme(axis.text.x = element_blank(), legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="white",size=0.25, fill = NA))
singleprofile_nonacidic_hydric =
bd_select %>%
filter(Site != "Transect" & Area == "non-acidic tundra" & Site == "Hydric" & label == "Plot-1-3") %>%
dplyr::select(c(Area, Site, Horizon, Average_Depth_cm, soil_material)) %>%
rbind(tocombine)
tocombine = tribble(
~Area, ~Site, ~Horizon, ~Average_Depth_cm, ~soil_material,
'non-acidic tundra', 'Hydric', "O/M", 32, "active layer",
'non-acidic tundra', 'Hydric', "permafrost", 8, "permafrost")
singleprofile_nonacidic_hydric =
bd_select %>%
filter(Site != "Transect" & Area == "non-acidic tundra" & Site == "Hydric" & label == "Plot-1-3") %>%
dplyr::select(c(Area, Site, Horizon, Average_Depth_cm, soil_material)) %>%
rbind(tocombine)
gglabel = tribble(
~Area, ~Site, ~x, ~y, ~label,
'non-acidic tundra', 'Hydric', 1, 5, 'low density
organic soil',
'non-acidic tundra', 'Hydric', 1, 12, 'high density
organic soil',
'non-acidic tundra', 'Hydric', 1, 30, 'active layer',
'non-acidic tundra', 'Hydric', 1, 55, 'permafrost',
)
singleprofile_nonacidic_hydric %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = real_depth_cm, x = Site, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
geom_text(data = gglabel, aes(x = x, y = y, label = label), color = 'white', size = 6)+
scale_y_reverse()+
labs(title = " ",
fill = "", color = "",
y = "depth (cm)",
x = "Soil Profile")+
scale_fill_manual(values = c("#532C1E", "#2F0E07"))+
#facet_grid(Site~., scales="free_x") +
theme_er1()+
theme(axis.text.x = element_blank(), legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="white",size=0.25, fill = NA))
horizons_nonacidic_hydric_singleprofile =
singleprofile_nonacidic_hydric %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Site, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
geom_text(data = gglabel, aes(x = x, y = y, label = label), color = 'white', size = 6)+
scale_y_reverse()+
labs(title = " ",
fill = "", color = "",
y = "depth (cm)",
x = "Soil Profile")+
scale_fill_manual(values = c("#532C1E", "#2F0E07"))+
#facet_grid(Site~., scales="free_x") +
theme_er1()+
theme(axis.text.x = element_blank(), legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="white",size=0.25, fill = NA))
singleprofile_nonacidic_hydric %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Site, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
geom_text(data = gglabel, aes(x = x, y = y, label = label), color = 'white', size = 6)+
scale_y_reverse()+
labs(title = " ",
fill = "", color = "",
y = "depth (cm)",
x = "Soil Profile")+
scale_fill_manual(values = c("#532C1E", "#2F0E07"))+
#facet_grid(Site~., scales="free_x") +
theme_er1()+
theme(axis.text.x = element_blank(), legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="white",size=0.25, fill = NA))
singleprofile_nonacidic_hydric %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("permafrost", "O/M", "O2", "O1"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Site, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
geom_text(data = gglabel, aes(x = x, y = y, label = label), color = 'white', size = 6)+
scale_y_reverse()+
labs(title = " ",
fill = "", color = "",
y = "depth (cm)",
x = "Soil Profile")+
scale_fill_manual(values = c("#532C1E", "#2F0E07"))+
#facet_grid(Site~., scales="free_x") +
theme_er1()+
theme(axis.text.x = element_blank(), legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="white",size=0.25, fill = NA))
#horizons_nonacidic_hydric_singleprofile =
singleprofile_nonacidic_hydric %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("permafrost", "O/M", "O2", "O1"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Site, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
geom_text(data = gglabel, aes(x = x, y = y, label = label), color = 'white', size = 6)+
scale_y_reverse()+
labs(title = " ",
fill = "", color = "",
y = "depth (cm)",
x = "Soil Profile")+
scale_fill_manual(values = c("#bbd0ff", "#9a8c98", "#532C1E", "#2F0E07"))+
#facet_grid(Site~., scales="free_x") +
theme_er1()+
theme(axis.text.x = element_blank(), legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="white",size=0.25, fill = NA))
gglabel = tribble(
~Area, ~Site, ~x, ~y, ~label,
'non-acidic tundra', 'Hydric', 1, 3, 'low density
organic soil',
'non-acidic tundra', 'Hydric', 1, 15, 'high density
organic soil',
'non-acidic tundra', 'Hydric', 1, 30, 'active layer',
'non-acidic tundra', 'Hydric', 1, 58, 'permafrost',
)
#horizons_nonacidic_hydric_singleprofile =
singleprofile_nonacidic_hydric %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("permafrost", "O/M", "O2", "O1"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Site, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
geom_text(data = gglabel, aes(x = x, y = y, label = label), color = 'white', size = 6)+
scale_y_reverse()+
labs(title = " ",
fill = "", color = "",
y = "depth (cm)",
x = "Soil Profile")+
scale_fill_manual(values = c("#bbd0ff", "#9a8c98", "#532C1E", "#2F0E07"))+
#facet_grid(Site~., scales="free_x") +
theme_er1()+
theme(axis.text.x = element_blank(), legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="white",size=0.25, fill = NA))
gglabel = tribble(
~Area, ~Site, ~x, ~y, ~label,
'non-acidic tundra', 'Hydric', 1, 3, 'low density
organic soil',
'non-acidic tundra', 'Hydric', 1, 15, 'high density
organic soil',
'non-acidic tundra', 'Hydric', 1, 30, 'active layer
organic and mineral soil',
'non-acidic tundra', 'Hydric', 1, 58, 'permafrost',
)
#horizons_nonacidic_hydric_singleprofile =
singleprofile_nonacidic_hydric %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("permafrost", "O/M", "O2", "O1"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Site, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
geom_text(data = gglabel, aes(x = x, y = y, label = label), color = 'white', size = 6)+
scale_y_reverse()+
labs(title = " ",
fill = "", color = "",
y = "depth (cm)",
x = "Soil Profile")+
scale_fill_manual(values = c("#bbd0ff", "#9a8c98", "#532C1E", "#2F0E07"))+
#facet_grid(Site~., scales="free_x") +
theme_er1()+
theme(axis.text.x = element_blank(), legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="white",size=0.25, fill = NA))
gglabel = tribble(
~Area, ~Site, ~x, ~y, ~label,
'non-acidic tundra', 'Hydric', 1, 3.5, 'low density
organic soil',
'non-acidic tundra', 'Hydric', 1, 15, 'high density
organic soil',
'non-acidic tundra', 'Hydric', 1, 30, 'active layer
organic and mineral soil',
'non-acidic tundra', 'Hydric', 1, 58, 'permafrost',
)
#horizons_nonacidic_hydric_singleprofile =
singleprofile_nonacidic_hydric %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("permafrost", "O/M", "O2", "O1"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Site, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
geom_text(data = gglabel, aes(x = x, y = y, label = label), color = 'white', size = 6)+
scale_y_reverse()+
labs(title = " ",
fill = "", color = "",
y = "depth (cm)",
x = "Soil Profile")+
scale_fill_manual(values = c("#bbd0ff", "#9a8c98", "#532C1E", "#2F0E07"))+
#facet_grid(Site~., scales="free_x") +
theme_er1()+
theme(axis.text.x = element_blank(), legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="white",size=0.25, fill = NA))
horizons_nonacidic_hydric_singleprofile =
singleprofile_nonacidic_hydric %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("permafrost", "O/M", "O2", "O1"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Site, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
geom_text(data = gglabel, aes(x = x, y = y, label = label), color = 'white', size = 6)+
scale_y_reverse()+
labs(title = " ",
fill = "", color = "",
y = "depth (cm)",
x = "Soil Profile")+
scale_fill_manual(values = c("#bbd0ff", "#9a8c98", "#532C1E", "#2F0E07"))+
#facet_grid(Site~., scales="free_x") +
theme_er1()+
theme(axis.text.x = element_blank(), legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="white",size=0.25, fill = NA))
ggsave("formanuscript/horizons_nonacidic_hydric_singleprofile.png", plot = horizons_nonacidic_hydric_singleprofile, height = 5.5, width = 3.25)
ggsave("formanuscript/horizons_nonacidic_hydric_singleprofile.png", plot = horizons_nonacidic_hydric_singleprofile, height = 4.5, width = 2.25)
ggsave("formanuscript/horizons_nonacidic_hydric_singleprofile.png", plot = horizons_nonacidic_hydric_singleprofile, height = 4.5, width = 3.25)
gglabel = tribble(
~Area, ~Site, ~x, ~y, ~label,
'non-acidic tundra', 'Hydric', 1, 3.5, 'low density
organic soil',
'non-acidic tundra', 'Hydric', 1, 15, 'high density
organic soil',
'non-acidic tundra', 'Hydric', 1, 30, 'active layer
organic + mineral soil',
'non-acidic tundra', 'Hydric', 1, 58, 'permafrost',
)
gglabel = tribble(
~Area, ~Site, ~x, ~y, ~label,
'non-acidic tundra', 'Hydric', 1, 3.5, 'low density
organic soil',
'non-acidic tundra', 'Hydric', 1, 15, 'high density
organic soil',
'non-acidic tundra', 'Hydric', 1, 30, 'active layer
organic + mineral soil',
'non-acidic tundra', 'Hydric', 1, 58, 'permafrost',
)
horizons_nonacidic_hydric_singleprofile =
singleprofile_nonacidic_hydric %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("permafrost", "O/M", "O2", "O1"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Site, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
geom_text(data = gglabel, aes(x = x, y = y, label = label), color = 'white', size = 5)+
scale_y_reverse()+
labs(title = " ",
fill = "", color = "",
y = "depth (cm)",
x = "Soil Profile")+
scale_fill_manual(values = c("#bbd0ff", "#9a8c98", "#532C1E", "#2F0E07"))+
#facet_grid(Site~., scales="free_x") +
theme_er1()+
theme(axis.text.x = element_blank(), legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="white",size=0.25, fill = NA))
ggsave("formanuscript/horizons_nonacidic_hydric_singleprofile.png", plot = horizons_nonacidic_hydric_singleprofile, height = 4.5, width = 3.25)
ggsave("formanuscript/horizons_nonacidic_hydric_singleprofile.png", plot = horizons_nonacidic_hydric_singleprofile, height = 5, width = 4)
ggsave("formanuscript/horizons_nonacidic_hydric_singleprofile.png", plot = horizons_nonacidic_hydric_singleprofile, height = 5, width = 5)
gglabel = tribble(
~Area, ~Site, ~x, ~y, ~label,
'non-acidic tundra', 'Hydric', 1, 3.7, 'low density
organic soil',
'non-acidic tundra', 'Hydric', 1, 15, 'high density
organic soil',
'non-acidic tundra', 'Hydric', 1, 30, 'active layer
organic + mineral soil',
'non-acidic tundra', 'Hydric', 1, 58, 'permafrost',
)
horizons_nonacidic_hydric_singleprofile =
singleprofile_nonacidic_hydric %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("permafrost", "O/M", "O2", "O1"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Site, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
geom_text(data = gglabel, aes(x = x, y = y, label = label), color = 'white', size = 5)+
scale_y_reverse()+
labs(title = " ",
fill = "", color = "",
y = "depth (cm)",
x = "Soil Profile")+
scale_fill_manual(values = c("#bbd0ff", "#9a8c98", "#532C1E", "#2F0E07"))+
#facet_grid(Site~., scales="free_x") +
theme_er1()+
theme(axis.text.x = element_blank(), legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="white",size=0.25, fill = NA))
ggsave("formanuscript/horizons_nonacidic_hydric_singleprofile.png", plot = horizons_nonacidic_hydric_singleprofile, height = 5, width = 5)
ggsave("formanuscript/horizons_nonacidic_hydric_singleprofile.png", plot = horizons_nonacidic_hydric_singleprofile, height = 6.4, width = 5.6)
