x = "dissolved oxygen, mg/L")+
theme_erclean()+
theme(legend.position = c(.90, .5),
legend.justification = c("right", "top"),
legend.box.just = "right",legend.title = element_text(face = "bold"),
legend.margin = margin(6, 6, 6, 6), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA),
legend.background = element_rect(color = NA))
#manuscript_figure =
microDO_forfig %>%
ggplot()+
geom_point(aes(x=DO.mgL, y = depth, fill = Site, shape = Site))+
scale_y_reverse()+
labs(y = "depth, cm",
x = "dissolved oxygen, mg/L")+
theme_erclean()+
theme(legend.position = c(.90, .45),
legend.justification = c("right", "top"),
legend.box.just = "right",legend.title = element_text(face = "bold"),
legend.margin = margin(6, 6, 6, 6), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA),
legend.background = element_rect(color = NA))
#manuscript_figure =
microDO_forfig %>%
ggplot()+
geom_point(aes(x=DO.mgL, y = depth, fill = Site, shape = Site))+
scale_y_reverse()+
labs(y = "depth, cm",
x = "dissolved oxygen, mg/L")+
theme_erclean()+
theme(legend.position = c(.80, .45),
legend.justification = c("right", "top"),
legend.box.just = "right",legend.title = element_text(face = "bold"),
legend.margin = margin(6, 6, 6, 6), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA),
legend.background = element_rect(color = NA))
#manuscript_figure =
microDO_forfig %>%
ggplot()+
geom_point(aes(x=DO.mgL, y = depth, fill = Site, shape = Site), size = 5)+
scale_y_reverse()+
labs(y = "depth, cm",
x = "dissolved oxygen, mg/L")+
theme_erclean()+
theme(legend.position = c(.80, .45),
legend.justification = c("right", "top"),
legend.box.just = "right",legend.title = element_text(face = "bold"),
legend.margin = margin(6, 6, 6, 6), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA),
legend.background = element_rect(color = NA))
#manuscript_figure =
microDO_forfig %>%
ggplot()+
geom_point(aes(x=DO.mgL, y = depth, fill = Site, shape = Site), size = 3)+
scale_y_reverse()+
labs(y = "depth, cm",
x = "dissolved oxygen, mg/L")+
theme_erclean()+
theme(legend.position = c(.80, .45),
legend.justification = c("right", "top"),
legend.box.just = "right",legend.title = element_text(face = "bold"),
legend.margin = margin(6, 6, 6, 6), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA),
legend.background = element_rect(color = NA))
#manuscript_figure =
microDO_forfig %>%
ggplot()+
geom_point(aes(x=DO.mgL, y = depth, fill = Site, shape = Site), size = 3)+
scale_fill_manual(values = c("#99d98c", "#38a3a5"))+
scale_shape_manual(values = c(21, 22))+
scale_y_reverse()+
labs(y = "depth, cm",
x = "dissolved oxygen, mg/L")+
theme_erclean()+
theme(legend.position = c(.80, .45),
legend.justification = c("right", "top"),
legend.box.just = "right",legend.title = element_text(face = "bold"),
legend.margin = margin(6, 6, 6, 6), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA),
legend.background = element_rect(color = NA))
#manuscript_figure =
microDO_forfig %>%
ggplot()+
geom_point(aes(x=DO.mgL, y = depth, fill = Site, shape = Site), size = 3)+
scale_fill_manual(values = c("#023047", "#588157"))+
scale_shape_manual(values = c(21, 22))+
scale_y_reverse()+
labs(y = "depth, cm",
x = "dissolved oxygen, mg/L")+
theme_erclean()+
theme(legend.position = c(.80, .45),
legend.justification = c("right", "top"),
legend.box.just = "right",legend.title = element_text(face = "bold"),
legend.margin = margin(6, 6, 6, 6), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA),
legend.background = element_rect(color = NA))
#manuscript_figure =
microDO_forfig %>%
ggplot()+
geom_point(aes(x=DO.mgL, y = depth, fill = Site, shape = Site), size = 3)+
scale_fill_manual(values = c("#2D5895", "#FFB206"))+
scale_shape_manual(values = c(21, 22))+
scale_y_reverse()+
labs(y = "depth, cm",
x = "dissolved oxygen, mg/L")+
theme_erclean()+
theme(legend.position = c(.80, .45),
legend.justification = c("right", "top"),
legend.box.just = "right",legend.title = element_text(face = "bold"),
legend.margin = margin(6, 6, 6, 6), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA),
legend.background = element_rect(color = NA))
#manuscript_figure =
microDO_forfig %>%
ggplot()+
geom_point(aes(x=DO.mgL, y = depth, fill = Site, shape = Site), size = 3.5, alpha = 0.5)+
scale_fill_manual(values = c("#2D5895", "#FFB206"))+
scale_shape_manual(values = c(21, 22))+
scale_y_reverse()+
labs(y = "depth, cm",
x = "dissolved oxygen, mg/L")+
theme_erclean()+
theme(legend.position = c(.80, .45),
legend.justification = c("right", "top"),
legend.box.just = "right",legend.title = element_text(face = "bold"),
legend.margin = margin(6, 6, 6, 6), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA),
legend.background = element_rect(color = NA))
#manuscript_figure =
microDO_forfig %>%
ggplot()+
geom_point(aes(x=DO.mgL, y = depth, fill = Site, shape = Site), size = 3.5, alpha = 0.2)+
scale_fill_manual(values = c("#2D5895", "#FFB206"))+
scale_shape_manual(values = c(21, 22))+
scale_y_reverse()+
labs(y = "depth, cm",
x = "dissolved oxygen, mg/L")+
theme_erclean()+
theme(legend.position = c(.80, .45),
legend.justification = c("right", "top"),
legend.box.just = "right",legend.title = element_text(face = "bold"),
legend.margin = margin(6, 6, 6, 6), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA),
legend.background = element_rect(color = NA))
#manuscript_figure =
microDO_forfig %>%
ggplot()+
geom_point(aes(x=DO.mgL, y = depth, fill = Site, shape = Site), size = 3.5, alpha = 0.8)+
scale_fill_manual(values = c("#2D5895", "#FFB206"))+
scale_shape_manual(values = c(21, 22))+
scale_y_reverse()+
labs(y = "depth, cm",
x = "dissolved oxygen, mg/L")+
theme_erclean()+
theme(legend.position = c(.80, .45),
legend.justification = c("right", "top"),
legend.box.just = "right",legend.title = element_text(face = "bold"),
legend.margin = margin(6, 6, 6, 6), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA),
legend.background = element_rect(color = NA))
manuscript_figure =
microDO_forfig %>%
ggplot()+
geom_point(aes(x=DO.mgL, y = depth, fill = Site, shape = Site), size = 3.5, alpha = 0.8)+
scale_fill_manual(values = c("#2D5895", "#FFB206"))+
scale_shape_manual(values = c(21, 22))+
scale_y_reverse()+
labs(y = "depth, cm",
x = "dissolved oxygen, mg/L")+
theme_erclean()+
theme(legend.position = c(.80, .45),
legend.justification = c("right", "top"),
legend.box.just = "right",legend.title = element_text(face = "bold"),
legend.margin = margin(6, 6, 6, 6), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA),
legend.background = element_rect(color = NA))
ggsave("output/DOfig.png", manuscript_figure, height = 6, width = 4)
manuscript_figure =
microDO_forfig %>%
ggplot()+
geom_point(aes(x=DO.mgL, y = depth, fill = Site, shape = Site), size = 3.5, alpha = 0.8)+
scale_fill_manual(values = c("#2D5895", "#FFB206"))+
scale_shape_manual(values = c(21, 22))+
scale_y_reverse()+
labs(y = "depth, cm",
x = "dissolved oxygen, mg/L")+
theme_erclean()+
theme(legend.position = c(.80, .45),
legend.justification = c("right", "top"),
legend.box.just = "right",legend.title = element_text(face = "bold"),
legend.margin = margin(6, 6, 6, 6), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA),
legend.background = element_rect(color = NA),
panel.border = element_rect(color="gray",size=0.25, fill = NA))
microDO_forfig %>%
ggplot()+
geom_point(aes(x=DO.mgL, y = depth, fill = Site, shape = Site), size = 3.5, alpha = 0.8)+
scale_fill_manual(values = c("#2D5895", "#FFB206"))+
scale_shape_manual(values = c(21, 22))+
scale_y_reverse()+
labs(y = "depth, cm",
x = "dissolved oxygen, mg/L")+
theme_er1()+
theme(legend.position = c(.80, .45),
legend.justification = c("right", "top"),
legend.box.just = "right",legend.title = element_text(face = "bold"),
legend.margin = margin(6, 6, 6, 6), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA),
legend.background = element_rect(color = NA))
manuscript_figure =
microDO_forfig %>%
ggplot()+
geom_point(aes(x=DO.mgL, y = depth, fill = Site, shape = Site), size = 3.5, alpha = 0.8)+
scale_fill_manual(values = c("#2D5895", "#FFB206"))+
scale_shape_manual(values = c(21, 22))+
scale_y_reverse()+
labs(y = "depth, cm",
x = "dissolved oxygen, mg/L")+
theme_er1()+
theme(legend.position = c(.80, .45),
legend.justification = c("right", "top"),
legend.box.just = "right",legend.title = element_text(face = "bold"),
legend.margin = margin(6, 6, 6, 6), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="black",size=0.25, fill = NA),
legend.background = element_rect(color = NA))
microDO_forfig %>%
ggplot()+
geom_point(aes(x=DO.mgL, y = depth, fill = Site, shape = Site), size = 3.5, alpha = 0.8)+
scale_fill_manual(values = c("#2D5895", "#FFB206"))+
scale_shape_manual(values = c(21, 22))+
scale_y_reverse()+
labs(y = "depth, cm",
x = "dissolved oxygen, mg/L")+
theme_er1()+
theme(legend.position = c(.80, .45),
legend.justification = c("right", "top"),
legend.box.just = "right",legend.title = element_text(face = "bold"),
legend.margin = margin(6, 6, 6, 6), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="black",size=0.25, fill = NA),
legend.background = element_rect(color = NA))
manuscript_figure =
microDO_forfig %>%
ggplot()+
geom_point(aes(x=DO.mgL, y = depth, fill = Site, shape = Site), size = 3.5, alpha = 0.8)+
scale_fill_manual(values = c("#2D5895", "#FFB206"))+
scale_shape_manual(values = c(21, 22))+
scale_y_reverse()+
labs(y = "depth, cm",
x = "dissolved oxygen, mg/L")+
theme_er1()+
theme(legend.position = c(.80, .45),
legend.justification = c("right", "top"),
legend.box.just = "right",legend.title = element_text(face = "bold"),
legend.margin = margin(6, 6, 6, 6), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="black",size=0.25, fill = NA),
legend.background = element_rect(color = NA))
ggsave("output/DOfig.png", manuscript_figure, height = 6, width = 4)
source("code/0-packages.R")
thaw_depths = read.csv("raw/thaw_depth_2021.csv")
bd_grav_cleaned = read.csv("raw/PhIr2021_Soil_Inventory_bd.csv") %>%
#dplyr::select(-c(X)) %>%
mutate(Area = recode(Area, "East" = "acidic tundra",
"West" = "non-acidic tundra")) %>%
dplyr::mutate(soil_material = case_when(grepl("O",Horizon)~"organic",
grepl("M",Horizon)~"mineral")) %>%
dplyr::mutate(soil_material2 = case_when(Horizon == "O"~"organic surface",
Horizon =="O1"~"organic surface",
Horizon == "O2"~"organic subsurface",
grepl("M",Horizon)~"mineral subsurface")) %>%
mutate(volumetric_water_content_cm3_cm3 = soil_bulk_density_g_cm3 * grav_water_gh20_per_gdrysoil)
bd_select =
bd_grav_cleaned %>%
dplyr::select(Sample_ID, Core_ID, Date_collected, Area, Site, Plot_num, Plot_ID,
Horizon, Depth_1_cm, Depth_2_cm, Depth_3_cm, Depth_4_cm, Average_Depth_cm, real_depth_cm,
soil_bulk_density_g_cm3, volumetric_water_content_cm3_cm3, soil_material, soil_material2) %>%
mutate(label = Horizon) %>%
mutate(label = factor(label, levels = c("O", "O1", "O2", "O3", "M", "M1", "M2"))) %>%
mutate(date_simple = recode(Date_collected, "6-Jul-21" = "Plot-1", "7-Jul-21" = "Plot-1",
"13-Jul-21" = "Plot-2", "14-Jul-21" = "Plot-2",
"24-Jul-21" = "Plot-3",
"30-Jul-21" = "Plot-4", "31-Jul-21" = "Plot-4",
"7-Aug-21" = "Plot-5")) %>%
mutate(label = paste0(date_simple, "-", Plot_num))
organic_sat =
bd_select %>%
filter(soil_material == "organic") %>%
mutate(particle_dens = 0.8)
mineral_sat =
bd_select %>%
filter(soil_material == "mineral") %>%
mutate(particle_dens = 2.65)
saturation_dat =
organic_sat %>%
vctrs::vec_c(mineral_sat) %>%
mutate(bulk_particledens = (soil_bulk_density_g_cm3/particle_dens)) %>%
mutate(vol_voids = (1-(soil_bulk_density_g_cm3/particle_dens))) %>%
mutate(degree_saturation = (volumetric_water_content_cm3_cm3/vol_voids)*100)
saturation_volumetricwater_fig =
saturation_dat %>%
ggplot()+
geom_point(aes(x = volumetric_water_content_cm3_cm3, y = degree_saturation, fill = soil_material),
alpha = 0.8, size = 2.5, shape = c(21))+
labs(x = "volumetric water content, Î¸ ",
y = "degree of saturation, %",
fill = "soil material")+
scale_x_continuous(position="bottom", n.breaks=5, limits = c(0,0.8))+
scale_y_continuous(position="left", breaks = c(0, 25, 50, 75, 100, 125), n.breaks=7, limits = c(0,125))+
scale_fill_manual(values = c("#d6ccc2", "#482919"))+
guides(fill = guide_legend(reverse = TRUE))+
theme_er1()+
theme(legend.position = c(.90, .35),
legend.justification = c("right", "top"),
legend.box.just = "right",legend.title = element_text(face = "bold"),
legend.margin = margin(6, 6, 6, 6), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA))
ggsave("output/saturation_volumetricwater_fig.png", plot = saturation_volumetricwater_fig, height = 3.5, width = 3.5)
bd_select %>%
filter(Site != "Transect" & Area == "acidic tundra") %>%
mutate(Site = recode(Site, "Hydric" = "Wet")) %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Wet"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = CoreID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(title = "acidic tundra",
fill = "", color = "",
y = "depth, cm",
x = " ")+
#scale_fill_manual(values = c("#BFAFA6", "#a78a7f", "#735751", "#b07d62", "#7f5539", "#432818", "#132a13"))+
scale_fill_manual(values = c("#D3C8BB", "#B2A496", "#AA968A", "#81583A", "#734F38", "#553725", "#482919"))+
facet_grid(Site~., scales="free_x") +
guides(fill = guide_legend(reverse = TRUE))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right",
axis.title.y = element_blank(), axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA))
bd_select %>%
filter(Site != "Transect" & Area == "acidic tundra") %>%
mutate(Site = recode(Site, "Hydric" = "Wet")) %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Wet"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(title = "acidic tundra",
fill = "", color = "",
y = "depth, cm",
x = " ")+
#scale_fill_manual(values = c("#BFAFA6", "#a78a7f", "#735751", "#b07d62", "#7f5539", "#432818", "#132a13"))+
scale_fill_manual(values = c("#D3C8BB", "#B2A496", "#AA968A", "#81583A", "#734F38", "#553725", "#482919"))+
facet_grid(Site~., scales="free_x") +
guides(fill = guide_legend(reverse = TRUE))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right",
axis.title.y = element_blank(), axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA))
horizons_acidic =
bd_select %>%
filter(Site != "Transect" & Area == "acidic tundra") %>%
mutate(Site = recode(Site, "Hydric" = "Wet")) %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Wet"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(title = "acidic tundra",
fill = "", color = "",
y = "depth, cm",
x = " ")+
#scale_fill_manual(values = c("#BFAFA6", "#a78a7f", "#735751", "#b07d62", "#7f5539", "#432818", "#132a13"))+
scale_fill_manual(values = c("#D3C8BB", "#B2A496", "#AA968A", "#81583A", "#734F38", "#553725", "#482919"))+
facet_grid(Site~., scales="free") +
guides(fill = guide_legend(reverse = TRUE))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right",
axis.title.y = element_blank(), axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA))
bd_select %>%
filter(Site != "Transect" & Area == "acidic tundra") %>%
mutate(Site = recode(Site, "Hydric" = "Wet")) %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Wet"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(title = "acidic tundra",
fill = "", color = "",
y = "depth, cm",
x = " ")+
#scale_fill_manual(values = c("#BFAFA6", "#a78a7f", "#735751", "#b07d62", "#7f5539", "#432818", "#132a13"))+
scale_fill_manual(values = c("#D3C8BB", "#B2A496", "#AA968A", "#81583A", "#734F38", "#553725", "#482919"))+
facet_grid(Site~., scales="free") +
guides(fill = guide_legend(reverse = TRUE))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right",
axis.title.y = element_blank(), axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA))
bd_select %>%
filter(Site != "Transect" & Area == "non-acidic tundra") %>%
mutate(Site = recode(Site, "Hydric" = "Wet")) %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Wet"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(title = "non-acidic tundra",
fill = "", color = "",
y = "depth, cm",
x = " ")+
#scale_fill_manual(values = c("#AA968A", "#553725", "#482919", "#482919"))+
scale_fill_manual(values = c("#AA968A", "#553725", "#482919", "#482919"))+
facet_grid(Site~., scales="free_x") +
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA))
bd_select %>%
filter(Site != "Transect" & Area == "acidic tundra") %>%
mutate(Site = recode(Site, "Hydric" = "Wet")) %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Wet"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(title = "acidic tundra",
fill = "", color = "",
y = "depth, cm",
x = " ")+
#scale_fill_manual(values = c("#BFAFA6", "#a78a7f", "#735751", "#b07d62", "#7f5539", "#432818", "#132a13"))+
scale_fill_manual(values = c("#D3C8BB", "#B2A496", "#AA968A", "#81583A", "#734F38", "#553725", "#482919"))+
facet_grid(.~Site, scales="free") +
guides(fill = guide_legend(reverse = TRUE))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right",
axis.title.y = element_blank(), axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA))
bd_select %>%
filter(Site != "Transect" & Area == "non-acidic tundra") %>%
mutate(Site = recode(Site, "Hydric" = "Wet")) %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Wet"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(title = "non-acidic tundra",
fill = "", color = "",
y = "depth, cm",
x = " ")+
#scale_fill_manual(values = c("#AA968A", "#553725", "#482919", "#482919"))+
scale_fill_manual(values = c("#AA968A", "#553725", "#482919", "#482919"))+
facet_grid(.~Site, scales="free_x") +
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA))
horizons_acidic =
bd_select %>%
filter(Site != "Transect" & Area == "acidic tundra") %>%
mutate(Site = recode(Site, "Hydric" = "Wet")) %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Wet"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(title = "acidic tundra",
fill = "", color = "",
y = "depth, cm",
x = " ")+
#scale_fill_manual(values = c("#BFAFA6", "#a78a7f", "#735751", "#b07d62", "#7f5539", "#432818", "#132a13"))+
scale_fill_manual(values = c("#D3C8BB", "#B2A496", "#AA968A", "#81583A", "#734F38", "#553725", "#482919"))+
facet_grid(.~Site, scales="free") +
guides(fill = guide_legend(reverse = TRUE))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right",
axis.title.y = element_blank(), axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA))
horizons_nonacidic =
bd_select %>%
filter(Site != "Transect" & Area == "non-acidic tundra") %>%
mutate(Site = recode(Site, "Hydric" = "Wet")) %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Wet"))) %>%
mutate(Horizon = factor(Horizon, levels = c("M2", "M1", "M", "O3", "O2", "O1", "O"))) %>%
ggplot()+
geom_col(aes(y = Average_Depth_cm, x = Core_ID, fill = Horizon), color = "white", position = 'stack', width = 0.7)+
scale_y_reverse()+
labs(title = "non-acidic tundra",
fill = "", color = "",
y = "depth, cm",
x = " ")+
#scale_fill_manual(values = c("#AA968A", "#553725", "#482919", "#482919"))+
scale_fill_manual(values = c("#AA968A", "#553725", "#482919", "#482919"))+
facet_grid(.~Site, scales="free_x") +
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "none",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA))
horizons_all = horizons_nonacidic / horizons_acidic
horizons_all
horizons_all = horizons_nonacidic / horizons_acidic
ggsave("formanuscript/horizons_all.png", plot = horizons_all, height = 6, width = 10)
