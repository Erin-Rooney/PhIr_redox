#filter(site == "acidic tundra") %>%
mutate(depth_cm = recode(depth_cm, "5" = "0-10", "15" = "10-20", "25" = "20-30")) %>%
mutate(depth_2 = factor(depth_cm, levels = c("0-10", "10-20", "20-30")))   %>%
#mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
ggplot()+
# geom_line(aes(y = moisture, x = datetime, color = depth_2, group = depth_2), size = 1)+
geom_point(aes(y = moisture, x = datetime, color = depth_2, group = depth_2), size = 0.5)+
scale_x_datetime(date_breaks = "2 weeks", date_labels = "%b-%d")+
#ylim(25, 5)+
labs(x = "2021", y = "soil moisture, %",
color = "soil depth cm")+
scale_y_continuous(breaks = c(0, 10, 20, 30, 40, 50), n.breaks=6, limits = c(0, 60))+
#scale_fill_manual(values=natparks.pals("Arches", 11))+
scale_color_manual(values=(pnw_palette("Lake", 3)))+
guides(colour = guide_legend(override.aes = list(size=6)))+
facet_grid(position~site, scales = "free_x")+
theme_er1()+
theme(axis.text.x = element_text(size = 12, vjust = 0.5, angle = 45),
axis.text.y = element_text(size = 12),
legend.position = "bottom", panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
strip.text.y = element_blank(),
strip.text.x = element_text(size = 16))
moisture_lines=
final_temp_sal_moist_forfig %>%
filter(moisture > 10) %>%
mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
mutate(month = factor(month, levels = c("early summer", "mid summer", "late summer", "early fall")))   %>%
#filter(site == "acidic tundra") %>%
mutate(depth_cm = recode(depth_cm, "5" = "0-10", "15" = "10-20", "25" = "20-30")) %>%
mutate(depth_2 = factor(depth_cm, levels = c("0-10", "10-20", "20-30")))   %>%
#mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
ggplot()+
# geom_line(aes(y = moisture, x = datetime, color = depth_2, group = depth_2), size = 1)+
geom_point(aes(y = moisture, x = datetime, color = depth_2, group = depth_2), size = 0.5)+
scale_x_datetime(date_breaks = "2 weeks", date_labels = "%b-%d")+
#ylim(25, 5)+
labs(x = "2021", y = "soil moisture, %",
color = "soil depth cm")+
scale_y_continuous(breaks = c(0, 10, 20, 30, 40, 50), n.breaks=6, limits = c(0, 60))+
#scale_fill_manual(values=natparks.pals("Arches", 11))+
scale_color_manual(values=(pnw_palette("Lake", 3)))+
guides(colour = guide_legend(override.aes = list(size=6)))+
facet_grid(position~site, scales = "free_x")+
theme_er1()+
theme(axis.text.x = element_text(size = 12, vjust = 0.5, angle = 45),
axis.text.y = element_text(size = 12),
legend.position = "bottom", panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
strip.text.y = element_blank(),
strip.text.x = element_text(size = 16))
ggsave("formanuscript/moisture_lines.png", plot = moisture_lines, width = 6, height = 6)
moisture_linesAll = moisture_lines + plot_spacer() + moisture_lines2022 + plot_layout(guides = "collect", widths = c(6, 0.25 , 6)) & theme(legend.position = 'bottom')
ggsave("output/moisture_linesAll.png", plot = moisture_linesAll, height = 7, width = 13)
final_temp_sal_moist_forfig2022 %>%
mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
mutate(month = factor(month, levels = c("early summer", "mid summer", "late summer", "early fall")))   %>%
#filter(site == "acidic tundra") %>%
#filter(position == "dry") %>%
mutate(depth_cm = recode(depth_cm, "5" = "0-10", "15" = "10-20", "25" = "20-30")) %>%
mutate(depth_2 = factor(depth_cm, levels = c("0-10", "10-20", "20-30")))   %>%
#mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
ggplot()+
geom_point(aes(y = temp, x = datetime, color = depth_2, group = depth_2), size = 0.25)+
scale_x_datetime(date_breaks = "2 week", date_labels = "%b-%d")+
#ylim(25, 5)+
labs(x = "2022", y = " ",
color = "soil depth cm")+
#scale_fill_manual(values=natparks.pals("Arches", 11))+
scale_color_manual(values=(pnw_palette("Lake", 3)))+
guides(colour = guide_legend(override.aes = list(size=6)))+
facet_grid(position~site, scales = "free_x")+
theme_er1()+
theme(axis.text.x = element_text(size = 12, vjust = 0.5, angle = 45),
legend.position = "bottom", panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.text.y=element_blank(),  #remove y axis labels
axis.ticks.y=element_blank(),
axis.title.x = element_text(size = 16),
strip.text.x = element_text(size = 16),
strip.text.y = element_text(size = 16))
final_temp_sal_moist_forfig2022 %>%
mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
mutate(month = factor(month, levels = c("early summer", "mid summer", "late summer", "early fall")))   %>%
#filter(site == "acidic tundra") %>%
#filter(position == "dry") %>%
mutate(depth_cm = recode(depth_cm, "5" = "0-10", "15" = "10-20", "25" = "20-30")) %>%
mutate(depth_2 = factor(depth_cm, levels = c("0-10", "10-20", "20-30")))   %>%
#mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
ggplot()+
geom_point(aes(y = temp, x = datetime, color = depth_2, group = depth_2), size = 0.25)+
scale_x_datetime(date_breaks = "2 week", date_labels = "%b-%d")+
scale_y_continuous(breaks = c(0, 10, 20, 30), n.breaks=4, limits = c(0, 40))+
#ylim(25, 5)+
labs(x = "2022", y = " ",
color = "soil depth cm")+
#scale_fill_manual(values=natparks.pals("Arches", 11))+
scale_color_manual(values=(pnw_palette("Lake", 3)))+
guides(colour = guide_legend(override.aes = list(size=6)))+
facet_grid(position~site, scales = "free_x")+
theme_er1()+
theme(axis.text.x = element_text(size = 12, vjust = 0.5, angle = 45),
legend.position = "bottom", panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.text.y=element_blank(),  #remove y axis labels
axis.ticks.y=element_blank(),
axis.title.x = element_text(size = 16),
strip.text.x = element_text(size = 16),
strip.text.y = element_text(size = 16))
temp_lines2022=
final_temp_sal_moist_forfig2022 %>%
mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
mutate(month = factor(month, levels = c("early summer", "mid summer", "late summer", "early fall")))   %>%
#filter(site == "acidic tundra") %>%
#filter(position == "dry") %>%
mutate(depth_cm = recode(depth_cm, "5" = "0-10", "15" = "10-20", "25" = "20-30")) %>%
mutate(depth_2 = factor(depth_cm, levels = c("0-10", "10-20", "20-30")))   %>%
#mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
ggplot()+
geom_point(aes(y = temp, x = datetime, color = depth_2, group = depth_2), size = 0.25)+
scale_x_datetime(date_breaks = "2 weeks", date_labels = "%b-%d")+
scale_y_continuous(breaks = c(0, 10, 20, 30), n.breaks=4, limits = c(0, 35))+
#ylim(25, 5)+
labs(x = "2022", y = " ",
color = "soil depth cm")+
#scale_fill_manual(values=natparks.pals("Arches", 11))+
scale_color_manual(values=(pnw_palette("Lake", 3)))+
guides(colour = guide_legend(override.aes = list(size=6)))+
facet_grid(position~site, scales = "free_x")+
theme_er1()+
theme(axis.text.x = element_text(size = 12, vjust = 0.5, angle = 45),
legend.position = "bottom", panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.text.y=element_blank(),  #remove y axis labels
axis.ticks.y=element_blank(),
axis.title.x = element_text(size = 16),
strip.text.x = element_text(size = 16),
strip.text.y = element_text(size = 16))
ggsave("formanuscript/temp_lines2022.tiff", plot = temp_lines2022, width = 6, height = 6)
temp_lines_dry =
final_temp_sal_moist_forfig %>%
filter(position == "dry" & datetime > "2021-07-06 00:00:00") %>%
mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
mutate(month = factor(month, levels = c("early summer", "mid summer", "late summer", "early fall")))   %>%
mutate(depth_cm = recode(depth_cm, "5" = "0-10", "15" = "10-20", "25" = "20-30")) %>%
mutate(depth_2 = factor(depth_cm, levels = c("0-10", "10-20", "20-30")))   %>%
ggplot()+
#geom_point(aes(y = temp, x = datetime, color = depth_2, group = depth_2), size = 0.25)+
geom_line(aes(y = temp, x = datetime, color = depth_2, group = depth_2), size = 0.5)+
scale_x_datetime(date_breaks = "2 weeks", date_labels = "%b-%d")+
scale_y_continuous(breaks = c(0, 10, 20, 30), n.breaks=4, limits = c(0, 35))+
#ylim(25, 5)+
labs(x = " ", y = " soil temperature
(°C)",
color = "soil depth cm")+
#scale_fill_manual(values=natparks.pals("Arches", 11))+
scale_color_manual(values=(pnw_palette("Lake", 3)))+
guides(colour = guide_legend(override.aes = list(size=6)))+
facet_grid(.~site, scales = "free_x")+
theme_er1()+
theme(axis.text.x = element_blank(),
axis.text.y = element_text(size = 12),
legend.position = "right", panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 13),
axis.title.y = element_text(size = 13),
axis.ticks.x = element_blank(),
strip.text.y = element_text(size = 13),
strip.text.x = element_text(size = 13),
panel.border = element_rect(color="gray",size=0.5, fill = NA))
ggsave("formanuscript/temp_lines_dry.png", plot = temp_lines_dry, width = 7.5, height = 2.5)
temp_linesAll = temp_lines + plot_spacer() + temp_lines2022 + plot_layout(guides = "collect", widths = c(6, 0.25 , 6)) & theme(legend.position = 'bottom')
ggsave("output/temp_linesAll.png", plot = temp_linesAll, height = 7, width = 13)
temp_lines=
final_temp_sal_moist_forfig %>%
mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
mutate(month = factor(month, levels = c("early summer", "mid summer", "late summer", "early fall")))   %>%
#filter(site == "acidic tundra") %>%
#filter(position == "dry") %>%
mutate(depth_cm = recode(depth_cm, "5" = "0-10", "15" = "10-20", "25" = "20-30")) %>%
mutate(depth_2 = factor(depth_cm, levels = c("0-10", "10-20", "20-30")))   %>%
#mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
ggplot()+
geom_point(aes(y = temp, x = datetime, color = depth_2, group = depth_2), size = 0.25)+
scale_x_datetime(date_breaks = "2 weeks", date_labels = "%b-%d")+
scale_y_continuous(breaks = c(0, 10, 20, 30), n.breaks=4, limits = c(0, 35))+
#ylim(25, 5)+
labs(x = "2021", y = "soil temperature, celsius",
color = "soil depth cm")+
#scale_fill_manual(values=natparks.pals("Arches", 11))+
scale_color_manual(values=(pnw_palette("Lake", 3)))+
guides(colour = guide_legend(override.aes = list(size=6)))+
facet_grid(position~site, scales = "free_x")+
theme_er1()+
theme(axis.text.x = element_text(size = 12, vjust = 0.5, angle = 45),
axis.text.y = element_text(size = 12),
legend.position = "bottom", panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
strip.text.y = element_blank(),
strip.text.x = element_text(size = 16))
ggsave("formanuscript/temp_lines.tiff", plot = temp_lines, width = 6, height = 6)
temp_linesAll = temp_lines + plot_spacer() + temp_lines2022 + plot_layout(guides = "collect", widths = c(6, 0.25 , 6)) & theme(legend.position = 'bottom')
ggsave("output/temp_linesAll.png", plot = temp_linesAll, height = 7, width = 13)
raw_ICP = read.csv("raw/2023_LIME_ICPAES_002R_Herndon_0118.csv")
raw_ICP_diluted = read.csv("raw/2023_LIME_ICPAES_002R_Herndon_0118_diluted.csv")
combo_redox_withdepths2022 = read.csv("processed/allcombine_2022_frozen.csv")
processed_ICP_diluted =
raw_ICP_diluted %>%
mutate(Area = recode(Area, "West" = "non-acidic tundra",
"East" = "acidic tundra")) %>%
mutate(Area = factor(Area, levels = c("non-acidic tundra", "acidic tundra"))) %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
# dplyr::select(c(SampleID, Date, Time, Area, Site, Plot, Depth_cm, Al_ug_mL, Ca_ug_mL, Fe_ug_mL,
#                 K_ug_mL, Mg_ug_mL, Mn_ug_mL, Na_ug_mL, P_ug_mL)) %>%
mutate(P_ug_mL = recode(P_ug_mL, "<0.01" = "0.005",
"<0.1" = "0.05")) %>%  #this seems like an error...need to check
separate(Date, sep = "-", into =c('day', 'month', 'year')) %>%
mutate(month = recode(month, "Jun" = "06", "Jul" = "07", "Aug" = "08", "Sep" = "09")) %>%
mutate(year = recode(year, "22" = "2022")) %>%
mutate(date = as.Date(paste(year, month, day, sep = "-"))) %>%
mutate(Al_ug_mL = as.numeric(Al_ug_mL)) %>%
mutate(Ca_ug_mL = as.numeric(Ca_ug_mL)) %>%
mutate(K_ug_mL = as.numeric(K_ug_mL)) %>%
mutate(Mn_ug_mL = as.numeric(Mn_ug_mL)) %>%
mutate(Mg_ug_mL = as.numeric(Mg_ug_mL)) %>%
mutate(Na_ug_mL = as.numeric(Na_ug_mL)) %>%
mutate(P_ug_mL = as.numeric(P_ug_mL)) %>%
mutate(Fe_ug_mL = as.numeric(Fe_ug_mL)) %>%
pivot_longer(-c(SampleID, date, Time, Area, Site, Plot, day, month, year, Depth_cm), names_to = 'ICP', values_to = 'concentration') %>%
mutate(concentration = concentration * 10)
processed_ICP =
raw_ICP %>%
mutate(Area = recode(Area, "West" = "non-acidic tundra",
"East" = "acidic tundra")) %>%
mutate(Area = factor(Area, levels = c("non-acidic tundra", "acidic tundra"))) %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
na.omit() %>%
dplyr::select(c(SampleID, Date, Time, Area, Site, Plot, Depth_cm, Al_ug_mL, Ca_ug_mL, Fe_ug_mL,
K_ug_mL, Mg_ug_mL, Mn_ug_mL, Na_ug_mL, P_ug_mL)) %>%
na.omit() %>%
mutate(Al_ug_mL = recode(Al_ug_mL, "<0.01" = "0.005")) %>%
mutate(Mn_ug_mL = recode(Mn_ug_mL, "<0.005" = '0.003')) %>%
mutate(P_ug_mL = recode(P_ug_mL, "<0.01" = "0.005",
"<0.1" = "0.05")) %>%  #this seems like an error...need to check
separate(Date, sep = "-", into =c('day', 'month', 'year')) %>%
mutate(month = recode(month, "Jun" = "06", "Jul" = "07", "Aug" = "08", "Sep" = "09")) %>%
mutate(year = recode(year, "22" = "2022")) %>%
mutate(date = as.Date(paste(year, month, day, sep = "-"))) %>%
mutate(Al_ug_mL = as.numeric(Al_ug_mL)) %>%
mutate(Ca_ug_mL = as.numeric(Ca_ug_mL)) %>%
mutate(K_ug_mL = as.numeric(K_ug_mL)) %>%
mutate(Mn_ug_mL = as.numeric(Mn_ug_mL)) %>%
mutate(Mg_ug_mL = as.numeric(Mg_ug_mL)) %>%
mutate(Na_ug_mL = as.numeric(Na_ug_mL)) %>%
mutate(P_ug_mL = as.numeric(P_ug_mL)) %>%
mutate(Fe_ug_mL = as.numeric(Fe_ug_mL)) %>%
pivot_longer(-c(SampleID, date, Time, Area, Site, Plot, day, month, year, Depth_cm), names_to = 'ICP', values_to = 'concentration') %>%
vctrs::vec_c(processed_ICP_diluted) %>%
mutate(month = recode(month, "06" = "June", "07" = "July", "08" = "August", "09" = "September"))
write.csv(processed_ICP, "processed/ICP_2022.csv")
processed_ICP_wider =
processed_ICP %>%
pivot_wider(names_from = "ICP", values_from = "concentration")
processed_ICP_grouped =
processed_ICP %>%
pivot_wider(names_from = "ICP", values_from = "concentration") %>%
group_by(Area, Site, Depth_cm, date) %>%
dplyr::summarise(mean_Al_ug_mL = round(mean(Al_ug_mL),3),
mean_Ca_ug_mL = round(mean(Ca_ug_mL),3),
mean_K_ug_mL = round(mean(K_ug_mL),3),
mean_Mn_ug_mL = round(mean(Mn_ug_mL),3),
mean_Mg_ug_mL = round(mean(Mg_ug_mL),3),
mean_Na_ug_mL = round(mean(Na_ug_mL),3),
mean_P_ug_mL = round(mean(P_ug_mL),3),
mean_Fe_ug_mL = round(mean(Fe_ug_mL),3),
sd_Al_ug_mL = round(sd(Al_ug_mL),3),
sd_Ca_ug_mL = round(sd(Ca_ug_mL),3),
sd_K_ug_mL = round(sd(K_ug_mL),3),
sd_Mn_ug_mL = round(sd(Mn_ug_mL),3),
sd_Mg_ug_mL = round(sd(Mg_ug_mL),3),
sd_Na_ug_mL = round(sd(Na_ug_mL),3),
sd_P_ug_mL = round(sd(P_ug_mL),3),
sd_Fe_ug_mL = round(sd(Fe_ug_mL),3)
) %>%
separate(date, sep = "-", into =c('year', 'month', 'day')) %>%
mutate(month2 = recode(month, "06" = "June", "07" = "July", "08" = "August", "09" = "September")) %>%
mutate(date_plot = paste(month2, day, year, sep = "-")) %>%
mutate(date_plot = factor(date_plot, levels = c("June-27-2022", "June-29-2022", "July-06-2022",
"July-07-2022", "July-11-2022", "July-12-2022",
"July-18-2022", "July-19-2022", "July-25-2022",
"July-26-2022", "August-07-2022", "August-08-2022",
"September-15-2022","September-17-2022", "September-23-2022"))) %>%
mutate(area_site = paste(Area, Site, sep = "-"))
processed_ICP_grouped_longer =
processed_ICP %>%
pivot_wider(names_from = "ICP", values_from = "concentration") %>%
group_by(Area, Site, Depth_cm, date) %>%
dplyr::summarise(mean_Al_ug_mL = round(mean(Al_ug_mL),3),
mean_Ca_ug_mL = round(mean(Ca_ug_mL),3),
mean_K_ug_mL = round(mean(K_ug_mL),3),
mean_Mn_ug_mL = round(mean(Mn_ug_mL),3),
mean_Mg_ug_mL = round(mean(Mg_ug_mL),3),
mean_Na_ug_mL = round(mean(Na_ug_mL),3),
mean_P_ug_mL = round(mean(P_ug_mL),3),
mean_Fe_ug_mL = round(mean(Fe_ug_mL),3)
) %>%
separate(date, sep = "-", into =c('year', 'month', 'day')) %>%
mutate(month2 = recode(month, "06" = "June", "07" = "July", "08" = "August", "09" = "September")) %>%
mutate(date_plot = paste(month2, day, year, sep = "-")) %>%
mutate(date_plot = factor(date_plot, levels = c("June-27-2022", "June-29-2022", "July-06-2022",
"July-07-2022", "July-11-2022", "July-12-2022",
"July-18-2022", "July-19-2022", "July-25-2022",
"July-26-2022", "August-07-2022", "August-08-2022",
"September-15-2022","September-17-2022", "September-23-2022"))) %>%
mutate(area_site = paste(Area, Site, sep = "-")) %>%
pivot_longer(-c(Area, Site, day, month, year, Depth_cm, month2, date_plot, area_site, mean_P_ug_mL), names_to = 'ICP', values_to = 'concentration')
frozen_group2022 =
combo_redox_withdepths2022 %>%
dplyr::mutate(keep = if_else(site == "non-acidic tundra" & position == "dry" & depth_cm > 21 & Betterdate >= '2022-07-30 00:00', paste0("frozen"),"unfrozen")) %>%
filter(keep == "unfrozen") %>%
mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
separate(TIMESTAMP, sep = " ", into = c("date", "time")) %>%
separate(date, sep = "/", into =c('month', 'day', 'year')) %>%
mutate(date2 = as.Date(paste(year, month, day, sep = "-"))) %>%
dplyr::select(site, position, probe, avg_values_fixed, depth_cm, date2) %>%
filter(date2 == c("2022-06-27", "2022-06-29", "2022-07-06", "2022-07-07",
"2022-07-11", "2022-07-12", "2022-07-18", "2022-07-19",
"2022-07-25", "2022-07-26", "2022-08-07", "2022-08-08",
"2022-09-15", "2022-9-17", "2022-09-23")) %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
group_by(site, position, date2, depth_cm) %>%
dplyr::summarise(redox_avg_mV = round(mean(avg_values_fixed),2),
redox_sd = round(sd(avg_values_fixed),2)) %>%
mutate(depth_cm = case_when(depth_cm >=40 ~ "40",
depth_cm <= 10 ~ "10",
depth_cm == 0 ~ "0",
TRUE ~ "20")) %>%
mutate(depth_cm = as.numeric(depth_cm))
processed_ICP_forredoxcombo =
processed_ICP_grouped %>%
janitor::clean_names() %>%
dplyr::rename(position = site, site = area) %>%
mutate(date2 = as.Date(paste(year, month, day, sep = "-"))) %>%
dplyr::select(-year, -month, -day, -month2, -date_plot, -area_site) %>%
mutate(depth_cm = as.numeric(depth_cm)) %>%
mutate(position = recode(position, "Dry" = "dry",
"Mesic" = 'mesic',
"Hydric" = 'hydric'))
redox_nutrients_leftjoin =
processed_ICP_forredoxcombo %>%
left_join(frozen_group2022) %>%
mutate(depth_cm = factor(depth_cm, levels = c("0", "10", "20", "40")))
redox_nutrients_leftjoin_longer =
processed_ICP_forredoxcombo %>%
left_join(frozen_group2022) %>%
mutate(depth_cm = factor(depth_cm, levels = c("0", "10", "20", "40"))) %>%
dplyr::select(-sd_al_ug_m_l, -sd_ca_ug_m_l, -sd_k_ug_m_l, -sd_mn_ug_m_l,
-sd_mg_ug_m_l, -sd_na_ug_m_l, -sd_p_ug_m_l, -sd_fe_ug_m_l) %>%
pivot_longer(-c(site, position, depth_cm, date2, redox_avg_mV, redox_sd), names_to = 'ICP', values_to = 'concentration') %>%
mutate(ICP = recode(ICP, "mean_fe_ug_m_l" = "iron", "mean_p_ug_m_l" = "phosphorus",
"mean_ca_ug_m_l" = "calcium", "mean_al_ug_m_l" = "aluminum"))
processed_ICP %>%
mutate(grouping = paste0(Area, "-", Site, "-", date, "-", Plot)) %>%
mutate(month = factor(month, levels = c("June", "July", "August", "September"))) %>%
filter(ICP == "P_ug_mL") %>%
ggplot() +
geom_point(aes(x = concentration, y = Depth_cm, color = month), size = 3.5, alpha = 0.75)+
geom_line(aes(x = concentration, y = Depth_cm, color = month, group = grouping), orientation = "y", size = 0.75, linetype = "dotted")+
labs(x = "Phosphorus concentration, μg/ml",
y = "depth, cm",
color = "month, 2022"
)+
scale_color_manual(values = (pnw_palette('Sunset2', 4)))+
scale_fill_manual(values = (pnw_palette('Sunset2', 4)))+
# scale_color_manual(values = c("#f07167", "#a7c957", "#1e96fc", "#f07167", "#a7c957", "#1e96fc"))+
scale_y_reverse()+
facet_grid(Site~Area, scales = "free_x")+
theme_er1()+
theme(legend.position = "right",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
strip.text.y = element_blank())
#axis.text.y=element_blank(),  #remove y axis labels
#axis.ticks.y=element_blank(),
#axis.text.x = element_text(size = 9, hjust=0.8,vjust=0.2,angle = 90))
Al_concentration_fig =
processed_ICP %>%
mutate(grouping = paste0(Area, "-", Site, "-", date, "-", Plot)) %>%
mutate(month = factor(month, levels = c("June", "July", "August", "September"))) %>%
filter(ICP == "Al_ug_mL") %>%
ggplot() +
geom_point(aes(x = concentration, y = Depth_cm, color = month), size = 3.5, alpha = 0.75)+
geom_line(aes(x = concentration, y = Depth_cm, color = month, group = grouping), orientation = "y", size = 0.75, linetype = "dotted")+
labs(x = "Aluminum concentration, μg/ml",
y = "depth, cm",
color = "month, 2022"
)+
scale_color_manual(values = (pnw_palette('Sunset2', 4)))+
scale_fill_manual(values = (pnw_palette('Sunset2', 4)))+
scale_y_reverse()+
facet_grid(Site~Area, scales = "free_x")+
theme_er1()+
theme(legend.position = "right",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
strip.text.y = element_blank(),
#axis.text.y=element_blank(),  #remove y axis labels
#axis.ticks.y=element_blank(),
axis.text.x = element_text(size = 9, hjust=0.8,vjust=0.2,angle = 90))
ggsave("output/Al_concentration_fig.png", plot = Al_concentration_fig, height = 5.5, width = 6.5)
Mg_concentration_fig =
processed_ICP %>%
mutate(grouping = paste0(Area, "-", Site, "-", date, "-", Plot)) %>%
mutate(month = factor(month, levels = c("June", "July", "August", "September"))) %>%
# filter(Area == "acidic tundra" & Site == "Hydric" & ICP == "P_ug_mL") %>%
filter(ICP == "Mg_ug_mL") %>%
ggplot() +
geom_point(aes(x = concentration, y = Depth_cm, color = month), size = 3.5, alpha = 0.75)+
geom_line(aes(x = concentration, y = Depth_cm, color = month, group = grouping), orientation = "y", size = 0.75, linetype = "dotted")+
labs(x = "Magnesium concentration, μg/ml",
y = " ",
color = "month, 2022"
)+
scale_color_manual(values = (pnw_palette('Sunset2', 4)))+
scale_fill_manual(values = (pnw_palette('Sunset2', 4)))+
scale_y_reverse()+
facet_grid(Site~Area, scales = "free_x")+
theme_er1()+
theme(legend.position = "right",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
axis.text.y=element_blank(),  #remove y axis labels
axis.ticks.y=element_blank(),
axis.text.x = element_text(size = 9, hjust=0.8,vjust=0.2,angle = 90))
ggsave("output/Mg_concentration_fig.png", plot = Mg_concentration_fig, height = 5.5, width = 6.5)
Na_concentration_fig =
processed_ICP %>%
mutate(grouping = paste0(Area, "-", Site, "-", date, "-", Plot)) %>%
mutate(month = factor(month, levels = c("June", "July", "August", "September"))) %>%
# filter(Area == "acidic tundra" & Site == "Hydric" & ICP == "P_ug_mL") %>%
filter(ICP == "Na_ug_mL") %>%
ggplot() +
geom_point(aes(x = concentration, y = Depth_cm, color = month), size = 3.5, alpha = 0.75)+
geom_line(aes(x = concentration, y = Depth_cm, color = month, group = grouping), orientation = "y", size = 0.75, linetype = "dotted")+
labs(x = "Sodium concentration, μg/ml",
y = " ",
color = "month, 2022"
)+
scale_color_manual(values = (pnw_palette('Sunset2', 4)))+
scale_fill_manual(values = (pnw_palette('Sunset2', 4)))+
scale_y_reverse()+
facet_grid(Site~Area, scales = "free_x")+
theme_er1()+
theme(legend.position = "right",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
axis.text.y=element_blank(),  #remove y axis labels
axis.ticks.y=element_blank(),
axis.text.x = element_text(size = 9, hjust=0.8,vjust=0.2,angle = 90))
ggsave("output/Na_concentration_fig.png", plot = Na_concentration_fig, height = 5.5, width = 6.5)
K_concentration_fig =
processed_ICP %>%
mutate(grouping = paste0(Area, "-", Site, "-", date, "-", Plot)) %>%
mutate(month = factor(month, levels = c("June", "July", "August", "September"))) %>%
# filter(Area == "acidic tundra" & Site == "Hydric" & ICP == "P_ug_mL") %>%
filter(ICP == "K_ug_mL") %>%
ggplot() +
geom_point(aes(x = concentration, y = Depth_cm, color = month), size = 3.5, alpha = 0.75)+
geom_line(aes(x = concentration, y = Depth_cm, color = month, group = grouping), orientation = "y", size = 0.75, linetype = "dotted")+
labs(x = "Potassium concentration, μg/ml",
y = "depth, cm",
color = "month, 2022"
)+
scale_color_manual(values = (pnw_palette('Sunset2', 4)))+
scale_fill_manual(values = (pnw_palette('Sunset2', 4)))+
scale_y_reverse()+
facet_grid(Site~Area, scales = "free_x")+
theme_er1()+
theme(legend.position = "right",
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
strip.text.y = element_blank(),
# axis.text.y=element_blank(),  #remove y axis labels
# axis.ticks.y=element_blank(),
axis.text.x = element_text(size = 9, hjust=0.8,vjust=0.2,angle = 90))
ggsave("output/K_concentration_fig.png", plot = K_concentration_fig, height = 5.5, width = 6.5)
library(patchwork)
nutrientsfig1 = Al_concentration_fig + Na_concentration_fig
nutrientsfig2 = K_concentration_fig + Mg_concentration_fig
nutrient_plot = nutrientsfig1 / nutrientsfig2 + plot_layout(guides = "collect")
# ggsave("output/2022nutrientsfigA.png", plot = nutrientsfigA, height = 9, width = 11)
# ggsave("output/2022nutrientsfigB.png", plot = nutrientsfigB, height = 10, width = 8)
ggsave("output/2022nutrient_plot2.png", plot = nutrient_plot, height = 12, width = 9.5)
nutrientsfig1 / nutrientsfig2 + plot_layout(guides = "collect")
nutrient_plot = nutrientsfig1 / nutrientsfig2 + plot_layout(guides = "collect")
ggsave("output/2022nutrient_plot2.png", plot = nutrient_plot, height = 12, width = 9.5)
