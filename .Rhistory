xlim(0,60)+
labs(x = "soil moisture (%)",
y = "depth (cm)")+
guides(color = guide_legend(nrow = 2))+
facet_grid(position ~ .)+
theme_er1()+
theme(legend.position = "bottom", panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), panel.border = element_rect(color="gray",size=0.25, fill = NA),
strip.text.y = element_blank())
ggsave("output/moist_simplepoint_fig.png", plot = moist_simplepoint_fig, height = 8, width = 1.9)
source("code/0-packages.R")
combo_redox_withdepths2022 = read.csv("processed/allcombine_2022_frozen.csv")
combo_redox_withdepths2021 = read.csv("processed/allcombine_2021_frozen.csv")
frozen_group2021=
combo_redox_withdepths2021 %>%
# mutate(keep = case_when(site == "non-acidic tundra" & position == "hydric" & probe == 1 ~ "keep",
#                         site == "acidic tundra" & position == "hydric" & probe == 3 ~ "keep",
#                         site == "non-acidic tundra" & position == "dry" & probe == 1 ~ "keep",
#                         site == "acidic tundra" & position == "dry" & probe == 1 ~ "keep",
#                         site == "acidic tundra" & position == "mesic" & probe == 1 ~ "keep",
#                         site == "non-acidic tundra" & position == "mesic" & probe == 3 ~ "keep")) %>%
dplyr::mutate(keep = if_else(site == "non-acidic tundra" & position == "hydric" & depth_cm > 40 & Betterdate <= '2021-08-09 00:00', paste0("frozen"),"unfrozen")) %>%
filter(keep == "unfrozen") %>%
mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra")))
frozen_group2022 =
combo_redox_withdepths2022 %>%
dplyr::mutate(keep = if_else(site == "non-acidic tundra" & position == "dry" & depth_cm > 21 & Betterdate >= '2022-07-30 00:00', paste0("frozen"),"unfrozen")) %>%
filter(keep == "unfrozen") %>%
mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra")))
all_grouped =
frozen_group2022 %>%
vctrs::vec_c(frozen_group2021) %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
group_by(position, depth_cm) %>%
dplyr::summarise(redox_avg_mV = round(mean(avg_values_fixed),2),
redox_sd = round(sd(avg_values_fixed),2),
redox_se = round(sd(avg_values_fixed)/sqrt(n()),2),
redox_sd2 = (redox_sd)/2)
grouped_redox_forfigs2022 =
frozen_group2022 %>%
# filter(Betterdate >= '2022-07-01 00:00' & Betterdate <= "2022-09-01 00:00") %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
group_by(site, position, depth_cm) %>%
dplyr::summarise(redox_avg_mV = round(mean(avg_values_fixed),2),
redox_sd = round(sd(avg_values_fixed),2),
redox_se = round(sd(avg_values_fixed)/sqrt(n()),2),
redox_sd2 = (redox_sd)/2) %>%
mutate(year = 2022)
grouped_redox_forfigs2021 =
frozen_group2021 %>%
#  filter(Betterdate >= '2021-07-01 00:00' & Betterdate <= "2021-09-01 00:00") %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
group_by(site, position, depth_cm) %>%
dplyr::summarise(redox_avg_mV = round(mean(avg_values_fixed),2),
redox_sd = round(sd(avg_values_fixed),2),
redox_se = round(sd(avg_values_fixed)/sqrt(n()),2),
redox_sd2 = (redox_sd)/2) %>%
mutate(year = 2021)
grouped_redox_forfigs_temporal2022 =
combo_redox_withdepths2022 %>%
#filter(Betterdate >= '2021-07-01 00:00') %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
mutate(forsep = TIMESTAMP) %>%
separate(forsep, sep = " ", into = c("date", "time")) %>%
separate(date, sep = "/", into = c("month", "day", "year")) %>%
mutate(month = recode(month,  "6" = "June",
"7" = "July",
"8" = "August",
"9" = "September")) %>%
group_by(site, position, depth_cm, month) %>%
dplyr::summarise(redox_avg_mV = round(mean(avg_values_fixed),2),
redox_sd = round(sd(avg_values_fixed),2),
redox_se = round(sd(avg_values_fixed)/sqrt(n()),2),
redox_sd2 = (redox_sd)/2) %>%
mutate(year = 2022)
grouped_redox_forfigs_temporal2021 =
frozen_group2021 %>%
# filter(Betterdate >= '2021-07-01 00:00') %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
mutate(forsep = TIMESTAMP) %>%
separate(forsep, sep = " ", into = c("date", "time")) %>%
separate(date, sep = "/", into = c("month", "day", "year")) %>%
mutate(month = recode(month,  "6" = "June",
"7" = "July",
"8" = "August",
"9" = "September")) %>%
group_by(site, position, depth_cm, month) %>%
dplyr::summarise(redox_avg_mV = round(mean(avg_values_fixed),2),
redox_sd = round(sd(avg_values_fixed),2),
redox_se = round(sd(avg_values_fixed)/sqrt(n()),2),
redox_sd2 = (redox_sd)/2)
ungrouped_redox_forfigs_nonhydric =
combo_redox_withdepths2021 %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
filter(position != "hydric") %>%
separate(TIMESTAMP, sep = " ", into = c("date2", "time")) %>%
separate(date2, sep = "/", into =c('month', 'day', 'year')) %>%
mutate(date = as.Date(paste(year, month, day, sep = "-"))) %>%
mutate(datetime = ymd_hm(paste(date, time)),
date = ymd(date)) %>%
mutate(depth_2 = factor(depth_cm, levels = c("1", "3.5", "5", "6", "8.5", "10", "15", "16", "18.5", "20", "25", "26", "28.5", "30"))) %>%
#filter(probe == 1) %>%
dplyr::rename(redox_avg_mV = avg_values_fixed)
ungrouped_redox_forfigs2021 =
combo_redox_withdepths2021 %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
separate(TIMESTAMP, sep = " ", into = c("date2", "time")) %>%
separate(date2, sep = "/", into =c('month', 'day', 'year')) %>%
mutate(date = as.Date(paste(year, month, day, sep = "-"))) %>%
mutate(datetime = ymd_hm(paste(date, time)),
date = ymd(date)) %>%
#filter(probe == 1) %>%
dplyr::rename(redox_avg_mV = avg_values_fixed)
ungrouped_redox_forfigs2022 =
combo_redox_withdepths2022 %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
separate(TIMESTAMP, sep = " ", into = c("date2", "time")) %>%
separate(date2, sep = "/", into =c('month', 'day', 'year')) %>%
mutate(date = as.Date(paste(year, month, day, sep = "-"))) %>%
mutate(datetime = ymd_hm(paste(date, time)),
date = ymd(date)) %>%
#filter(probe == 1) %>%
dplyr::rename(redox_avg_mV = avg_values_fixed)
redoxfig_depth_sd =
all_grouped %>%
#mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra"))) %>%
ggplot(aes(y = depth_cm, x = redox_avg_mV, color = position, fill = position), group = 'position')+
geom_point(size = 3, alpha = 0.4, shape = c(21))+
geom_line(orientation = "y", show.legend = FALSE)+
geom_errorbar(aes(xmin=redox_avg_mV-redox_sd, xmax=redox_avg_mV+redox_sd), show.legend = FALSE)+
scale_color_manual(values = c("#9a031e", "#a7c957", "#1e96fc"))+
scale_fill_manual(values = c("#9a031e", "#a7c957", "#1e96fc"))+
ylim(60, 0)+
labs(x = 'redox potential (mV)',
y = "depth (cm)",
color = "", fill = "")+
scale_x_continuous(position="top")+
#facet_grid(.~site, switch = "x")+
theme_er1()+
theme(legend.position = "bottom")
grouped_redox_all =
grouped_redox_forfigs2021 %>%
vctrs::vec_c(grouped_redox_forfigs2022) %>%
mutate(year = as.factor(year))
ungrouped_redox_forfigs2021_probe =
ungrouped_redox_forfigs2021 %>%
mutate(keep = case_when(site == "non-acidic tundra" & position == "hydric" & probe == 1 ~ "keep",
site == "acidic tundra" & position == "hydric" & probe == 3 ~ "keep",
site == "non-acidic tundra" & position == "dry" & probe == 1 ~ "keep",
site == "acidic tundra" & position == "dry" & probe == 1 ~ "keep",
site == "acidic tundra" & position == "mesic" & probe == 1 ~ "keep",
site == "non-acidic tundra" & position == "mesic" & probe == 3 ~ "keep")) %>%
filter(keep == "keep") %>%
mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra")))
ungrouped_redox_forfigs2022_probe =
ungrouped_redox_forfigs2022 %>%
mutate(keep = case_when(site == "non-acidic tundra" & position == "hydric" & probe == 3 ~ "keep",
site == "acidic tundra" & position == "hydric" & probe == 3 ~ "keep",
site == "non-acidic tundra" & position == "dry" & probe == 2 ~ "keep",
site == "acidic tundra" & position == "dry" & probe == 1 ~ "keep",
site == "acidic tundra" & position == "mesic" & probe == 1 ~ "keep",
site == "non-acidic tundra" & position == "mesic" & probe == 3 ~ "keep")) %>%
filter(keep == "keep") %>%
mutate(site = factor(site, levels = c("non-acidic tundra", "acidic tundra")))
redox_lines_2022_fig_nonacidichydric  =
ungrouped_redox_forfigs2022_probe %>%
filter(site == "non-acidic tundra" & position == "hydric") %>%
ggplot(aes(y = redox_avg_mV, x = datetime), group = 'depth_cm')+
#geom_rect(aes(xmin=as_datetime('2021-06-14 17:00:00'), xmax= as_datetime('2021-09-20 10:15:00'), ymin=100, ymax=300), fill = "grey", alpha = 0.5)+
geom_point(aes(color = depth_cm, fill = depth_cm), size = 1, alpha = 0.6, shape = c(21))+
#annotate(xmin='2021-06-21 00:15:00', xmax='2021-09-20 00:15:00', ymin=100, ymax=300, geom='rect', color='grey', alpha=0.5)+
#geom_line(orientation = "x", show.legend = FALSE)+
scale_x_datetime(date_breaks = "2 weeks", date_labels = "%b-%d")+
scale_color_gradientn(colors = rev(natparks.pals(name = "Olympic")), limits=c(-5,60))+
scale_fill_gradientn(colors = rev(natparks.pals(name = "Olympic")), limits=c(-5,60))+
ylim(-250, 700)+
labs(x = "2022", y = " ",
color = "depth (cm)", fill = "depth (cm)")+
facet_grid(position~site)+
theme_er1()+
guides(color = guide_colorbar(reverse = TRUE),
fill = guide_colorbar(reverse = TRUE))+
theme(axis.text.x = element_text(size = 12, vjust = 0.5, angle = 45),
legend.position = "bottom", panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.text.y=element_blank(),  #remove y axis labels
axis.ticks.y=element_blank(),
axis.title.x = element_text(size = 16),
strip.text.x = element_text(size = 16),
strip.text.y = element_text(size = 16))
redox_lines_2022_fig_nonacidichydric  =
ungrouped_redox_forfigs2022_probe %>%
filter(site == "non-acidic tundra" & position == "hydric") %>%
ggplot(aes(y = redox_avg_mV, x = datetime), group = 'depth_cm')+
#geom_rect(aes(xmin=as_datetime('2021-06-14 17:00:00'), xmax= as_datetime('2021-09-20 10:15:00'), ymin=100, ymax=300), fill = "grey", alpha = 0.5)+
geom_point(aes(color = depth_cm, fill = depth_cm), size = 1, alpha = 0.6, shape = c(21))+
#annotate(xmin='2021-06-21 00:15:00', xmax='2021-09-20 00:15:00', ymin=100, ymax=300, geom='rect', color='grey', alpha=0.5)+
#geom_line(orientation = "x", show.legend = FALSE)+
scale_x_datetime(date_breaks = "2 weeks", date_labels = "%b-%d")+
scale_color_gradientn(colors = rev(natparks.pals(name = "Olympic")), limits=c(-5,55))+
scale_fill_gradientn(colors = rev(natparks.pals(name = "Olympic")), limits=c(-5,55))+
ylim(-250, 700)+
labs(x = "2022", y = " ",
color = "depth (cm)", fill = "depth (cm)")+
facet_grid(position~site)+
theme_er1()+
guides(color = guide_colorbar(reverse = TRUE),
fill = guide_colorbar(reverse = TRUE))+
theme(axis.text.x = element_text(size = 13, vjust = 0.5, angle = 45),
axis.text.y = element_text(size = 13),
legend.position = "right", panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(color="gray",size=0.25, fill = NA),
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
strip.text.y = element_blank(),
strip.text.x = element_blank())
ggsave("formanuscript/redox_lines_2022_fig_nonacidichydric.png", plot = redox_lines_2022_fig_nonacidichydric, height = 3.5, width = 6)
source("code/0-packages.R")
thaw_depths = read.csv("raw/thaw_depth_2021.csv")
thaw_depths_2022 = read.csv("raw/thaw_depth_2022.csv")
bd_grav_cleaned = read.csv("raw/PhIr2021_Soil_Inventory_bd.csv") %>%
#dplyr::select(-c(X)) %>%
mutate(Area = recode(Area, "East" = "acidic tundra",
"West" = "non-acidic tundra")) %>%
dplyr::mutate(soil_material = case_when(grepl("O",Horizon)~"organic",
grepl("M",Horizon)~"mineral")) %>%
mutate(volumetric_water_content_gcm3 = soil_bulk_density_g_cm3 * grav_water_gh20_per_gdrysoil)
thaw_depths_cleaned =
thaw_depths %>%
dplyr::select(Date, Area, Site, Plot, Plot_ID, X1, X2, X3, X4, X5, X6, X7, X8, X9, X10,
X11, X12, X13, X14, X15) %>%
na.omit() %>%
pivot_longer(-c(Date, Area, Site, Plot, Plot_ID), names_to = "rep", values_to = "thaw_depth_cm") %>%
separate(Date, sep = "-", into = c("Day", "Month_num", "Year")) %>%
mutate(Month = recode(Month_num, "Jun" = "06", "Jul" = "07", "Aug" = "08")) %>%
mutate(date2 = as.Date(paste(Year,Month,Day, sep = "-"))) %>%
mutate(Area = recode(Area, "East" = "acidic tundra",
"West" = "non-acidic tundra")) %>%
mutate(Area = factor(Area, levels = c("non-acidic tundra", "acidic tundra")))
thaw_depths_cleaned_2022 =
thaw_depths_2022 %>%
dplyr::select(Date, Area, Site, Plot, Plot_ID, X1, X2, X3, X4, X5, X6, X7, X8, X9, X10,
X11, X12, X13, X14, X15) %>%
na.omit() %>%
pivot_longer(-c(Date, Area, Site, Plot, Plot_ID), names_to = "rep", values_to = "thaw_depth_cm") %>%
separate(Date, sep = "-", into = c("Day", "Month_num", "Year")) %>%
mutate(Year = recode(Year, "22" = "2022")) %>%
mutate(Month = recode(Month_num, "Jun" = "06", "Jul" = "07", "Aug" = "08")) %>%
mutate(date2 = as.Date(paste(Year,Month,Day, sep = "-"))) %>%
mutate(Area = recode(Area, "East" = "acidic tundra",
"West" = "non-acidic tundra")) %>%
mutate(Area = factor(Area, levels = c("non-acidic tundra", "acidic tundra")))
water_table =
bd_grav_cleaned %>%
dplyr::select(Area, Site, Date_collected, Horizon, Plot_num, real_depth_cm, Average_Depth_cm, volumetric_water_content_gcm3, grav_moist_perc) %>%
na.omit() %>%
group_by(Area, Site, Date_collected, Plot_num, Horizon) %>%
na.omit() %>%
dplyr::summarise(vwc_mean = mean(volumetric_water_content_gcm3),
vwc_se = sd(volumetric_water_content_gcm3)/sqrt(n()),
vwcperc_mean = vwc_mean*100,
grav_perc_mean = mean(grav_moist_perc),
grav_perc_se = sd(grav_moist_perc)/sqrt(n()),
real_depth_mean = mean(real_depth_cm),
real_depth_se = sd(real_depth_cm)/sqrt(n()),
thickness_mean = mean(Average_Depth_cm),
thickness_se = sd(Average_Depth_cm)/sqrt(n()),
) %>%
ungroup()
thaw_depths_cleaned_forspfig =
thaw_depths_cleaned %>%
filter(Month_num == 'Aug') %>%
group_by(Area, Site) %>%
dplyr::summarise(thawmax = max(thaw_depth_cm),
thawmin = min(thaw_depth_cm),
thawavg = mean(thaw_depth_cm),
thawsd = sd(thaw_depth_cm),
thawse = sd(thaw_depth_cm)/sqrt(n()))
bd_grav_cleaned_forspfig =
bd_grav_cleaned %>%
group_by(Area, Site, soil_material) %>%
na.omit() %>%
dplyr::summarise(depth_avg = round(mean(real_depth_cm),2),
depth_se = round(sd(real_depth_cm)/sqrt(n()),2),
depth_sd = round(sd(real_depth_cm),2),
depth_forstack_avg = round(mean(Average_Depth_cm),2),
depth_forstack_se = round(sd(Average_Depth_cm)/sqrt(n()),2),
depth_forstack_sd = round(sd(Average_Depth_cm),2),
bd_avg = round(mean(soil_bulk_density_g_cm3),2),
bd_se = round(sd(soil_bulk_density_g_cm3)/sqrt(n()),2),
vwc_avg = round(mean(volumetric_water_content_gcm3),2),
vwc_se = round(sd(volumetric_water_content_gcm3)/sqrt(n()),2),
grav_avg = round(mean(grav_moist_perc),2),
grav_se = round(sd(grav_moist_perc)/sqrt(n()),2))
bd_grav_cleaned_forspfig = read.csv("processed/bd_grav_cleaned_forspfig_manual_fix.csv")
spfig =
bd_grav_cleaned_forspfig %>%
left_join(thaw_depths_cleaned_forspfig) %>%
mutate(soil_material = factor(soil_material, levels = c("organic", "mineral"))) %>%
mutate(site_num = recode(Site, "Dry" = "1",
"Mesic" = "2",
"Hydric" = "3")) %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(site_num = as.numeric(site_num))
spfig %>%
ggplot(aes(x = Site))+
geom_point(aes(y = vwc_avg, fill = soil_material), shape = c(21), size = 4)+
geom_errorbar(aes(ymin=vwc_avg-vwc_se, ymax=vwc_avg+vwc_se, color = soil_material), width=.2)+
# geom_point(aes(y = bd_avg*100, fill = soil_material), shape = c(21), size = 3)+
# scale_y_continuous(name = "volumetric water content, g/cm3 (square)",
#                    sec.axis = sec_axis(~./100, name = "bulk density, g/cm3 (circle)"))+
labs(fill = "", color = "",
y = "volumetric water content, g/cm3")+
scale_fill_manual(values = c("#6d6875", "#b5838d"))+
scale_color_manual(values = c("#6d6875", "#b5838d"))+
ylim(0, 0.6)+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "bottom")+
facet_grid(.~Area, scales="free")
spfig %>%
ggplot(aes(x = Site))+
geom_col(aes(y = grav_avg, fill = soil_material), color = c("#3a86ff"), alpha = 0.7, position = "dodge", width = 0.4)+
geom_point(aes(y = bd_avg*75), fill = c("#ffbd00"), shape = c(21), size = 4)+
scale_y_continuous(name = "gravimetric water content, % (bar)",
sec.axis = sec_axis(~./75, name = "bulk density, g/cm3 (gold point)"))+
labs(fill = "")+
scale_fill_manual(values = c("#6d6875", "#b5838d"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "bottom")+
facet_grid(soil_material~Area)
ggsave("figures_finalized/grav_bd.png", plot = grav_bd, width = 9, height = 5)
spfig %>%
ggplot(aes(x = Site))+
geom_col(aes(y = vwc_avg, fill = soil_material, color = soil_material), alpha = 0.7, position = position_dodge2(preserve = "single"), width = 0.4)+
geom_errorbar(aes(ymin=vwc_avg-vwc_se, ymax=vwc_avg+vwc_se, color = soil_material), position = position_dodge2(preserve = "single"), width=.4)+
#geom_point(aes(y = bd_avg/2), fill = c("#ffbd00"), shape = c(21), size = 4)+
# scale_y_continuous(name = "volumetric water content, g/cm3 (bar)",
#                    sec.axis = sec_axis(~.*2, name = "bulk density, g/cm3 (gold point)"))+
labs(fill = "", color = "", y = "volumetric water content, g/cm3")+
ylim(0, 0.6)+
scale_fill_manual(values = c("#6d6875", "#b5838d"))+
scale_color_manual(values = c("grey35", "grey35"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "bottom")+
facet_grid(.~Area)
spfig2 =
spfig %>%
dplyr::select(c(Area, Site, soil_material, depth_forstack_sd, depth_forstack_avg, bd_avg, bd_se))
library(tibble)
gglabel = tribble(
~soil_material, ~Area, ~x, ~y, ~label,
"mineral", 'acidic tundra', 1, 16, '0.73 ± 0.23',
"organic", 'acidic tundra', 1, 8, '0.15 ± 0.04',
"mineral", 'acidic tundra', 3, 16, '0.8',
"organic", 'acidic tundra', 3, 8, '0.11 ± 0.02',
"mineral", 'acidic tundra', 2, 16, '1.06 ± 0.06',
"organic", 'acidic tundra', 2, 8, '0.09 ± 0.02',
"organic", 'non-acidic tundra', 1, 5, '0.13 ± 0.03',
"organic", 'non-acidic tundra', 2, 5, '0.11 ± 0.02',
"organic", 'non-acidic tundra', 3, 5, '0.12 ± 0.01',
"mineral", 'non-acidic tundra', 2, 16, '0.91 ± 0.07',
)
depths_fig =
spfig %>%
mutate(soil_material = factor(soil_material, levels = c("mineral", "organic"))) %>%
mutate(Area = factor(Area, levels = c("non-acidic tundra", "acidic tundra"))) %>%
ggplot(aes(x = Site))+
geom_col(aes(y = manual_depth_avg, fill = soil_material), position = "stack", width = 0.7)+
geom_point(aes(y = thawavg), fill = c("#f07167"), shape = c(21), size = 4)+
geom_errorbar(aes(ymin = thawavg - thawsd, ymax = thawavg + thawsd), color = "black", width = 0.2)+
#geom_errorbar(aes(ymin = depth_avg - depth_sd, ymax = depth_avg + depth_sd, color = soil_material), width = 0.2)+
geom_text(data = gglabel, aes(x = x, y = y, label = label), color = 'white', size = 3)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth, cm",
caption = "numbers are bulk density g/cm3")+
scale_fill_manual(values = c("#b5838d", "#6d6875"))+
scale_color_manual(values = c("#adb5bd", "#495057"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right")+
facet_grid(.~Area, scales="free")
spfig %>%
mutate(soil_material = factor(soil_material, levels = c("mineral", "organic"))) %>%
mutate(Area = factor(Area, levels = c("non-acidic tundra", "acidic tundra"))) %>%
ggplot(aes(x = Site))+
geom_col(aes(y = manual_depth_avg, fill = soil_material), position = "stack", width = 0.7)+
geom_point(aes(y = thawavg), fill = c("#f07167"), shape = c(21), size = 4)+
geom_errorbar(aes(ymin = thawavg - thawsd, ymax = thawavg + thawsd), color = "black", width = 0.2)+
#geom_errorbar(aes(ymin = depth_avg - depth_sd, ymax = depth_avg + depth_sd, color = soil_material), width = 0.2)+
geom_text(data = gglabel, aes(x = x, y = y, label = label), color = 'white', size = 3)+
scale_y_reverse()+
labs(fill = "", color = "",
y = "depth, cm",
caption = "numbers are bulk density g/cm3")+
scale_fill_manual(values = c("#b5838d", "#6d6875"))+
scale_color_manual(values = c("#adb5bd", "#495057"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90, size = 9), legend.position = "right")+
facet_grid(.~Area, scales="free")
final_temp_sal_moist_forfig %>%
filter(position == "dry") %>%
mutate(position = factor(position, levels = c("dry", "mesic", "hydric"))) %>%
mutate(site = recode(site, "east" = "acidic tundra",
"west" = "non-acidic tundra")) %>%
ggplot(aes(x = datetime))+
geom_line(aes(y = moisture_avg, color = site), size = 0.65)+
labs(y = "soil moisture, %",
x = "",
color = "")+
scale_x_datetime(date_breaks = "3 days")+
scale_color_manual(values = c("#0a9396", "#ee9b00"))+
theme_er1()+
theme(axis.text.x = element_text (vjust = 0.5, hjust=1, angle = 90), legend.position = "bottom",
panel.grid.minor = element_blank())+
facet_grid(depth_cm~position)
source("code/0-packages.R")
thaw_depths = read.csv("raw/thaw_depth_2021.csv")
bd_grav_cleaned = read.csv("raw/PhIr2021_Soil_Inventory_bd.csv") %>%
#dplyr::select(-c(X)) %>%
mutate(Area = recode(Area, "East" = "acidic tundra",
"West" = "non-acidic tundra")) %>%
dplyr::mutate(soil_material = case_when(grepl("O",Horizon)~"organic",
grepl("M",Horizon)~"mineral")) %>%
mutate(volumetric_water_content_cm3_cm3 = soil_bulk_density_g_cm3 * grav_water_gh20_per_gdrysoil)
bd_select =
bd_grav_cleaned %>%
dplyr::select(Sample_ID, Core_ID, Date_collected, Area, Site, Plot_num, Plot_ID,
Horizon, Depth_1_cm, Depth_2_cm, Depth_3_cm, Depth_4_cm, Average_Depth_cm, real_depth_cm,
soil_bulk_density_g_cm3, volumetric_water_content_cm3_cm3, soil_material) %>%
mutate(label = Horizon) %>%
mutate(label = factor(label, levels = c("O", "O1", "O2", "O3", "M", "M1", "M2"))) %>%
mutate(date_simple = recode(Date_collected, "6-Jul-21" = "Plot-1", "7-Jul-21" = "Plot-1",
"13-Jul-21" = "Plot-2", "14-Jul-21" = "Plot-2",
"24-Jul-21" = "Plot-3",
"30-Jul-21" = "Plot-4", "31-Jul-21" = "Plot-4",
"7-Aug-21" = "Plot-5")) %>%
mutate(label = paste0(date_simple, "-", Plot_num))
bd_grouped =
bd_select %>%
filter(Site != "Transect") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("O", "O1", "O2", "O3", "M", "M1", "M2"))) %>%
dplyr::select(c(Area, Site, Horizon, soil_bulk_density_g_cm3, volumetric_water_content_cm3_cm3)) %>%
na.omit() %>%
group_by(Area, Site, Horizon) %>%
dplyr::summarise(mean_depth = round(mean(real_depth_cm),2),
sd_depth = round(sd(real_depth_cm),2),
mean_bd = round(mean(soil_bulk_density_g_cm3),2),
sd_bd = round(sd(soil_bulk_density_g_cm3),2),
mean_vwc = round(mean(volumetric_water_content_cm3_cm3),2),
sd_vwc = round(sd(volumetric_water_content_cm3_cm3),2)) %>%
mutate(bd_summary = paste(mean_bd, "\u00b1", sd_bd),
vwc_summary = paste(mean_vwc, "\u00b1", sd_vwc)) %>%
dplyr::select(c(Area, Site, Horizon, bd_summary, vwc_summary, mean_bd, sd_bd, mean_vwc, sd_vwc))
bd_grouped =
bd_select %>%
filter(Site != "Transect") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("O", "O1", "O2", "O3", "M", "M1", "M2"))) %>%
dplyr::select(c(Area, Site, Horizon, soil_bulk_density_g_cm3, volumetric_water_content_cm3_cm3, real_depth_cm)) %>%
na.omit() %>%
group_by(Area, Site, Horizon) %>%
dplyr::summarise(mean_depth = round(mean(real_depth_cm),2),
sd_depth = round(sd(real_depth_cm),2),
mean_bd = round(mean(soil_bulk_density_g_cm3),2),
sd_bd = round(sd(soil_bulk_density_g_cm3),2),
mean_vwc = round(mean(volumetric_water_content_cm3_cm3),2),
sd_vwc = round(sd(volumetric_water_content_cm3_cm3),2)) %>%
mutate(bd_summary = paste(mean_bd, "\u00b1", sd_bd),
vwc_summary = paste(mean_vwc, "\u00b1", sd_vwc)) %>%
dplyr::select(c(Area, Site, Horizon, bd_summary, vwc_summary, mean_bd, sd_bd, mean_vwc, sd_vwc))
bd_grouped %>% knitr::kable()
write.csv(bd_grouped, "output/bd_grouped.csv")
bd_grouped =
bd_select %>%
filter(Site != "Transect") %>%
mutate(Site = factor(Site, levels = c("Dry", "Mesic", "Hydric"))) %>%
mutate(Horizon = factor(Horizon, levels = c("O", "O1", "O2", "O3", "M", "M1", "M2"))) %>%
dplyr::select(c(Area, Site, Horizon, soil_bulk_density_g_cm3, volumetric_water_content_cm3_cm3, real_depth_cm)) %>%
na.omit() %>%
group_by(Area, Site, Horizon) %>%
dplyr::summarise(mean_depth = round(mean(real_depth_cm),2),
sd_depth = round(sd(real_depth_cm),2),
mean_bd = round(mean(soil_bulk_density_g_cm3),2),
sd_bd = round(sd(soil_bulk_density_g_cm3),2),
mean_vwc = round(mean(volumetric_water_content_cm3_cm3),2),
sd_vwc = round(sd(volumetric_water_content_cm3_cm3),2)) %>%
mutate(depth_summary = paste(mean_depth, "\u00b1", sd_depth),
bd_summary = paste(mean_bd, "\u00b1", sd_bd),
vwc_summary = paste(mean_vwc, "\u00b1", sd_vwc)
) %>%
dplyr::select(c(Area, Site, Horizon, depth_summary, bd_summary, vwc_summary, mean_bd, sd_bd, mean_vwc, sd_vwc))
bd_grouped %>% knitr::kable()
write.csv(bd_grouped, "output/bd_grouped.csv")
write.csv(bd_grouped, "output/bd_grouped.csv")
